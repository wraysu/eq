// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://@sbaseurl@/jsapi/jsapi/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred jimu/BaseFeatureAction jimu/Role jimu/LayerInfos/LayerInfos jimu/WidgetManager".split(" "),function(k,l,f,g,m,n,p,q){return k(m,{map:null,iconClass:"icon-edit",isFeatureSupported:function(a,b){var c=new g,h=b||f.getObject("_wabProperties.popupInfo.layerForActionWithEmptyFeatures",!1,this.map.infoWindow),d=p.getInstanceSync().getLayerInfoByTopLayerId(h.id);a=new g;d?a=d.isEditable():a.resolve(!1);a.then(f.hitch(this,function(a){h||
c.resolve(!1);var b=!1,e=this.appConfig.getConfigElementById(this.widgetId).config;e.editor.layerInfos?0===e.editor.layerInfos.length?b=!0:l.forEach(e.editor.layerInfos.concat(e.editor.tableInfos||[]),function(a){h.id===a.featureLayer.id&&(b=!0)}):b=!1;b&&d&&d.getUrl()&&a?c.resolve(!0):c.resolve(!1)}));return c},onExecute:function(a,b){var c=b||f.getObject("_wabProperties.popupInfo.layerForActionWithEmptyFeatures",!1,this.map.infoWindow);b=new g;q.getInstance().triggerWidgetOpen(this.widgetId).then(function(b){b.beginEditingByFeatures(a.features,
c)});return b.promise},_checkEditPrivilege:function(a){var b=!0;a&&(b=new n({id:a.roleId?a.roleId:a.role,role:a.role}),a.privileges&&b.setPrivileges(a.privileges),b=b.canEditFeatures());return b}})});