// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://@sbaseurl@/jsapi/jsapi/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/DistanceAndDirection/templates/TabEllipse.html":'\x3cdiv class\x3d"tabPanel" data-dojo-attach-point\x3d"ellipseContainer"\x3e\r\n    \x3cdiv class\x3d"controls"\x3e\r\n        \x3cdiv class\x3d"controlGroup"\x3e\r\n            \x3clabel\x3e${nls.ellipseTypeLabel}\x3c/label\x3e\r\n            \x3cdiv class\x3d"controlItem"\x3e\r\n                \x3cselect style\x3d"width: 225px" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"ellipseType"\x3e\r\n                    \x3coption value\x3d"semi"\x3e${nls.ellipseSemiLabel}\x3c/option\x3e\r\n                    \x3coption value\x3d"full"\x3e${nls.ellipseFullLabel}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"controlGroup"\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"coordInputLabel"\x3e${nls.centerPointLabel}\x3c/label\x3e\r\n            \x3cdiv class\x3d"controlItem"\x3e\r\n                \x3cinput class\x3d"jimu-input coordInput" data-dojo-attach-point\x3d"startPointCoords" placeholder\x3d"${nls.startPointPlaceHolderLabel}" /\x3e\r\n                \x3cdiv class\x3d"controlItem paddedLeft"\x3e\r\n                    \x3cdiv class\x3d\'add-with-icon\'\x3e\r\n                        \x3cspan title\x3d"${nls.formatInputLabel}" class\x3d"jimu-icon settingBtn" data-dojo-attach-point\x3d"coordinateFormatButton"\x3e\x3c/span\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d\'add-with-icon\'\x3e\r\n                        \x3cdiv title\x3d"${nls.drawEllipseLabel}" class\x3d"drawPointBtn" data-dojo-attach-point\x3d"addPointBtn"\x3e\x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"controlGroup"\x3e\r\n                \x3cinput class\x3d"interactive-checkbox" type\x3d"checkbox" data-dojo-attach-point\x3d"interactiveEllipse" /\x3e\r\n                \x3clabel data-dojo-attach-point\x3d"interactiveLabel"\x3e${nls.createEllipseInteractively}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cfieldset\x3e\r\n            \x3clegend\x3e${nls.axisLabel}\x3c/legend\x3e\r\n            \x3cdiv class\x3d"controlGroup" data-dojo-attach-point\x3d"majorAxisInputDiv"\x3e\r\n                \x3clabel data-dojo-attach-point\x3d"majorAxisLabel"\x3e${nls.majorRadiusLabel}\x3c/label\x3e\r\n                \x3cdiv class\x3d"controlItem"\x3e\r\n                    \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox"\r\n                      required\x3d\'true\',\r\n                      value\x3d\'100\',\r\n                      data-dojo-props\x3d"constraints:{min:1}"\r\n                      data-dojo-attach-point\x3d"majorAxisInput" /\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"controlGroup" data-dojo-attach-point\x3d"minorAxisInputDiv"\x3e\r\n                \x3clabel data-dojo-attach-point\x3d"minorAxisLabel"\x3e${nls.minorRadiusLabel}\x3c/label\x3e\r\n                \x3cdiv class\x3d"controlItem"\x3e\r\n                    \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox"\r\n                      required\x3d\'true\',\r\n                      value\x3d\'50\',\r\n                      data-dojo-props\x3d"constraints:{min:1}"\r\n                      data-dojo-attach-point\x3d"minorAxisInput" /\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"controlGroup"\x3e\r\n                \x3clabel\x3eUnit\x3c/label\x3e\r\n                \x3cdiv class\x3d"controlItem"\x3e\r\n                    \x3cselect style\x3d"width: 183px" data-dojo-type\x3d"dijit/form/Select" id\x3d"lengthUnitDD" data-dojo-attach-point\x3d"lengthUnitDD"\x3e\r\n                        \x3coption value\x3d"feet"\x3e${nls.units.feet}\x3c/option\x3e\r\n                        \x3coption value\x3d"kilometers" selected\x3d"selected"\x3e${nls.units.kilometers}\x3c/option\x3e\r\n                        \x3coption value\x3d"miles"\x3e${nls.units.miles}\x3c/option\x3e\r\n                        \x3coption value\x3d"meters"\x3e${nls.units.meters}\x3c/option\x3e\r\n                        \x3coption value\x3d"nautical-miles"\x3e${nls.units.nauticalMiles}\x3c/option\x3e\r\n                        \x3coption value\x3d"yards"\x3e${nls.units.yards}\x3c/option\x3e\r\n                    \x3c/select\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/fieldset\x3e\r\n        \x3cdiv class\x3d"controlGroup"\x3e\r\n            \x3clabel\x3e${nls.orientationLabel}\x3c/label\x3e\r\n            \x3cdiv class\x3d"controlItem" data-dojo-attach-point\x3d"angleInputDiv"\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox"\r\n                  style\x3d"width: 150px"\r\n                  required\x3d\'true\',\r\n                  value\x3d\'0\',\r\n                  data-dojo-props\x3d"constraints:{min:0, max:360}"\r\n                  data-dojo-attach-point\x3d"angleInput" /\x3e\r\n                \x3cselect style\x3d"width: 100px" class\x3d"controlSpace" data-dojo-type\x3d"dijit/form/Select" id\x3d"angleUnitDD" data-dojo-attach-point\x3d"angleUnitDD"\x3e\r\n                    \x3coption value\x3d"degrees"\x3e${nls.degreesLabel}\x3c/option\x3e\r\n                    \x3coption value\x3d"mils"\x3e${nls.milsLabel}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"controlGroup" \x3e\r\n          \x3cl  abel class\x3d"warning"\x3e${nls.warningMessage}\x3c/label\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"buttonContainer"\x3e\r\n            \x3cdiv class\x3d\'jimu-btn jimu-state-disabled\' data-dojo-attach-point\x3d\'okButton\' data-dojo-attach-event\x3d"onclick: okButtonClicked"\x3e${nls.common.ok}\x3c/div\x3e\r\n            \x3cdiv class\x3d\'jimu-btn\' data-dojo-attach-point\x3d\'clearGraphicsButton\'\x3e${nls.clearGraphicsLabel}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n'}});
define("dojo/_base/declare dojo/_base/lang dojo/on dojo/topic dojo/dom-attr dojo/dom-class dojo/string dojo/mouse dojo/keys dijit/_WidgetBase dijit/_TemplatedMixin dijit/TooltipDialog dijit/_WidgetsInTemplateMixin dijit/popup jimu/dijit/Message jimu/LayerInfos/LayerInfos jimu/utils esri/layers/FeatureLayer esri/layers/LabelClass esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleFillSymbol esri/symbols/TextSymbol esri/graphic esri/tasks/FeatureSet ../models/EllipseFeedback ../views/CoordinateInput ../views/EditOutputCoordinate dojo/text!../templates/TabEllipse.html dijit/form/NumberTextBox dijit/form/Select jimu/dijit/CheckBox".split(" "),
function(l,b,c,e,f,d,q,h,r,t,u,v,w,k,x,m,y,z,A,n,B,C,p,D,g,E,F,G){return l([t,u,w],{templateString:G,baseClass:"jimu-widget-TabEllipse",centerPointGraphic:null,constructor:function(a){l.safeMixin(this,a)},postCreate:function(){this.currentAngleUnit=this.angleUnitDD.get("value");this.currentLengthUnit=this.lengthUnitDD.get("value");this._labelSym=new C(this.labelSymbol);this._ptSym=new n(this.pointSymbol);this._ellipseSym=new B(this.ellipseSymbol);this.map.addLayer(this.getLayer());if(this._gl.loaded){var a=
m.getInstanceSync().getLayerInfoById("Distance \x26 Direction - Ellipse Graphics");a.showLabels();a.enablePopup()}else this._gl.on("load",b.hitch(this,function(){var a=m.getInstanceSync().getLayerInfoById("Distance \x26 Direction - Ellipse Graphics");a.showLabels();a.enablePopup()}));this.coordTool=new E({appConfig:this.appConfig,nls:this.nls},this.startPointCoords);this.coordTool.inputCoordinate.formatType="DD";this.coordinateFormat=new v({content:new F({nls:this.nls}),style:"width: 400px"});"DartTheme"===
this.appConfig.theme.name&&d.add(this.coordinateFormat.domNode,"dartThemeClaroDijitTooltipContainerOverride");this.dt=new g({map:this.map,coordTool:this.coordTool.inputCoordinate.util,nls:this.nls});this.dt.setLineSymbol(this._ellipseSym);this.dt.set("lengthUnit","kilometers");this.dt.set("angle",0);this.dt.set("ellipseType","semi");this.syncEvents();this.checkValidInputs();this.majorAxisInput.invalidMessage=this.nls.numericInvalidMessage;this.majorAxisInput.rangeMessage=this.nls.axisErrorMessage;
this.minorAxisInput.invalidMessage=this.nls.numericInvalidMessage;this.minorAxisInput.rangeMessage=this.nls.axisErrorMessage;this.angleInput.invalidMessage=this.nls.numericInvalidMessage;this.angleInput.rangeMessage=this.nls.orientationErrorMessage},getLayer:function(){if(!this._gl){var a=new A({labelExpressionInfo:{value:this.nls.ellipseMajorAxis+" {MAJOR}; "+this.nls.ellipseMinorAxis+" {MINOR}; "+this.nls.angleLabel+": {ORIENTATION_ANGLE}"}});a.symbol=this._labelSym;var b={layerDefinition:{extent:{xmin:0,
ymin:0,xmax:0,ymax:0,spatialReference:{wkid:102100,latestWkid:102100}},geometryType:"esriGeometryPolygon",objectIdField:"ObjectID",fields:[{name:"ObjectID",alias:"ObjectID",type:"esriFieldTypeOID"},{name:"MAJOR",type:"esriFieldTypeText",alias:"Major Axis"},{name:"MINOR",type:"esriFieldTypeText",alias:"Minor Axis"},{name:"ORIENTATION_ANGLE",type:"esriFieldTypeText",alias:"Orientation Angle"}]},featureSet:new D};this._gl=new z(b,{id:"Distance \x26 Direction - Ellipse Graphics",showLabels:!0});this._gl.setLabelingInfo([a]);
return this._gl}},syncEvents:function(){e.subscribe("TAB_SWITCHED",b.hitch(this,this.tabSwitched));e.subscribe(g.DD_ELLIPSE_MINOR_LENGTH_CHANGE,b.hitch(this,this.minorLengthDidChange));e.subscribe(g.DD_ELLIPSE_MAJOR_LENGTH_CHANGE,b.hitch(this,this.majorLengthDidChange));e.subscribe(g.DD_ELLIPSE_ANGLE_CHANGE,b.hitch(this,this.angleDidChange));this.dt.watch("startPoint",b.hitch(this,function(a,b,c){this.coordTool.inputCoordinate.set("coordinateEsriGeometry",c);this.dt.addStartGraphic(c,this._ptSym)}));
this.coordTool.inputCoordinate.watch("outputString",b.hitch(this,function(a,b,c){this.coordTool.manualInput||this.coordTool.set("value",c)}));this.own(this.dt.on("draw-complete",b.hitch(this,this.feedbackDidComplete)),this.ellipseType.on("change",b.hitch(this,this.ellipseTypeDDDidChange)),this.angleUnitDD.on("change",b.hitch(this,this.angleUnitDDDidChange)),this.lengthUnitDD.on("change",b.hitch(this,this.lengthUnitDDDidChange)),c(this.coordinateFormatButton,"click",b.hitch(this,this.coordinateFormatButtonWasClicked)),
c(this.coordinateFormat.content.applyButton,"click",b.hitch(this,function(){var a=this.coordinateFormat.content.formats[this.coordinateFormat.content.ct],b=a.defaultFormat,c=this.coordinateFormat.content.frmtSelect.get("value");a.useCustom&&(b=a.customFormat);this.coordTool.inputCoordinate.set("formatPrefix",this.coordinateFormat.content.addSignChkBox.checked);this.coordTool.inputCoordinate.set("formatString",b);this.coordTool.inputCoordinate.set("formatType",c);this.setCoordLabel(c);k.close(this.coordinateFormat)})),
c(this.addPointBtn,"click",b.hitch(this,this.pointButtonWasClicked)),c(this.interactiveEllipse,"change",b.hitch(this,this.interactiveCheckBoxChanged)),c(this.coordTool,"keyup",b.hitch(this,this.coordToolKeyWasPressed)),c(this.angleInput,"change",b.hitch(this,this.angleDidChange)),c(this.coordinateFormat.content.cancelButton,"click",b.hitch(this,function(){k.close(this.coordinateFormat)})),c(this.clearGraphicsButton,"click",b.hitch(this,this.clearGraphics)),c(this.majorAxisInputDiv,h.leave,b.hitch(this,
this.checkValidInputs)),c(this.minorAxisInputDiv,h.leave,b.hitch(this,this.checkValidInputs)),c(this.angleInputDiv,h.leave,b.hitch(this,this.checkValidInputs)))},okButtonClicked:function(){d.contains(this.okButton,"jimu-state-disabled")||("full"===f.get(this.ellipseType,"value")?e.publish("create-manual-ellipse",this.majorAxisInput.get("value")/2,this.minorAxisInput.get("value")/2,this.angleInput.get("value"),this.coordTool.inputCoordinate.coordinateEsriGeometry):e.publish("create-manual-ellipse",
this.majorAxisInput.get("value"),this.minorAxisInput.get("value"),this.angleInput.get("value"),this.coordTool.inputCoordinate.coordinateEsriGeometry))},majorLengthDidChange:function(a){"full"===f.get(this.ellipseType,"value")&&(a*=2);this.majorAxisInput.setValue(a)},minorLengthDidChange:function(a){"full"===f.get(this.ellipseType,"value")&&(a*=2);this.minorAxisInput.setValue(a)},angleDidChange:function(a){this.angleInput.setValue(a);this.dt.set("angle",a)},interactiveCheckBoxChanged:function(){this.tabSwitched();
this.interactiveEllipse.checked?(this.majorAxisInput.set("disabled",!0),this.minorAxisInput.set("disabled",!0),this.angleInput.set("disabled",!0)):(this.majorAxisInput.set("disabled",!1),this.minorAxisInput.set("disabled",!1),this.angleInput.set("disabled",!1));this.checkValidInputs()},coordToolKeyWasPressed:function(a){this.dt.removeStartGraphic();a.keyCode===r.ENTER&&this.coordTool.inputCoordinate.getInputType().then(b.hitch(this,function(a){"UNKNOWN"===a.inputType?(new x({message:this.nls.invalidCoordinateTypeMessage}),
this.coordTool.inputCoordinate.coordinateEsriGeometry=null):(e.publish("manual-ellipse-center-point-input",this.coordTool.inputCoordinate.coordinateEsriGeometry),this.setCoordLabel(a.inputType),this.coordTool.inputCoordinate.set("formatString",this.coordinateFormat.content.formats[a.inputType].defaultFormat),this.coordTool.inputCoordinate.set("formatType",a.inputType),this.dt.addStartGraphic(a.coordinateEsriGeometry,this._ptSym));this.checkValidInputs()}))},coordinateFormatButtonWasClicked:function(){this.coordinateFormat.content.set("ct",
this.coordTool.inputCoordinate.formatType);k.open({popup:this.coordinateFormat,around:this.coordinateFormatButton})},pointButtonWasClicked:function(){d.contains(this.addPointBtn,"drawPointBtn-active")?(this.dt.deactivate(),this.map.enableMapNavigation()):(this.coordTool.manualInput=!1,e.publish("clear-points"),this.map.disableMapNavigation(),this.interactiveEllipse.checked?this.dt.activate("polyline"):this.dt.activate("point"));d.toggle(this.addPointBtn,"drawPointBtn-active")},lengthUnitDDDidChange:function(){this.currentLengthUnit=
this.lengthUnitDD.get("value");this.dt.set("lengthUnit",this.currentLengthUnit)},ellipseTypeDDDidChange:function(){this.majorAxisLabel.textContent="full"===f.get(this.ellipseType,"value")?"Major (Diameter)":"Major (Radius)";this.minorAxisLabel.textContent="full"===f.get(this.ellipseType,"value")?"Minor (Diameter)":"Minor (Radius)"},angleUnitDDDidChange:function(){this.currentAngleUnit=this.angleUnitDD.get("value");this.dt.set("angleUnit",this.currentAngleUnit);"degrees"===this.currentAngleUnit?(this.angleInput.constraints.max=
360,this.angleInput.rangeMessage=this.nls.degreesRangeMessage):(this.angleInput.constraints.max=6400,this.angleInput.rangeMessage=this.nls.millsRangeMessage)},feedbackDidComplete:function(a){if("polygon"===a.geometry.type){a=new p(a.geometry.geometry,this._ellipseSym);var b=this.majorAxisLabel.textContent.split(" ")[1];a.setAttributes({MINOR:b+": "+this.minorAxisInput.get("displayedValue")+" "+this.lengthUnitDD.get("displayedValue"),MAJOR:b+": "+this.majorAxisInput.get("displayedValue")+" "+dijit.byId("lengthUnitDD").get("displayedValue"),
ORIENTATION_ANGLE:this.angleInput.get("displayedValue")+" "+this.angleUnitDD.get("displayedValue")});this._gl.add(a);this.map.setExtent(a.geometry.getExtent().expand(3));this._gl.refresh()}else this.checkValidInputs();this.map.enableMapNavigation();this.dt.deactivate();d.remove(this.addPointBtn,"drawPointBtn-active")},clearGraphics:function(){this._gl&&(this._gl.clear(),this.coordTool.clear());d.remove(this.addPointBtn,"drawPointBtn-active");this.checkValidInputs();for(var a=0;a<this.map.graphicsLayerIds.length;a++)this.map.getLayer(this.map.graphicsLayerIds[a]).refresh()},
setGraphicsHidden:function(){this._gl&&this._gl.hide()},setGraphicsShown:function(){this._gl&&this._gl.show()},createCenterPointGraphic:function(){null!==this.centerPointGraphic&&this._gl.remove(this.centerPointGraphic);var a=this.coordTool.inputCoordinate.coordinateEsriGeometry;a&&(this.centerPointGraphic=new p(a,new n),this._gl.add(this.centerPointGraphic))},removeCenterPointGraphic:function(){this.centerPointGraphic&&this._gl.remove(this.centerPointGraphic)},setCoordLabel:function(a){this.coordInputLabel.innerHTML=
y.sanitizeHTML(q.substitute(this.nls.centerPointLabel+" (${crdType})",{crdType:a}))},checkValidInputs:function(){d.add(this.okButton,"jimu-state-disabled");this.interactiveEllipse.checked||null!==this.coordTool.inputCoordinate.coordinateEsriGeometry&&this.majorAxisInput.isValid()&&this.minorAxisInput.isValid()&&this.angleInput.isValid()&&d.remove(this.okButton,"jimu-state-disabled")},tabSwitched:function(){this.dt.deactivate();this.dt.cleanup();this.dt.disconnectOnMouseMoveHandler();this.map.enableMapNavigation();
this.dt.removeStartGraphic();d.remove(this.addPointBtn,"drawPointBtn-active")}})});