// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://@sbaseurl@/jsapi/jsapi/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/DistanceAndDirection/templates/TabCircle.html":'\x3cdiv class\x3d"tabPanel" data-dojo-attach-point\x3d"circleContainer"\x3e\r\n    \x3cdiv class\x3d"controls"\x3e\r\n        \x3cdiv class\x3d"controlGroup"\x3e\r\n            \x3clabel\x3e${nls.circleTitle}\x3c/label\x3e\r\n            \x3cdiv class\x3d"controlItem"\x3e\r\n                \x3cselect style\x3d"width: 225px" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"creationType"\x3e\r\n                    \x3coption value\x3d"Radius" selected\x3d"selected"\x3e${nls.radiusLabel}\x3c/option\x3e\r\n                    \x3coption value\x3d"Diameter"\x3e${nls.diameterLabel}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"controlGroup"\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"coordInputLabel"\x3e${nls.centerPointLabel}\x3c/label\x3e\r\n            \x3cdiv class\x3d"controlItem"\x3e\r\n                \x3cinput class\x3d"jimu-input coordInput" data-dojo-attach-point\x3d"startPointCoords" placeholder\x3d"${nls.startPointPlaceHolderLabel}" /\x3e\r\n                \x3cdiv class\x3d"controlItem paddedLeft"\x3e\r\n                    \x3cdiv class\x3d\'add-with-icon\'\x3e\r\n                        \x3cspan title\x3d"${nls.formatInputLabel}" class\x3d"jimu-icon settingBtn" data-dojo-attach-point\x3d"coordinateFormatButton"\x3e\x3c/span\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d\'add-with-icon\'\x3e\r\n                        \x3cdiv title\x3d"${nls.drawCircleLabel}" class\x3d"drawPointBtn" data-dojo-attach-point\x3d"addPointBtn"\x3e\x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"controlGroup"\x3e\r\n                \x3cinput class\x3d"interactive-checkbox" type\x3d"checkbox" data-dojo-attach-point\x3d"interactiveCircle" /\x3e\r\n                \x3clabel data-dojo-attach-point\x3d"interactiveLabel"\x3e${nls.createCircleInteractivelyLabel}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"controlGroup"\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"radiusDiameterLabel"\x3e${nls.radiusLabel}\x3c/label\x3e\r\n            \x3cdiv class\x3d"controlItem" data-dojo-attach-point\x3d"radiusInputDiv"\x3e\r\n                \x3cinput\r\n                  style\x3d"width: 150px"\r\n                  data-dojo-type\x3d\'dijit/form/NumberTextBox\'\r\n                  required\x3d"true" value\x3d"1000" data-dojo-props\x3d"constraints: {min: 1}"\r\n                  data-dojo-attach-point\x3d"radiusInput"\x3e\r\n                \x3c/input\x3e\r\n                \x3cselect style\x3d"width: 100px" class\x3d"controlSpace noResize" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"lengthUnitDD"\x3e\r\n                    \x3coption value\x3d"feet"\x3e${nls.units.feet}\x3c/option\x3e\r\n                    \x3coption value\x3d"kilometers"\x3e${nls.units.kilometers}\x3c/option\x3e\r\n                    \x3coption value\x3d"miles"\x3e${nls.units.miles}\x3c/option\x3e\r\n                    \x3coption value\x3d"meters" selected\x3d"selected"\x3e${nls.units.meters}\x3c/option\x3e\r\n                    \x3coption value\x3d"nautical-miles"\x3e${nls.units.nauticalMiles}\x3c/option\x3e\r\n                    \x3coption value\x3d"yards"\x3e${nls.units.yards}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"controlGroup" data-dojo-attach-point\x3d\'distCalcControlDiv\'\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d\'distCalcControl\' data-dojo-type\x3d"dijit/TitlePane" data-dojo-props\x3d"title: \'Distance Calculator\', open: false"\x3e\r\n                \x3cdiv class\x3d"controlGroup"\x3e\r\n                    \x3clabel\x3e${nls.timeLabel}\x3clabel\x3e\r\n                        \x3cdiv class\x3d"controlItem"\x3e\r\n                            \x3cinput style\x3d\'width: 126px;\'\r\n                              data-dojo-type\x3d\'dijit/form/NumberTextBox\'\r\n                              required\x3d"true" value\x3d"1" data-dojo-props\x3d"\r\n                              constraints: {min: 1}"\r\n                              data-dojo-attach-point\x3d"timeInput"\x3e\r\n                            \x3c/input\x3e\r\n                            \x3cselect class\x3d"controlSpace noResize" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"timeUnitDD"\x3e\r\n                                \x3coption value\x3d"3600"\x3e${nls.hoursLabel}\x3c/option\x3e\r\n                                \x3coption value\x3d"60" selected\x3d"selected"\x3e${nls.minutesLabel}\x3c/option\x3e\r\n                                \x3coption value\x3d"1"\x3e${nls.secondsLabel}\x3c/option\x3e\r\n                            \x3c/select\x3e\r\n                        \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"controlGroup"\x3e\r\n                    \x3clabel\x3e${nls.rateLabel}\x3clabel\x3e\r\n                        \x3cdiv class\x3d"controlItem"\x3e\r\n                            \x3cinput style\x3d\'width: 126px;\'\r\n                              data-dojo-type\x3d\'dijit/form/NumberTextBox\'\r\n                              required\x3d"true" value\x3d"1" data-dojo-props\x3d"\r\n                              constraints: {min: 1}"\r\n                              data-dojo-attach-point\x3d"distanceInput"\x3e\r\n                            \x3c/input\x3e\r\n                            \x3cselect class\x3d"controlSpace noResize" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"distanceUnitDD"\x3e\r\n                                \x3coption value\x3d"0.3048;1"\x3e${nls.feetSecondsLabel}\x3c/option\x3e\r\n                                \x3coption value\x3d"0.3048;3600"\x3e${nls.feetHourLabel}\x3c/option\x3e\r\n                                \x3coption value\x3d"1000;1"\x3e${nls.kmSecondLabel}\x3c/option\x3e\r\n                                \x3coption value\x3d"1000;3600"\x3e${nls.kmHourLabel}\x3c/option\x3e\r\n                                \x3coption value\x3d"1;1" selected\x3d"selected"\x3e${nls.metersSecondLabel}\x3c/option\x3e\r\n                                \x3coption value\x3d"1;3600"\x3e${nls.metersHourLabel}\x3c/option\x3e\r\n                                \x3coption value\x3d"1609.344;1"\x3e${nls.milesSecondLabel}\x3c/option\x3e\r\n                                \x3coption value\x3d"1609.344;3600"\x3e${nls.milesHourLabel}\x3c/option\x3e\r\n                                \x3coption value\x3d"1852;1"\x3e${nls.nauticalMilesSecondLabel}\x3c/option\x3e\r\n                                \x3coption value\x3d"1852;3600"\x3e${nls.nauticalMilesHourLabel}\x3c/option\x3e\r\n                            \x3c/select\x3e\r\n                        \x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"buttonContainer"\x3e\r\n            \x3cdiv class\x3d\'jimu-btn jimu-state-disabled\' data-dojo-attach-point\x3d\'okButton\' data-dojo-attach-event\x3d"onclick: okButtonClicked"\x3e${nls.common.ok}\x3c/div\x3e\r\n            \x3cdiv class\x3d\'jimu-btn\' data-dojo-attach-point\x3d\'clearGraphicsButton\'\x3e${nls.clearGraphicsLabel}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n'}});
define("dojo/_base/declare dojo/_base/lang dojo/on dojo/topic dojo/dom-attr dojo/dom-class dojo/string dojo/mouse dojo/number dojo/keys dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/TooltipDialog dijit/popup jimu/dijit/Message jimu/LayerInfos/LayerInfos esri/layers/FeatureLayer esri/symbols/SimpleFillSymbol esri/symbols/SimpleMarkerSymbol esri/symbols/TextSymbol esri/graphic esri/geometry/webMercatorUtils esri/geometry/Polyline esri/geometry/Polygon esri/geometry/Point esri/geometry/Circle esri/tasks/FeatureSet esri/layers/LabelClass ../models/CircleFeedback ../views/CoordinateInput ../views/EditOutputCoordinate dojo/text!../templates/TabCircle.html jimu/utils dijit/form/NumberTextBox dijit/form/Select jimu/dijit/CheckBox dijit/TitlePane".split(" "),
function(k,b,d,g,q,e,r,t,f,l,u,v,w,x,h,m,n,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,p){return k([u,v,w],{templateString:N,baseClass:"jimu-widget-TabCircle",constructor:function(a){k.safeMixin(this,a)},postCreate:function(){this.useCalculatedDistance=!1;this.currentLengthUnit=this.lengthUnitDD.get("value");this._circleSym=new z(this.circleSymbol);this._ptSym=new A(this.pointSymbol);this._labelSym=new B(this.labelSymbol);this.map.addLayer(this.getLayer());if(this._gl.loaded){var a=n.getInstanceSync().getLayerInfoById("Distance \x26 Direction - Circle Graphics");
a.showLabels();a.enablePopup()}else this._gl.on("load",b.hitch(this,function(){var a=n.getInstanceSync().getLayerInfoById("Distance \x26 Direction - Circle Graphics");a.showLabels();a.enablePopup()}));this.coordTool=new L({appConfig:this.appConfig,nls:this.nls},this.startPointCoords);this.coordTool.inputCoordinate.formatType="DD";this.coordinateFormat=new x({content:new M({nls:this.nls}),style:"width: 400px"});"DartTheme"===this.appConfig.theme.name&&e.add(this.coordinateFormat.domNode,"dartThemeClaroDijitTooltipContainerOverride");
this.dt=new K({map:this.map,coordTool:this.coordTool.inputCoordinate.util,nls:this.nls});this.dt.setFillSymbol(this._circleSym);this.syncEvents();this.checkValidInputs();this.radiusInput.invalidMessage=this.nls.numericInvalidMessage;this.radiusInput.rangeMessage=this.nls.rangeErrorMessage;this.timeInput.invalidMessage=this.nls.numericInvalidMessage;this.timeInput.rangeMessage=this.nls.invalidTimeMessage;this.distanceInput.invalidMessage=this.nls.numericInvalidMessage;this.distanceInput.rangeMessage=
this.nls.invalidDistanceMessage},getLayer:function(){if(!this._gl){var a=new J({labelExpressionInfo:{value:"{Label}"}});a.symbol=this._labelSym;var b={layerDefinition:{id:"circleLayer",geometryType:"esriGeometryPolygon",objectIdField:"ObjectID",fields:[{name:"ObjectID",alias:"ObjectID",type:"esriFieldTypeOID"},{name:"Label",type:"esriFieldTypeString",alias:"Label"}]},featureSet:new I};this._gl=new y(b,{id:"Distance \x26 Direction - Circle Graphics",showLabels:!0,outFields:["*"]});this._gl.setLabelingInfo([a]);
return this._gl}},syncEvents:function(){g.subscribe("TAB_SWITCHED",b.hitch(this,this.tabSwitched));this.distCalcControl.watch("open",b.hitch(this,this.distCalcDidExpand));this.dt.watch("length",b.hitch(this,function(a,b,c){this.circleLengthDidChange(c)}));this.dt.watch("startPoint",b.hitch(this,function(a,b,c){this.coordTool.inputCoordinate.set("coordinateEsriGeometry",c);this.coordTool.inputCoordinate.set("inputType",this.coordTool.inputCoordinate.formatType);this.dt.addStartGraphic(c,this._ptSym)}));
this.dt.watch("endPoint",b.hitch(this,function(a,b,c){this.coordTool.inputCoordinate.set("coordinateEsriGeometry",c)}));this.coordTool.inputCoordinate.watch("outputString",b.hitch(this,function(a,b,c){this.coordTool.manualInput||this.coordTool.set("value",c)}));this.dt.on("draw-complete",b.hitch(this,this.feedbackDidComplete));this.own(d(this.coordTool,"keyup",b.hitch(this,this.coordToolKeyWasPressed)),this.lengthUnitDD.on("change",b.hitch(this,this.lengthUnitDDDidChange)),this.creationType.on("change",
b.hitch(this,this.creationTypeDidChange)),this.distanceUnitDD.on("change",b.hitch(this,this.distanceInputDidChange)),this.timeUnitDD.on("change",b.hitch(this,this.timeInputDidChange)),d(this.coordinateFormatButton,"click",b.hitch(this,this.coordinateFormatButtonWasClicked)),d(this.addPointBtn,"click",b.hitch(this,this.pointButtonWasClicked)),d(this.timeInput,"change",b.hitch(this,this.timeInputDidChange)),d(this.distanceInput,"change",b.hitch(this,this.distanceInputDidChange)),d(this.distanceInput,
"keyup",b.hitch(this,this.distanceInputKeyWasPressed)),d(this.clearGraphicsButton,"click",b.hitch(this,this.clearGraphics)),d(this.interactiveCircle,"change",b.hitch(this,this.interactiveCheckBoxChanged)),d(this.coordinateFormat.content.applyButton,"click",b.hitch(this,function(){var a=this.coordinateFormat.content.formats[this.coordinateFormat.content.ct],b=a.defaultFormat,c=this.coordinateFormat.content.frmtSelect.get("value");a.useCustom&&(b=a.customFormat);this.coordTool.inputCoordinate.set("formatPrefix",
this.coordinateFormat.content.addSignChkBox.checked);this.coordTool.inputCoordinate.set("formatString",b);this.coordTool.inputCoordinate.set("formatType",c);this.setCoordLabel(c);h.close(this.coordinateFormat)})),d(this.coordinateFormat.content.cancelButton,"click",b.hitch(this,function(){h.close(this.coordinateFormat)})),d(this.radiusInputDiv,t.leave,b.hitch(this,this.checkValidInputs)))},circleLengthDidChange:function(a){a=f.format(a,{places:2});this.radiusInput.set("value",a)},interactiveCheckBoxChanged:function(){this.tabSwitched();
this.interactiveCircle.checked?(this.radiusInput.set("disabled",!0),this.distCalcControl.set("open",!1),this.distCalcControl.set("open",!1),this.distCalcControl.set("toggleable",!1)):(this.radiusInput.set("disabled",!1),this.distCalcControl.set("disabled",!1),this.distCalcControl.set("toggleable",!0));this.checkValidInputs()},coordToolKeyWasPressed:function(a){this.dt.removeStartGraphic();a.keyCode===l.ENTER&&this.coordTool.inputCoordinate.getInputType().then(b.hitch(this,function(a){"UNKNOWN"===
a.inputType?(new m({message:this.nls.invalidCoordinateTypeMessage}),this.coordTool.inputCoordinate.coordinateEsriGeometry=null):(g.publish("manual-circle-center-point-input",this.coordTool.inputCoordinate.coordinateEsriGeometry),this.setCoordLabel(a.inputType),this.coordTool.inputCoordinate.set("formatString",this.coordinateFormat.content.formats[a.inputType].defaultFormat),this.coordTool.inputCoordinate.set("formatType",a.inputType),this.dt.addStartGraphic(a.coordinateEsriGeometry,this._ptSym));
this.checkValidInputs()}))},coordinateFormatButtonWasClicked:function(){this.coordinateFormat.content.set("ct",this.coordTool.inputCoordinate.formatType);h.open({popup:this.coordinateFormat,around:this.coordinateFormatButton})},distCalcDidExpand:function(){this.dt.deactivate();this.dt.cleanup();this.dt.disconnectOnMouseMoveHandler();this.coordTool.inputCoordinate.isManual=!0;this.distCalcControl.get("open")?this.radiusInput.set("disabled",!0):(this.radiusInput.set("disabled",!1),this.timeInput.set("value",
1),this.distanceInput.set("value",1))},timeInputDidChange:function(){this.currentTimeInSeconds=this.timeInput.get("value")*this.timeUnitDD.get("value");this.getCalculatedDistance()},distanceInputKeyWasPressed:function(a){this.distanceInputDidChange();a.keyCode===l.ENTER&&(this.coordTool.inputCoordinate.outputString&&""!==this.coordTool.inputCoordinate.inputString?(this.removeManualGraphic(),this.setGraphic(!0),this.dt._onDoubleClickHandler()):new m({message:this.nls.noCenterPointSetMessage}))},okButtonClicked:function(){e.contains(this.okButton,
"jimu-state-disabled")||(this.removeManualGraphic(),this.setGraphic(!0))},distanceInputDidChange:function(){this.currentDistanceInMeters=this.distanceInput.get("value")*this.distanceUnitDD.value.split(";")[0]/this.distanceUnitDD.value.split(";")[1];this.getCalculatedDistance()},getCalculatedDistance:function(){if(this.currentTimeInSeconds&&0<this.currentTimeInSeconds&&this.currentDistanceInMeters&&0<this.currentDistanceInMeters){this.calculatedRadiusInMeters=this.currentTimeInSeconds*this.currentDistanceInMeters;
this.useCalculatedDistance=!0;var a=0;switch(this.currentLengthUnit){case "feet":a=3.2808399*this.calculatedRadiusInMeters;break;case "meters":a=this.calculatedRadiusInMeters;break;case "yards":a=1.0936133*this.calculatedRadiusInMeters;break;case "kilometers":a=.001*this.calculatedRadiusInMeters;break;case "miles":a=6.21371192E-4*this.calculatedRadiusInMeters;break;case "nautical-miles":a=5.39957E-4*this.calculatedRadiusInMeters}a="Diameter"===this.creationType.get("value")?2*a:a;a=f.format(a,{places:"4"});
this.radiusInput.set("value",a)}else this.calculatedRadiusInMeters=null,this.useCalculatedDistance=!0},pointButtonWasClicked:function(){e.contains(this.addPointBtn,"drawPointBtn-active")?(this.dt.deactivate(),this.map.enableMapNavigation()):(this.coordTool.manualInput=!1,g.publish("clear-points"),this.map.disableMapNavigation(),this.dt.set("isDiameter","Diameter"===this.creationType.get("value")),this.distCalcControl.get("open")?this.dt.activate("point"):this.interactiveCircle.checked?this.dt.activate("polyline"):
this.dt.activate("point"));e.toggle(this.addPointBtn,"drawPointBtn-active")},lengthUnitDDDidChange:function(){this.currentLengthUnit=this.lengthUnitDD.get("value");this.dt.set("lengthUnit",this.currentLengthUnit);this.distCalcControl.get("open")&&this.distanceInputDidChange()},creationTypeDidChange:function(){var a=this.creationType.get("value");this.radiusDiameterLabel.innerHTML=p.sanitizeHTML(a)},feedbackDidComplete:function(a){if(a.geometry.center){var b=a.geometry.center,c=new G(a.geometry.rings[0][0][0],
a.geometry.rings[0][0][1],a.geometry.center.spatialReference);a=new E(a.geometry.center.spatialReference);a.addPath([b,c]);this.setGraphic(!1,a)}else e.toggle(this.addPointBtn,"drawPointBtn-active"),this.map.enableMapNavigation(),this.dt.deactivate(),this.checkValidInputs()},setCoordLabel:function(a){this.coordInputLabel.innerHTML=p.sanitizeHTML(r.substitute(this.nls.centerPointLabel+" (${crdType})",{crdType:a}))},removeManualGraphic:function(){null!==this.tempGraphic&&this._gl.remove(this.tempGraphic);
this.dt.removeStartGraphic()},setGraphic:function(a,b){a||e.toggle(this.addPointBtn,"drawPointBtn-active");this.map.enableMapNavigation();this.dt.deactivate();this.dt.removeStartGraphic();a="Diameter"===this.creationType.get("value")?f.parse(this.radiusInput.get("value"),{places:"0,99"})/2:f.parse(this.radiusInput.get("value"),{places:"0,99"});a=this.coordTool.inputCoordinate.util.convertToMeters(a,this.lengthUnitDD.get("value"));b=this.coordTool.inputCoordinate.coordinateEsriGeometry;var c=null,
c=4326===this.map.spatialReference.wkid?b:D.geographicToWebMercator(b);b=new H({center:c,radius:a,geodesic:!0,numberOfPoints:360});a=new F(this.map.spatialReference);a.addRing(b.rings[0]);b=new C(a,this._circleSym,{Label:this.creationType.get("displayedValue")+" "+this.radiusInput.get("displayedValue")+" "+this.lengthUnitDD.get("displayedValue")});this._gl.add(b);this.map.setExtent(a.getExtent().expand(3));this.emit("graphic_created",this.currentCircle);this.dt.set("startPoint",null)},clearGraphics:function(){this._gl&&
(this._gl.clear(),this._gl.refresh(),this.clearUI(!1));this.checkValidInputs();for(var a=0;a<this.map.graphicsLayerIds.length;a++)this.map.getLayer(this.map.graphicsLayerIds[a]).refresh()},clearUI:function(a){a||this.coordTool.clear();this.dt.set("startPoint",null);this.useCalculatedDistance=!1;this.currentCircle=null;e.remove(this.addPointBtn,"drawPointBtn-active");q.set(this.startPointCoords,"value","");this.radiusInput.set("value",1E3);this.timeInput.set("value",1);this.distanceInput.set("value",
1)},setGraphicsHidden:function(){this._gl&&this._gl.hide()},setGraphicsShown:function(){this._gl&&this._gl.show()},checkValidInputs:function(){e.add(this.okButton,"jimu-state-disabled");this.interactiveCircle.checked||null!==this.coordTool.inputCoordinate.coordinateEsriGeometry&&this.radiusInput.isValid()&&e.remove(this.okButton,"jimu-state-disabled")},tabSwitched:function(){this.dt.deactivate();this.dt.cleanup();this.dt.disconnectOnMouseMoveHandler();this.dt.set("startPoint",null);this.map.enableMapNavigation();
this.dt.removeStartGraphic();e.remove(this.addPointBtn,"drawPointBtn-active")}})});