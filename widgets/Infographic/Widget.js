// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://@sbaseurl@/jsapi/jsapi/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"jimu/dijit/GridLayout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/_WidgetBase dojo/dom-geometry dojo/dom-class dojo/Evented dojo/debounce".split(" "),function(m,k,h,c,a,b,g,f){return m([c,g],{baseClass:"jimu-dijit-gridlayout",declaredClass:"jimu.dijit.GridLayout",container:null,layoutDefinition:null,components:null,editable:!1,_layout:null,_coordinates:null,_isCreatingLayout:null,postCreate:function(){this.inherited(arguments);this._isCreatingLayout=
!1;this._createLayout(this.layoutDefinition)},restoreLayout:function(a){a=a||this.layoutDefinition;this._createLayout(a)},destroy:function(){h.forEach(this.components,function(a){a.dijit.destroy()});this._layout.destroy();this.inherited(arguments)},getLayoutDefinition:function(){return this._layout.toConfig().content},resize:function(){var b=a.getMarginBox(this.container);this._layout.updateSize(b.w,b.h)},getComponentSize:function(a){return(a=this._layout.root.contentItems[0].getItemsById(a))&&0<
a.length?(a=a[0].container,{w:a.width,h:a.height}):{w:0,h:0}},getSize:function(){return{w:this._layout.width,h:this._layout.height}},setVisible:function(a,b){var d=this._layout.root.contentItems[0].getItemsById(a);d&&0<d.length&&!1===b?this._hideComponent(d[0]):d&&0!==d.length||!0!==b||this._showComponent(a)},_createLayout:function(a){if(!this._isCreatingLayout){this._coordinates={};this._isCreatingLayout=!0;var c={settings:{hasHeaders:!1,resizeEnabled:this.editable,reorderEnabled:this.editable,selectionEnabled:this.editable},
dimensions:{borderWidth:1,dragProxyWidth:0,dragProxyHeight:0},content:a},d=this._layout;require(["libs/goldenlayout/goldenlayout"],k.hitch(this,function(a){this._layout=new a(c,this.container);this._layout.registerComponent("jimu grid",k.hitch(this,function(a,d){var e;a.parent.config.id=d.id;h.some(this.components,function(l){if(l.id===d.id)return e=l.dijit,a.getElement().html(l.dijit.domNode),!0},this);a.on("resize",f(k.hitch(this,function(){0<a.width&&0<a.height&&e&&"function"===typeof e.resize&&
e.resize(a.width,a.height)}),200));a.on("select",k.hitch(this,function(){this.editable&&a.parent.select();this.emit("mask-click",a.parent.config.id)}))}));this._layout.on("initialised",k.hitch(this,function(){this._resetCoordinate();this.emit("initialised");this._isCreatingLayout=!1;d&&d.destroy()}));this._layout.on("stateChanged",k.hitch(this,function(){this._resetCoordinate()}));this._layout.init();this.editable||b.add(this._layout.root.childElementContainer[0],"viewonly");b.add(this._layout.root.childElementContainer[0],
"jimu-dijit-gridlayout");setTimeout(k.hitch(this,this.resize),100)}))}},_hideComponent:function(a){a.parent&&a.parent.removeChild(a,!0)},_showComponent:function(a){var b,d,e,l,c,g,r;h.some(this.components,function(d){if(d.id===a)return b=d,!0},this);b&&(l={id:a,type:"component",componentName:"jimu grid",componentState:{id:a}},d=this._coordinates[a],c=this._layout.root,d?(d[0].type!==c.contentItems[0].type&&(g=c.contentItems[0],c.replaceChild(g,{type:d[0].type,content:[]}),c.contentItems[0].addChild(g)),
e=c,h.forEach(d,function(a){r=a.index<=e.contentItems.length?a.index:e.contentItems.length;"component"===a.type?e.addChild(l,r):("stack"!==a.type&&e.contentItems[a.index].type===a.type||e.addChild({type:a.type,content:[]},r),e=e.contentItems[r])},this)):("stack"===c.contentItems[0].type&&(g=c.contentItems[0],c.replaceChild(g,{type:"column",content:[]}),c.contentItems[0].addChild(g)),c.contentItems[0].addChild(l)))},_resetCoordinate:function(){var a=this._layout.root.getItemsByType("component"),b=
function(a,e){var d=a.parent;d&&(h.some(d.contentItems,function(d,l){if(d===a)return e.push({type:d.type,index:l}),!0}),b(d,e))};h.forEach(a,function(a){var d=[];b(a,d);this._coordinates[a.config.id]=d.reverse()},this)}})})},"widgets/Infographic/DijitFactory":function(){define("dojo/aspect dojo/_base/lang ./dijits/TextDijit ./dijits/ImageDijit ./dijits/ChartDijit ./dijits/GaugeDijit ./dijits/NumberDijit".split(" "),function(m,k,h,c,a,b,g){var f={},n={},q=null,d=null,e=null,l=null,p={};f._dijits=n;
f.createDijit=function(f){if(n[f.id])return n[f.id];var r;switch(f.type){case "text":r=h;break;case "image":r=c;break;case "chart":r=a;break;case "gauge":r=b;break;case "number":r=g}if(!r)return console.error("Unknow type:",f.type),null;var t={nls:q,config:f.config,map:d,inSettingPage:e,appConfig:l,jsonId:f.id};k.mixin(t,p);r=new r(t);m.after(r,"destroy",function(){delete n[f.id]});return n[f.id]=r};f.setNls=function(a){q=a};f.setMap=function(a){d=a;Object.keys(n).forEach(function(a){n[a].setMap(d)})};
f.setInSettingPage=function(a){e=a;Object.keys(n).forEach(function(a){n[a].setInSettingPage(e)})};f.setAppConfig=function(a){l=a;Object.keys(n).forEach(function(a){n[a].setAppConfig(l)})};f.setContext=function(a){p=a;Object.keys(n).forEach(function(a){k.mixin(n[a],p)})};return f})},"widgets/Infographic/dijits/TextDijit":function(){define(["dojo/_base/declare","dojo/_base/html","./BaseDijit","./styleUtils"],function(m,k,h,c){return m([h],{templateString:"\x3cdiv\x3e\x3c/div\x3e",type:"text",config:null,
postCreate:function(){this.setConfig(this.config)},setConfig:function(a){this.config=a;k.empty(this.domNode);k.addClass(this.domNode,"table-layout-container");k.addClass(this.domNode,"no-trim");this.innerDom=k.create("div",{},this.domNode);k.place(this.innerDom,this.domNode);a={};c.background.setStyle(this.config.background,a,this);c.font.setStyle(this.config.font,a);c.font.setText(this.config,this);k.setStyle(this.innerDom,a)}})})},"widgets/Infographic/dijits/BaseDijit":function(){define(["dojo/_base/declare",
"dijit/_WidgetBase","dijit/_TemplatedMixin","../utils"],function(m,k,h,c){return m([k,h],{templateString:"\x3cdiv\x3ePlease create a sub class\x3c/div\x3e",type:"BaseDijit",config:null,inSettingPage:!0,appConfig:null,constructor:function(a){this.config=a.config},setInSettingPage:function(a){this.inSettingPage=a},setConfig:function(a){this.config=a},setMap:function(a){this.map=a},setDataSource:function(a){c.checkDataSourceIsVaild(a,this.map,this.appConfig)&&(this.dataSource=a)},resize:function(){},
setAppConfig:function(a){this.appConfig=a},onDataSourceDataUpdate:function(a){this.data=a},isDarkTheme:function(){var a=!1;this.appConfig&&("DashboardTheme"!==this.appConfig.theme.name||"default"!==this.appConfig.theme.styles[0]&&"style3"!==this.appConfig.theme.styles[0]?"DartTheme"===this.appConfig.theme.name&&(a=!0):a=!0);return a}})})},"widgets/Infographic/utils":function(){define(["jimu/utils","dojo/_base/lang","dojo/_base/Color"],function(m,k,h){return{checkDataSourceIsVaild:function(c,a,b){var g=
!0;c?"DATA_SOURCE_FROM_FRAMEWORK"===c.dataSourceType?b&&b.dataSource&&b.dataSource.dataSources?b.dataSource.dataSources[c.frameWorkDsId]||(g=!1):g=!1:"DATA_SOURCE_FEATURE_LAYER_FROM_MAP"===c.dataSourceType&&((c=c.layerId)&&a?a.getLayer(c)||(g=!1):g=!1):g=!1;return g},isBaseAxisChart:function(c){return"column"===c||"bar"===c||"line"===c},isInteger:function(c){return"number"===typeof c&&0===c%1},isEqual:function(c,a){return typeof c!==typeof a?!1:"object"!==typeof c?c===a:m.isEqual(c,a)},getCleanChartConfig:function(c){var a=
{mode:c.mode,type:c.type},b=a.type,g=a.mode,f=[];"feature"===g?f=f.concat(["labelField","valueFields","sortOrder","maxLabels"]):"category"===g?f=f.concat("categoryField dateConfig valueFields sortOrder operation maxLabels nullValue".split(" ")):"count"===g?f=f.concat(["categoryField","dateConfig","sortOrder","maxLabels"]):"field"===g&&(f=f.concat(["valueFields","operation","sortOrder","maxLabels","nullValue"]));g="backgroundColor seriesStyle showLegend legendTextColor legendTextSize highLightColor".split(" ");
g="pie"===b?g.concat(["showDataLabel","dataLabelColor","dataLabelSize","innerRadius"]):g.concat("showHorizontalAxis horizontalAxisTextColor horizontalAxisTextSize showVerticalAxis verticalAxisTextColor verticalAxisTextSize stack area".split(" "));f.forEach(k.hitch(this,function(b){a[b]=c[b]}));g.forEach(k.hitch(this,function(b){a[b]=c[b]}));if(!a.mode||!("count"===a.mode||a.valueFields&&a.valueFields.length)||"pie"===a.type&&""===a.maxLabels)return null;a.hasOwnProperty("showLegend")||(a.showLegend=
!1);"pie"===b?a.hasOwnProperty("showDataLabel")||(a.showDataLabel=!0):(a.hasOwnProperty("showHorizontalAxis")||(a.showHorizontalAxis=!0),a.hasOwnProperty("showVerticalAxis")||(a.showVerticalAxis=!0));return k.clone(a)},_cloneAndFormatDS:function(c){c=k.clone(c);var a={};c.name&&(a.name=c.name);c.dataSourceType&&(a.dataSourceType=c.dataSourceType);c.layerId&&(a.layerId=c.layerId);c.frameWorkDsId&&(a.frameWorkDsId=c.frameWorkDsId);c=null;return a},isDSEqual:function(c,a){if(c&&a)return c=this._cloneAndFormatDS(c),
a=this._cloneAndFormatDS(a),this.isEqual(c,a)},separationGradientColors:function(c,a){var b=[];2===c.length&&(b=this._createGradientColors(c[0],c[c.length-1],a));return b},_createGradientColors:function(c,a,b){var g=[];c=new h(c);var f=new h(a);a=(f.r-c.r)/b;for(var n=(f.g-c.g)/b,f=(f.b-c.b)/b,q=new h,d=0,e=0,l=0,p=0;p<b;p++)d=parseInt(c.r+a*p,10),e=parseInt(c.g+n*p,10),l=parseInt(c.b+f*p,10),q.setColor([d,e,l]),g.push(q.toHex());return g}}})},"widgets/Infographic/dijits/styleUtils":function(){define(["dojo/on",
"dojo/_base/lang","jimu/utils"],function(m,k,h){var c={background:{setStyle:function(a,b,g){if(!a)return{};b||(b={});c.background.setBackgroundColor(a,b);c.background.setAlignment(a,b);c.background.setLink(a,b,g)},setBackgroundColor:function(a,b){a.backgroundColor&&(b.backgroundColor=a.backgroundColor)},setAlignment:function(a,b){if(a.alignment){if(a.alignment.horizontal)switch(a.alignment.horizontal){case "left":b.textAlign="left";break;case "center":b.textAlign="center";break;case "right":b.textAlign=
"right";break;default:b.textAlign="center"}if(a.alignment.vertical)switch(b.display="table-cell",a.alignment.vertical){case "top":b.verticalAlign="top";break;case "middle":b.verticalAlign="middle";break;case "bottom":b.verticalAlign="bottom";break;default:b.verticalAlign="middle"}}},setLink:function(a,b,c){c.clickHanlder&&(c.clickHanlder[0]&&c.clickHanlder[0].remove(),c.clickHanlder=null,b.cursor="auto");a.link&&(c.clickHanlder=c.own(m(c.domNode,"click",k.hitch(c,function(){window.open(a.link)}))),
b.cursor="pointer")}},font:{setText:function(a,b){var c="";a.text&&(c=a.text);b.innerDom.innerHTML=c},setStyle:function(a,b){if(!a)return{};b||(b={});c.font.setFont(a,b);c.font.setTextColor(a,b);c.font.setFontSize(a,b)},setFont:function(a,b){b.fontWeight="normal";b.fontStyle="normal";b.textDecoration="none";a.font&&(a.font.fontFamily&&(b.fontFamily=a.font.fontFamily),a.font.bold&&(b.fontWeight="bold"),a.font.italic&&(b.fontStyle="italic"),a.font.underline&&(b.textDecoration="underline"))},setTextColor:function(a,
b){a.textColor&&(b.color=a.textColor)},setFontSize:function(a,b){a.fontSize&&(b.fontSize=a.fontSize+"px")}},image:{setStyle:function(a,b,g){if(!a)return{};b||(b={});c.image.setBackgroundImg(a,b,g);c.image.setAlignment(a,b)},setBackgroundImg:function(a,b,c){var g="";if(g=a&&!a.image&&c&&c.folderUrl?"url("+c.folderUrl+"/images/default_image.png)":"url("+h.processUrlInWidgetConfig(a.image,c.folderUrl)+")")b.backgroundImage=g,b.backgroundRepeat="no-repeat",b.backgroundSize="contain"},setAlignment:function(a,
b){if(a&&a.background){var c="center",f="center";if(a.background.alignment){a.background.alignment.horizontal&&(c=a.background.alignment.horizontal);if(a.background.alignment.vertical)switch(a.background.alignment.vertical){case "top":f="top";break;case "middle":f="center";break;case "bottom":f="bottom";break;default:b.verticalAlign="center"}b.backgroundPosition=c+" "+f}}}},dataFormat:{getText:function(a,b){var g="";a.dataFormat&&(g=b?b:a.text,g=c.dataFormat.setDataFomat(a,g),a.dataFormat.prefix&&
(g=a.dataFormat.prefix+" "+g),a.dataFormat.suffix&&(g=g+" "+a.dataFormat.suffix));return g},setDataFomat:function(a,b){var c=a.dataFormat.unit;"none"===a.dataFormat.unit?c="":"percentage"===a.dataFormat.unit&&(c="%");return b=b+c+"("+a.dataFormat.decimalPlaces+") "}}};return c})},"widgets/Infographic/dijits/ImageDijit":function(){define(["dojo/_base/declare","dojo/_base/html","./BaseDijit","./styleUtils"],function(m,k,h,c){return m([h],{templateString:"\x3cdiv\x3e\x3c/div\x3e",type:"image",config:null,
constructor:function(a){this.config=a.config},postCreate:function(){this.setConfig(this.config)},setConfig:function(a){this.config=a;this.domNode.innerHTML="";k.addClass(this.domNode,"table-layout-container");this.innerDom=k.create("div",{"class":"image-node"},this.domNode);k.place(this.innerDom,this.domNode);a={};c.background.setStyle(this.config.background,a,this);c.image.setStyle(this.config,a,this);k.setStyle(this.innerDom,a)}})})},"widgets/Infographic/dijits/ChartDijit":function(){define("dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare dojo/Deferred ./BaseDijit moment/moment jimu/dijit/_chartDijitOption jimu/dijit/Chart jimu/DataSourceManager jimu/LayerInfos/LayerInfos ../utils".split(" "),
function(m,k,h,c,a,b,g,f,n,q,d,e){window.makeTwix(g);return c([b],{templateString:'\x3cdiv\x3e\x3cdiv data-dojo-attach-point\x3d"noDataDiv" class\x3d"no-data-tip"\x3e${nls.noData}\x3c/div\x3e\x3cdiv class\x3d"chart-dom" data-dojo-attach-point\x3d"chartDomNode"\x3e\x3c/div\x3e\x3c /div\x3e',type:"chart",baseClass:"infographic-chart-dijit",layerInfosObj:null,dataSourceManager:null,featuresCountForPreview:50,highLightColor:"#00ffff",dataSource:null,config:null,map:null,maxTimeIntervals:1E4,maxLabels:1E4,
dataSourceType:"",featureLayer:null,constructor:function(a){this.config=a.config;this.layerInfosObj=d.getInstanceSync();this.dataSourceManager=q.getInstance()},postCreate:function(){this.inherited(arguments);this.DEFAULT_CONFIG={type:this.config.type||"column",theme:this._getChartTheme(),labels:[],series:[{data:[]}]};this.domNode.style.width="100%";this.domNode.style.height="100%";this.chartDomNode.style.width="100%";this.chartDomNode.style.height="100%";var a={map:null};this.inSettingPage||(a.map=
this.map);this.chartDijitOption=new f(a);this._initChart();this._updateBackgroundColor()},_getChartTheme:function(){return this.isDarkTheme()?"dark":"light"},clearChart:function(){this._showNodata()},startup:function(){this.inherited(arguments);setTimeout(m.hitch(this,function(){this.chart.resize();this.inSettingPage?this._tryRenderChart():this.dataSource&&this.setDataSource(this.dataSource)}),200)},destroy:function(){this.chart&&this.chart.destroy();this.chart=null;this.inherited(arguments)},resize:function(){this.chart&&
this.chart.resize()},setDataSource:function(a){this.dataSourceType="";this.featureLayer=null;this.inherited(arguments);if(a)if(a.layerId)this._setDataSourceForLayerId(a);else if(a.frameWorkDsId){var d=this._getDsTypeInfoAndDsMeta(a.frameWorkDsId),e=d.dsTypeInfo;this._getPopupInfoForExtralDS(e);d=d.dsMeta;e&&d&&("Features"===d.type?this._setDataSourceForFrameworkFeatures(a,e,d):"FeatureStatistics"===d.type&&this._setDataSourceForFeatureStatistics(a,e,d))}},_getPopupInfoForExtralDS:function(a){a&&"map"===
a.from&&"undefined"!==typeof a.layerId&&(a=this.layerInfosObj.getLayerInfoById(a.layerId))&&(this.popupFieldInfos=a.getPopupInfo())},_getDsTypeInfoAndDsMeta:function(a){var d={dsTypeInfo:null,dsMeta:null};d.dsTypeInfo=this.dataSourceManager.parseDataSourceId(a);var e=this.appConfig.dataSource&&this.appConfig.dataSource.dataSources;e&&(d.dsMeta=e[a]);return d},_updateBackgroundColor:function(){this.config&&this.config.backgroundColor&&this.setBackgroundColor(this.config.backgroundColor)},setBackgroundColor:function(a){this.domNode.style.backgroundColor=
a},setConfig:function(a){this.config=a;this._updateBackgroundColor();this._tryRenderChart()},onDataSourceDataUpdate:function(a){a&&"undefined"!==typeof a.features&&(this.data=a,this._hasStatisticsed=!!a.hasStatisticsed,this._tryRenderChart())},_renderChartForStastistics:function(a){var d=a.config,e=a.statisticsFeatures;this.chartDijitOption.getLoadedLayerForSTD(a.dataSchema,d).then(function(b){b=this.chartDijitOption.getChartOption({featureLayer:b,features:e,chartConfig:d,popupFieldInfos:a.popupFieldInfos,
featureLayerForChartSymbologyChart:a.featureLayerForChartSymbologyChart},this.chart,!0);this._checkIsTooManyLabels(b)||this.chart.updateConfig(b)}.bind(this))},_renderChart:function(a){this.chartDijitOption.getLoadedLayer(a.featureLayer).then(function(d){d=this.chartDijitOption.getChartOption({featureLayer:d,features:a.features,filterByExtent:a.filterByExtent,chartConfig:a.config,popupFieldInfos:a.popupFieldInfos,featureLayerForChartSymbologyChart:a.featureLayerForChartSymbologyChart},this.chart,
!1,this._hasStatisticsed);this._checkIsTooManyLabels(d)||this.chart.updateConfig(d)}.bind(this))},_initChart:function(){this.chart=new n({chartDom:this.chartDomNode,config:this.DEFAULT_CONFIG});this.chart.placeAt(this.chartDomNode);setTimeout(m.hitch(this,function(){this.chart.resize()}),300)},_tryRenderChart:function(){this._hideNodata();var a=this._getChartConfigFromConfig();a?this.domNode.parentNode?this.data?(this.data.features||(this.data.features=[]),"CLIENT_FEATURES"===this.dataSourceType?
this._tryRenderChartForClientFeatures(a):"FRAMEWORK_FEATURES"===this.dataSourceType?this._tryRenderChartForFrameworkFeatures(a):"FRAMEWORK_STATISTICS"===this.dataSourceType&&this._tryRenderChartForFrameworkStatistics(a)):this._showNodata():this._showNodata():this._showNodata()},_getNodataTextColor:function(){var a="";this.config&&(a="pie"===this.config.type?this.config.dataLabelColor:this.config.horizontalAxisTextColor||this.config.verticalAxisTextColor);a||(a="#666");return a},_getChartConfigFromConfig:function(){var a=
null,d=null;this.config&&this.config.mode&&this.config.type&&(d=m.clone(this.config),d.highLightColor=this.highLightColor,a=e.getCleanChartConfig(d));this._specialSortOrder(a);return a},_specialSortOrder:function(a){if(a){var d=a.sortOrder;"feature"===a.mode&&d&&d.field===a.labelField&&(d.isLabelAxis=!0)}},_hasFeatures:function(){return this.data&&this.data.features&&0<=this.data.features.length},showNoData:function(){this._showNodata()},_showNodata:function(a){k.addClass(this.domNode,"no-data");
"timeInterval"===a?this.noDataDiv.innerHTML=this.nls.parsingperiodTip:"maxLabels"===a&&(this.noDataDiv.innerHTML=this.nls.manyCategoryTip);this.chart.clear()},_hideNodata:function(){k.removeClass(this.domNode,"no-data")},_showMockData:function(a){a=m.clone(a);var d=[];a.labelField&&d.push(a.labelField);a.categoryField&&d.push(a.categoryField);a.valueFields&&(d=d.concat(a.valueFields));var e={fields:[]},b={attributes:{}};e.fields=h.map(d,m.hitch(this,function(a){b.attributes[a]=0;return{name:a,type:"esriFieldTypeInteger",
alias:a}}));this.chart.resize();if(this._checkIsTooManyTimeInterval([b],a))return this._showNodata("timeInterval");this._renderChart({featureLayer:e,features:[b],config:a,popupFieldInfos:this.popupFieldInfos})},_setDataSourceForLayerId:function(a){this.dataSourceType="CLIENT_FEATURES";this._getFeatureLayerAndPopupInfoForMapLayer(a.layerId).then(function(a){this.featureLayer=a;this._tryRenderChart()}.bind(this),function(){console.warn("invaild data source")})},_getFeatureLayerAndPopupInfoForMapLayer:function(d){var e=
new a;d=this.layerInfosObj.getLayerInfoById(d);if(!d)return e.reject(),e;this.popupFieldInfos=d.getPopupInfo();return d.getLayerObject()},_tryRenderChartForClientFeatures:function(a){if(this.featureLayer){var d=this.data.features;d&&this.inSettingPage&&(d=d.slice(0,this.featuresCountForPreview));this.chart.resize();if(this._checkIsTooManyTimeInterval(d,a))return this._showNodata("timeInterval");var e=this._getFeatureLayerForSymbolRenderChart();this._renderChart({featureLayer:this.featureLayer,features:d,
config:a,popupFieldInfos:this.popupFieldInfos,featureLayerForChartSymbologyChart:e,filterByExtent:this.dataSource.filterByExtent})}else this._showNodata()},_setDataSourceForFrameworkFeatures:function(){this.dataSourceType="FRAMEWORK_FEATURES";this._tryRenderChart()},_getFeatureLayerForSymbolRenderChart:function(a){var d=null;this.map&&"undefined"!==typeof a?d=this.map.getLayer(a):this.featureLayer&&(d=this.featureLayer);return d},_tryRenderChartForFrameworkFeatures:function(a){var d=this._getDsTypeInfoAndDsMeta(this.dataSource.frameWorkDsId).dsMeta;
if(d){var e=this.data.features;e&&this.inSettingPage&&(e=e.slice(0,this.featuresCountForPreview));this.chart.resize();if(this._checkIsTooManyTimeInterval(e,a))return this._showNodata("timeInterval");var b=null;if(a.seriesStyle&&"layerSymbol"===a.seriesStyle.type){var c=this.dataSourceManager.parseDataSourceId(d.id);"undefined"!==typeof c.layerId&&(b=this._getFeatureLayerForSymbolRenderChart(c.layerId))}this._renderChart({featureLayer:d.dataSchema,features:e,config:a,popupFieldInfos:this.popupFieldInfos,
featureLayerForChartSymbologyChart:b})}else this._showNodata()},_setDataSourceForFeatureStatistics:function(){this.dataSourceType="FRAMEWORK_STATISTICS";this._tryRenderChart()},_tryRenderChartForFrameworkStatistics:function(a){var d=this._getDsTypeInfoAndDsMeta(this.dataSource.frameWorkDsId).dsMeta;if(d){var e=null;if(a.seriesStyle&&"layerSymbol"===a.seriesStyle.type){var b=this.dataSourceManager.parseDataSourceId(d.id);"undefined"!==typeof b.layerId&&(e=this._getFeatureLayerForSymbolRenderChart(b.layerId))}this.chart.resize();
if(this._checkIsTooManyTimeInterval(this.data.features,a))return this._showNodata("timeInterval");this._renderChartForStastistics({dataSchema:d.dataSchema,statisticsFeatures:this.data.features,config:a,popupFieldInfos:this.popupFieldInfos,featureLayerForChartSymbologyChart:e})}else this._showNodata()},_checkIsTooManyLabels:function(a){return(a=a.labels)&&a.length>this.maxLabels?(this._showNodata("maxLabels"),!0):!1},_checkIsTooManyTimeInterval:function(a,d){var e=d.dateConfig;if(!e||"automatic"===
e.minPeriod)return!1;var b=d.categoryField;d=a.map(m.hitch(this,function(a){return a.attributes[b]}));d=d.filter(function(a){return!!a});a=Math.min.apply(Math,d);d=Math.max.apply(Math,d);a=g(a).subtract(1,"seconds").local();d=g(d).add(1,"seconds").local();return Math.round(d.diff(a,e.minPeriod,!0))>=this.maxTimeIntervals}})})},"jimu/dijit/_chartDijitOption":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/on dojo/_base/lang dojo/Deferred esri/layers/FeatureLayer jimu/clientStatisticsUtils jimu/_chartHelpUtils".split(" "),
function(m,k,h,c,a,b,g,f){return m([k],{postMixInProperties:function(){this.nls=window.jimuNls.statisticsChart},constructor:function(a){this.map=a.map;this.chartHelpUtils=new f({map:this.map,clientStatisticsUtils:g})},getChartOption:function(a,b,d,e){d=this.chartHelpUtils.getClientStatisticUtilsOptions(a,d,e);e=d.layerOption;e.featureLayer&&this.chartHelpUtils.setLayerFeatureLayer(e.featureLayer);e.popupFieldInfos&&this.chartHelpUtils.setPopupInfo(e.popupFieldInfos);d=this._getClientStatisticsData(d.csuOptions);
a.features=a.features.filter(function(a){return!!a.attributes});this.chartHelpUtils.bindChartEvent(b,a,d);return this.getChartOptionWithData(a,d)},_getClientStatisticsData:function(a){var b=g.getClietStatisticsData(a),b=g.sortClientStatisticsData(b,a),b=g.getDataForMaxLabels(b,a.maxLabels);return b=this.chartHelpUtils.keepStatisticsDataBestDecimalPlace(a,b,a.mode)},getLoadedLayer:function(a){return this._getLoadedLayer(a)},getChartOptionWithData:function(a,b){b=this.createOptionSeries(a,b);this._assigneeSettingColorToSeries(b,
a);this.chartHelpUtils.updateChartSeriesDisplayName(b,a.chartConfig);return this._mapSettingConfigToChartOption(b,a)},_assigneeSettingColorToSeries:function(a,b){if(!a||!a.series)return a;this.chartHelpUtils.assigneeSettingColor(b.chartConfig,a.series,b.featureLayerForChartSymbologyChart)},createOptionSeries:function(a,b){var d=a.chartConfig,e=d.type;a=d.mode;var d=d.valueFields,l=[],l="count"===a?[""]:"field"===a?[""]:c.clone(d),g=null,g={type:e,labels:[],series:[]};g.series=l.map(c.hitch(this,function(a){return{name:a,
type:e,data:[]}}));b.forEach(c.hitch(this,function(a){var d=a.label;g.labels.push(d);for(var e=0;e<a.values.length;e++){var b={value:a.values[e],name:d,unit:a.unit};a.features&&(b.features=a.features);g.series[e].data.push(b)}}));return g},getLoadedLayerForSTD:function(a,b){a=this.mockLayerDefinitionForSTD(a,b);return this._getLoadedLayer(a)},mockLayerDefinitionForSTD:function(a,b){var d={type:"Table",fields:[]},e=a.fields,l=b.mode;"category"===l||"field"===l?d.fields=a.fields:"count"===l&&d.fields.push({name:"STAT_COUNT",
type:"esriFieldTypeInteger",alias:this.nls.count});"category"!==l&&"count"!==l||e.some(c.hitch(this,function(a){return a.name===b.categoryField?(d.fields.push(a),!0):!1}));return d},_getLoadedLayer:function(g){var f=new a,d=null,d="string"===typeof g?new b(g):"esri.layers.FeatureLayer"===g.declaredClass?g:new b({layerDefinition:c.clone(g),featureSet:null});d.loaded?f.resolve(d):this.own(h(d,"load",c.hitch(this,function(){f.resolve(d)})));return f},_mapSettingConfigToChartOption:function(a,b,d){var e=
b.chartConfig,l=e.type;b=e.mode;var g=["column","bar","line"];d={type:l,dataZoom:["inside","slider"],confine:!0,backgroundColor:e.backgroundColor,legend:e.showLegend,theme:d||"light",advanceOption:function(a){e.showLegend&&a.legend&&(a.legend.textStyle||(a.legend.textStyle={}),a.legend.textStyle.color=e.legendTextColor,a.legend.textStyle.fontSize=e.legendTextSize);"pie"===l?a.series&&0<a.series.length&&a.series.forEach(c.hitch(this,function(a){"pie"===a.type&&(a.label||(a.label={}),a.label.normal||
(a.label.normal={}),a.label.normal.show=e.showDataLabel,a.label.normal.textStyle||(a.label.normal.textStyle={}),a.label.normal.textStyle.color=e.dataLabelColor,a.label.normal.textStyle.fontSize=e.dataLabelSize)})):(a.xAxis||(a.xAxis={}),a.xAxis.axisLabel||(a.xAxis.axisLabel={}),a.xAxis.axisLabel.textStyle||(a.xAxis.axisLabel.textStyle={}),a.xAxis.axisLabel.textStyle.color=e.horizontalAxisTextColor,a.xAxis.axisLabel.textStyle.fontSize=e.horizontalAxisTextSize,a.yAxis||(a.yAxis={}),a.yAxis.axisLabel||
(a.yAxis.axisLabel={}),a.yAxis.axisLabel.textStyle||(a.yAxis.axisLabel.textStyle={}),a.yAxis.axisLabel.textStyle.color=e.verticalAxisTextColor,a.yAxis.axisLabel.textStyle.fontSize=e.verticalAxisTextSize)}};if("pie"===l)"field"!==b&&(b=e.seriesStyle)&&b.styles&&b.styles[0]&&(b=b.styles[0].style)&&Array.isArray(b.color)&&(g=c.clone(b.color),2===g.length&&(g=this.chartHelpUtils.getColors(c.clone(b.color),6)),d.color=g),d.innerRadius=e.innerRadius,d.labelLine=!!e.showDataLabel;else if(-1<g.indexOf(l)){e.stack||
(e.stack=!1);if("column"===l||"bar"===l||"line"===l&&e.area)d.stack=e.stack;"line"!==l||e.area||(e.area=!1);"line"===l&&(d.area=e.area);a.axisPointer=!0;a.scale=!1;a.hidexAxis=!e.showHorizontalAxis;a.hideyAxis=!e.showVerticalAxis}c.mixin(a,d);return a}})})},"jimu/clientStatisticsUtils":function(){define(["dojo/_base/lang","moment/moment","./_chartHelpUtils","jimu/utils"],function(m,k,h,c){window.makeTwix&&window.makeTwix(k);return{getClietStatisticsData:function(a){var b=a.mode;if("feature"===b)return this.getFeatureModeStatisticsData(a);
if("category"===b)return this.getCategoryModeStatisticsData(a);if("count"===b)return this.getCountModeStatisticsData(a);if("field"===b)return this.getFieldModeStatisticsData(a)},sortClientStatisticsData:function(a,b){return this.sortStatisticsData(a,b.mode,b.sortOrder,b.clusterField,b.valueFields)},getDataForMaxLabels:function(a,b){return"number"===typeof b&&0<=b&&b<a.length?a.slice(0,b):a},getFeatureModeStatisticsData:function(a){var b=a.features,c=a.clusterField,f=a.valueFields;a=a.showNullLabelData||
!0;var n=this._separateFeaturesWhetherFieldValueNull(c,b),b=n.notNullLabelFeatures,n=n.nullLabelFeatures,b=a?b.concat(n):b;a=[];return a=b.map(function(a){var d=a.attributes,e=d[c],e=this._convertingNullOrUndefinedAsPlaceholders(e);a={label:e,values:[],features:[a]};a.values=f.map(function(a){return d[a]});return a}.bind(this))},getCategoryModeStatisticsData:function(a){function b(a){var e=[],b=null,g;for(g in a){(b=a[g])&&"number"===b.type&&(g=Number(g));d&&"_NULL\x26UNDEFINED_"!==g&&(g=Number(g));
var p=c||f;b.fieldsValues=n.map(function(a){var d=a;if(p){var e=h;"average"===e&&(e="avg");d=this._mosaicFieldNameWithOperatorAndUpper(a,e)}var c=b.dataFeatures.map(m.hitch(this,function(b){var c=b.attributes[d];"undefined"===typeof c&&p&&(d=this._mosaicFieldNameWithOperatorAndLower(a,e),c=b.attributes[d]);return c})),g;if(0!==c.length){g=0;"max"===h?g=-Infinity:"min"===h&&(g=Infinity);var c=l?c.map(function(a){this._isNumber(a)||(a=0);return a}.bind(this)):c.filter(function(a){return this._isNumber(a)}.bind(this)),
f=0;c.forEach(m.hitch(this,function(a){f++;"average"===h||"sum"===h?g+=a:"max"===h?g=Math.max(g,a):"min"===h&&(g=Math.min(g,a))}));0<f?"average"===h&&(g/=f):g=null}else g=null;return{field:a,value:g}}.bind(this));b.valueFields=b.fieldsValues.map(function(a){return a.value});e.push({label:g,values:b.valueFields,features:b.dataFeatures,unit:b.unit})}return e}var c=a.forExtraSTD,f=a.hasStatisticsed,n=a.valueFields,h=a.operation,d=a.dateConfig,e=a.showNullLabelData||!0,l=a.nullValue,p=[],p=this.getCluseringObj(a.clusterField,
a.features,d);a=p.nullLabelClusteringObj;p=b.call(this,p.notNullLabelClusteringObj);a=b.call(this,a);return p=e?p.concat(a):p},getCountModeStatisticsData:function(a){function b(a){var d=[],e=null,b;for(b in a)(e=a[b])&&"number"===e.type&&(b=Number(b)),h&&"_NULL\x26UNDEFINED_"!==b&&(b=Number(b)),d.push({label:b,values:[e.count],features:e.dataFeatures,unit:e.unit});return d}var g=a.hasStatisticsed,f=a.features,n=a.clusterField,h=a.dateConfig,d=a.showNullLabelData||!0,e=[];if((a.forExtraSTD||g)&&!h){g=
this._separateFeaturesWhetherFieldValueNull(n,f);a=g.notNullLabelFeatures;var g=g.nullLabelFeatures,f=d?a.concat(g):a,l=["STAT_COUNT"];return e=f.map(function(a){var d=a.attributes,e=d[n],e=this._convertingNullOrUndefinedAsPlaceholders(e);a={label:e,values:[],features:[a]};a.values=l.map(function(a){var e=d[a];"undefined"===typeof e&&(a=c.lowerCaseString(a),e=d[a]);return e});return a}.bind(this))}g=this.getCluseringObj(n,f,h);a=g.nullLabelClusteringObj;g=b.call(this,g.notNullLabelClusteringObj);
a=b.call(this,a);return e=d?g.concat(a):g},_convertingNullOrUndefinedAsPlaceholders:function(a){return null===a||void 0===a?"_NULL\x26UNDEFINED_":a},getFieldModeStatisticsData:function(a){var b=a.forExtraSTD,c=a.hasStatisticsed,f=a.valueFields,n=a.operation,h=a.nullValue,d=a.features.map(m.hitch(this,function(a){return a.attributes})),e={},l=b||c;f.forEach(m.hitch(this,function(a){var b=a;if(l){var c=n;"average"===c&&(c="avg");b=this._mosaicFieldNameWithOperatorAndUpper(a,c)}e[a]=0;"max"===n?e[a]=
-Infinity:"min"===n&&(e[a]=Infinity);var g=d.map(function(d){var e=d[b];"undefined"===typeof e&&l&&(b=this._mosaicFieldNameWithOperatorAndLower(a,c),e=d[b]);return e}.bind(this)),f=0,g=h?g.map(function(a){this._isNumber(a)||(a=0);return a}.bind(this)):g.filter(function(a){return this._isNumber(a)}.bind(this));g.forEach(m.hitch(this,function(d){f++;e.hasOwnProperty(a)?"average"===n||"sum"===n?e[a]+=d:"max"===n?e[a]=Math.max(e[a],d):"min"===n&&(e[a]=Math.min(e[a],d)):e[a]=d}));0<f?"average"===n&&(e[a]/=
f):e[a]=null}));a=[];for(var p in e)e.hasOwnProperty(p)&&a.push({label:p,values:[e[p]]});return a},sortStatisticsData:function(a,b,g,f,n){function h(a,d,b){var e;"category"===d?b.isLabelAxis?b.isLabelAxis&&(e=a.label):b.field||1!==a.values.length?(b=n.indexOf(b.field),e=a.values[b]):e=a.values[0]:"count"===d?(e=a.label,e=b.isLabelAxis?e:a.values[0]):"field"===d?e=b.isLabelAxis?a.label:a.values[0]:"feature"===d&&a&&a.features&&a.features[0]&&(a=a.features[0].attributes)&&(e=b.isLabelAxis?a[f]:a[b.field]);
return e}if(!g)return a;var d=g.isAsc;if(!Array.isArray(a))return a;a.sort(function(a,l){a=h(a,b,g);l=h(l,b,g);"_NULL\x26UNDEFINED_"===a&&(a=Infinity);"_NULL\x26UNDEFINED_"===l&&(l=Infinity);c.isNumberOrNumberString(a)&&(a=Number(a));c.isNumberOrNumberString(l)&&(l=Number(l));var e=a>l?d:!d;Infinity===a?e=d:Infinity===l&&(e=!d);var f=0;a!==l&&(f=e?1:-1);return f}.bind(this));return a},_isNumber:function(a){return"[object number]"===Object.prototype.toString.call(a).toLowerCase()},_getDateUnit:function(a,
b){var c=b;"automatic"===b&&(b=k(a[0]).local(),a=k(a[1]).local(),a=Math.round(a.diff(b,"minute",!0)),0<=a&&1>=a?c="second":1<a&&60>=a?c="minute":60<a&&1440>=a?c="hour":1440<a&&43200>=a?c="day":43200<a&&518400>=a?c="month":518400<a&&(c="year"));return c},_getTimeRange:function(a,b){var c=a.map(m.hitch(this,function(a){return a.attributes[b]})),c=c.filter(function(a){return!!a});a=Math.min.apply(Math,c);c=Math.max.apply(Math,c);return[a,c]},_getTimeTwixs:function(a,b,c){if(0>"year month day hour minute second automatic".split(" ").indexOf(c))return console.log("Invaild data formatter: "+
c),!1;a=this._getTimeRange(a,b);if(a[0]===a[1])return!1;c=this._getDateUnit(a,c);b=this.getStartTimeByUnit(a[0],c);b=k(b).local();a=k(a[1]).local();a=b.twix(a).split(1,c);b={startValue:a[a.length-1].end().valueOf(),endValue:Infinity};a.push(b);return{twixs:a,dateUnit:c}},getCluseringObj:function(a,b,c){var g={},n={};c?(a=this.getClusteringObjForDateType(a,b,c),g=a.notNullLabelClusteringObj,n=a.nullLabelClusteringObj):(g=this._separateFeaturesWhetherFieldValueNull(a,b),b=g.nullLabelFeatures,g=this.getClusteringObjByField(g.notNullLabelFeatures,
a),n=this.getClusteringObjByField(b,a));return{notNullLabelClusteringObj:g,nullLabelClusteringObj:n}},getClusteringObjByField:function(a,b){var c={};a.forEach(m.hitch(this,function(a){var g=a.attributes[b],f=typeof g,g=this._convertingNullOrUndefinedAsPlaceholders(g),d=null;c.hasOwnProperty(g)?(d=c[g],d.dataFeatures.push(a),d.count++):(d={count:1,dataFeatures:[a],type:f},c[g]=d)}));return c},_removeNaNDataItem:function(a){return a.filter(function(a){var b=!1;a=a.category;"number"===typeof a&&(b=isNaN(a));
return!b})},_separateFeaturesWhetherFieldValueNull:function(a,b){var c=[],f=[];Array.isArray(b)&&(f=b.filter(function(b){var g=b.attributes[a];if(null===g||void 0===g)c.push(b);else return!0}));return{nullLabelFeatures:c,notNullLabelFeatures:f}},getStartTimeByUnit:function(a,b){return k(a).startOf(b).utc().valueOf()},_mosaicFieldNameWithOperatorAndUpper:function(a,b){return c.upperCaseString(a+"_"+b)},_mosaicFieldNameWithOperatorAndLower:function(a,b){return c.lowerCaseString(a+"_"+b)},getClusteringObjForDateType:function(a,
b,c){function g(a,d,e){a[d]?(a=a[d],a.count+=e.count,a.dataFeatures=a.dataFeatures.concat(e.dataFeatures)):a[d]=e}function n(a,d,e,b){d=Number(d);b=this.getStartTimeByUnit(d,b);a[b]?(a=a[b],a.count+=e.count,a.dataFeatures=a.dataFeatures.concat(e.dataFeatures)):(e.originTime=d,a[b]=e)}function h(a,d,e){e[a[0].attributes[d]]={count:1,dataFeatures:a};return e}var d=this._separateFeaturesWhetherFieldValueNull(a,b),e=d.notNullLabelFeatures;b={};b=this.getClusteringObjByField(d.nullLabelFeatures,a);d={};
if(1===e.length)d=h.call(this,e,a,d,c);else if(0!==e.length){var l=this._getTimeTwixs(e,a,c.minPeriod);if(l){var p={},k=l.dateUnit;l.twixs.forEach(function(d){var b="undefined"!==typeof d.startValue?d.startValue:d.start().valueOf(),l="undefined"!==typeof d.endValue?d.endValue:d.end().valueOf(),f={unit:k,count:0,dataFeatures:[]};e.forEach(m.hitch(this,function(d){var e=d.attributes[a];e>=b&&e<l&&(f.dataFeatures.push(d),f.count++)}));c.isNeedFilled?g.call(this,p,b,f):0<f.count&&g.call(this,p,b,f)}.bind(this));
var l={},r,u;for(r in p)p.hasOwnProperty(r)&&(u=p[r],n.call(this,l,r,u,k));for(r in l)if(l.hasOwnProperty(r)){u=l[r];var v=u.originTime;delete u.originTime;d[v]=u}}else d=h.call(this,e,a,d,c)}return{notNullLabelClusteringObj:d,nullLabelClusteringObj:b}},_mapOptions:function(a,b){"feature"===b?(b=a.labelField,delete a.labelField,a.clusterField=b,a.showNullLabelData=!0):"category"===b?(b=a.categoryField,delete a.categoryField,a.clusterField=b,a.showNullLabelData=!0):"count"===b?(b=a.categoryField,delete a.categoryField,
a.clusterField=b):"field"===b&&(a.showNullLabelData=!0);return a},_mapDataItemForStatisticsChart:function(a,b){var c,f,h;return a.map(function(a){c=a.label;delete a.label;f=a.values;delete a.values;h=a.features;delete a.features;"feature"===b?(a.category=c,a.valueFields=f,a.dataFeatures=h):"category"===b?(a.category=c,a.valueFields=f,a.dataFeatures=h):"count"===b?(a.fieldValue=c,a.count=f[0],a.dataFeatures=h):"field"===b&&(a.label=c,a.value=f[0]);return a})},getFeatureModeStatisticsInfo:function(a){var b=
new h({featureLayer:a.layerDefinition,popupFieldInfosObj:a.popupFieldInfosObj});a=this._mapOptions(a,"feature");var c=a.clusterField,f=this.getFeatureModeStatisticsData(a),f=this.sortStatisticsData(f,"feature",a.sortOrder,c),f=this.getDataForMaxLabels(f,a.maxLabels),f=b.getBestLabelDisplay(f,c,"feature"),f=b.keepStatisticsDataBestDecimalPlace(a,f,"feature");return this._mapDataItemForStatisticsChart(f,"feature")},getCategoryModeStatisticsInfo:function(a){var b=new h({featureLayer:a.layerDefinition,
popupFieldInfosObj:a.popupFieldInfosObj});a=this._mapOptions(a,"category");var c=a.clusterField,f=this.getCategoryModeStatisticsData(a),f=this.sortStatisticsData(f,"category",a.sortOrder,null,a.valueFields),f=this._removeNaNDataItem(f),f=this.getDataForMaxLabels(f,a.maxLabels),f=b.getBestLabelDisplay(f,c,"category"),f=b.keepStatisticsDataBestDecimalPlace(a,f,"category");return this._mapDataItemForStatisticsChart(f,"category")},getCountModeStatisticsInfo:function(a){var b=new h({featureLayer:a.layerDefinition,
popupFieldInfosObj:a.popupFieldInfosObj});a=this._mapOptions(a,"count");var c=a.clusterField,f=this.getCountModeStatisticsData(a),f=this.sortStatisticsData(f,"count",a.sortOrder),f=this.getDataForMaxLabels(f,a.maxLabels),f=b.getBestLabelDisplay(f,c,"count");return this._mapDataItemForStatisticsChart(f,"count")},getFieldModeStatisticsInfo:function(a){var b=new h({featureLayer:a.layerDefinition,popupFieldInfosObj:a.popupFieldInfosObj});a=this._mapOptions(a,"category");var c=this.getFieldModeStatisticsData(a),
c=this.sortStatisticsData(c,"field",a.sortOrder),c=this.getDataForMaxLabels(c,a.maxLabels),c=b.getBestLabelDisplay(c,null,"field"),c=b.keepStatisticsDataBestDecimalPlace(a,c,"field");return this._mapDataItemForStatisticsChart(c,"field")}}})},"jimu/_chartHelpUtils":function(){define("dojo/_base/declare jimu/utils dojo/_base/lang dojo/_base/config dojo/_base/Color ./_dateFormat moment/moment esri/lang esri/graphic esri/symbols/jsonUtils".split(" "),function(m,k,h,c,a,b,g,f,n,q){return m(null,{constructor:function(a){a&&
h.mixin(this,a);this.popupFieldInfos||(this.popupFieldInfos={});this.featureLayer||(this.featureLayer={});this.floatNumberFieldDecimalPlace={}},getClientStatisticUtilsOptions:function(a,e,b){var d=a.chartConfig,c=d.mode,l={};a.featureLayer&&(l.featureLayer=a.featureLayer);"undefined"!==typeof a.popupFieldInfos&&(l.popupFieldInfos=a.popupFieldInfos);e={mode:c,forExtraSTD:e,hasStatisticsed:b,features:a.features};"undefined"!==typeof a.filterByExtent&&(e.filterByExtent=a.filterByExtent);"undefined"!==
typeof d.labelField&&"feature"===c&&(e.clusterField=d.labelField);"undefined"===typeof d.categoryField||"category"!==c&&"count"!==c||(e.clusterField=d.categoryField);d.valueFields&&"undefined"!==typeof d.valueFields&&(e.valueFields=d.valueFields);"undefined"!==typeof d.operation&&(e.operation=d.operation);"undefined"!==typeof d.sortOrder&&(e.sortOrder=d.sortOrder);"undefined"!==typeof d.dateConfig&&(e.dateConfig=d.dateConfig);"undefined"!==typeof d.nullValue&&(e.nullValue=d.nullValue);"undefined"!==
typeof d.maxLabels&&(e.maxLabels=d.maxLabels);return{csuOptions:e,layerOption:l}},setLayerFeatureLayer:function(a){a&&(this.featureLayer=a)},setPopupInfo:function(a){a&&(this.popupFieldInfos=a)},getBestLabelDisplay:function(a,e,b){if("feature"===b)return this.betterDataCategoryForFeatureMode(a,e);if("category"===b||"count"===b)return this.betterDataCategoryForCategoryCountMode(a,e);if("field"===b)return this.betterDataCategoryForFieldMode(a)},betterDataCategoryForFeatureMode:function(a,e){a.forEach(h.hitch(this,
function(a){a.label=this.getBestDisplayValue(e,a.label)}));return a},betterDataCategoryForFieldMode:function(a){a.forEach(h.hitch(this,function(a){a.label=this.getFieldAlias(a.label)}));return a},betterDataCategoryForCategoryCountMode:function(a,e){a.forEach(h.hitch(this,function(a){a.label="undefined"!==typeof a.unit?this.getCategoryDisplayForDateUnit(a.label,a.unit):this.getBestDisplayValue(e,a.label)}));return a},keepStatisticsDataBestDecimalPlace:function(a,e,b){if("count"===b)return e;var d=
a.features,c=a.clusterField,l=a.valueFields,f=a.operation;a=[];l&&(a=a.concat(l));c&&a.push(c);"feature"===b?(this.calculateDecimalPlaceForFloatField(a,d),e.forEach(h.hitch(this,function(a){l.forEach(h.hitch(this,function(d,e){var b=a.values[e];this.isFloatNumberField(d)&&(b=this.getBestValueForFloatNumberField(b,d),a.values[e]=b)}))}))):"category"===b?(this.calculateDecimalPlaceForFloatField(a,d),e.forEach(h.hitch(this,function(a){l.forEach(h.hitch(this,function(d,e){var b=a.values[e];this.isFloatNumberField(d)?
(b=this.getBestValueForFloatNumberField(b,d),a.values[e]=b):this.isIntegerNumberField(d)&&"average"===f&&(b=this.getBestValueForIntegerFieldAverage(b,6),a.values[e]=b)}))}))):"field"===b&&(this.calculateDecimalPlaceForFloatField(a,d),l.forEach(h.hitch(this,function(a){e.some(h.hitch(this,function(d){if(d.label===a){var e=d.values[0];this.isFloatNumberField(a)?d.values[0]=this.getBestValueForFloatNumberField(e,a):this.isIntegerNumberField(a)&&"average"===f&&(d.values[0]=this.getBestValueForIntegerFieldAverage(e,
6));return!0}return!1}))})));return e},isIntegerNumberField:function(a){if(!this.featureLayer||!this.featureLayer.fields)return!1;var d=["esriFieldTypeSmallInteger","esriFieldTypeInteger"];return this.featureLayer.fields.some(h.hitch(this,function(e){return e.name===a&&0<=d.indexOf(e.type)}))},getBestValueForFloatNumberField:function(a,e){if(null===a)return a;e=this._getFloatNumberFieldDecimalPlace(e);return a.toFixed(e)},getBestValueForIntegerFieldAverage:function(a,e){if("number"!==typeof a)return a;
var d=0,b=a.toString().split(".");1===b.length?d=0:2===b.length&&(d=b[1].length);return 0<d?(d>e&&(d=e),a=a.toFixed(d),parseFloat(a)):a},_getFloatNumberFieldDecimalPlace:function(a){var d=0;this.floatNumberFieldDecimalPlace&&(a=this.floatNumberFieldDecimalPlace[a],"number"===typeof a&&(d=a));return d},calculateDecimalPlaceForFloatField:function(a,e){this.floatNumberFieldDecimalPlace={};var d=a.filter(h.hitch(this,function(a){return this.isFloatNumberField(a)})),b={};d.forEach(h.hitch(this,function(a){b[a]=
[]}));e&&0<e.length&&e.forEach(h.hitch(this,function(a){var e=a.attributes;e&&d.forEach(h.hitch(this,function(a){var d=e[a];"number"===typeof d&&b[a].push(d)}))}));d.forEach(h.hitch(this,function(a){this.floatNumberFieldDecimalPlace[a]=0;var d=b[a];if(0<d.length)try{var e=this.getBestDecimalPlace(d);this.floatNumberFieldDecimalPlace[a]=e}catch(v){this.floatNumberFieldDecimalPlace[a]=0,console.error(v)}this.popupFieldInfos&&(d=this.getFormatFromPopupInfo(this.popupFieldInfos,a))&&0<=d.places&&(this.floatNumberFieldDecimalPlace[a]=
d.places)}))},getBestDecimalPlace:function(a){var d=0,b={};a.forEach(function(a){a=a.toString().split(".");var d=null;1===a.length?d=0:2===a.length&&(d=a[1].length);null!==d&&(b[d]=void 0===b[d]?1:b[d]+1)});a=null;for(var c in b){c=parseInt(c,10);var f=b[c];a?f>a.value&&(a={key:c,value:f}):a={key:c,value:f}}a&&(d=parseInt(a.key,10));return d},getFormatFromPopupInfo:function(a,e){var d=null;if(!a)return d;(a=a.fieldInfos)&&0<a.length&&a.forEach(function(a){a.fieldName===e&&(d=a.format)});return d},
getAliasFromPopupInfo:function(a,e){var d=e;if(!a)return d;(a=a.fieldInfos)&&0<a.length&&a.forEach(function(a){a.fieldName===e&&(d=a.label)});return d},isFloatNumberField:function(a){if(!this.featureLayer||!this.featureLayer.fields)return!1;var d=["esriFieldTypeSingle","esriFieldTypeDouble"];return this.featureLayer.fields.some(h.hitch(this,function(e){return e.name===a&&0<=d.indexOf(e.type)}))},isNumberField:function(a){if(!this.featureLayer||!this.featureLayer.fields)return!1;var d=["esriFieldTypeSmallInteger",
"esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];return this.featureLayer.fields.some(h.hitch(this,function(e){return e.name===a&&0<=d.indexOf(e.type)}))},isDateField:function(a){return(a=this.getFieldInfo(a))?"esriFieldTypeDate"===a.type:!1},getFieldInfo:function(a){if(this.featureLayer)for(var d=this.featureLayer.fields,b=0;b<d.length;b++)if(d[b].name===a)return d[b];return null},getFieldAliasArray:function(a){return a.map(h.hitch(this,function(a){return this.getFieldAlias(a)}))},
getBestDisplayValue:function(a,e){return"_NULL\x26UNDEFINED_"===e?"null":this.isDateField(a)?this.formatedDateByPopupInfoOrLocal(a,e):this.getDisplayValForNumberCodedValueSubTypes(a,e)},formatedDateByPopupInfoOrLocal:function(a,e,b){b||(b=this.popupFieldInfos);a:{if(b&&f.isDefined(b.fieldInfos))for(var d=0,c=b.fieldInfos.length;d<c;d++){var g=b.fieldInfos[d];if(g.fieldName===a){a=g.format;break a}}a=null}e=Number(e);return k.fieldFormatter.getFormattedDate(e,a)},getDisplayValForNumberCodedValueSubTypes:function(a,
e){var d=this.tryLocaleNumber(e,a);if(this.featureLayer&&this.featureLayer.typeIdField===a){var b=this.featureLayer.types;if(b&&0<b.length&&(b=b.filter(h.hitch(this,function(a){return a.id===e})),0<b.length))return d=b[0].name}(a=this.getFieldInfo(a))&&a.domain&&(a=a.domain.codedValues)&&0<a.length&&a.some(function(a){return a.code===e?(d=a.name,!0):!1});return d},tryLocaleNumber:function(a,e){var d=a;if(f.isDefined(a)&&isFinite(a))try{var b;if(e&&this.isNumberField(e)){var c=this.popupFieldInfos[e];
b=c&&h.exists("format.places",c)?k.localizeNumberByFieldInfo(a,c):k.localizeNumber(a)}else b=a;"string"===typeof b&&(d=b)}catch(r){console.error(r)}return d+""},getCategoryDisplayForDateUnit:function(a,e){if(!e)return a;a=Number(a);return this._getFormatteredDate(a,e)},_getFormatteredDate:function(a,e){var d=this._getDateTemplate(e);0<=["year","month","day"].indexOf(e)?d=k.localizeDate(new Date(a),{selector:"date",datePattern:d.date}):(e=k.localizeDate(new Date(a),{selector:"date",datePattern:d.date}),
a=g(a).format(d.time),d=e+d.connector+a);return d},_getDateTemplate:function(a){var d=b[c.locale];(d=d||{},d.date)||(d.date={"short":"short"});d&&!d.time&&(d.time={medium:"HH:mm:ss a"});d&&!d.connector&&(d.connector=" ");d&&!d.sNoDay&&(d.sNoDay="MMM, y");var f={};"year"===a?f.date="y":"month"===a?f.date=d.date.sNoDay:"day"===a?f.date=d.date["short"]:"hour"===a?(f.date=d.date["short"],f.time="HH a",f.connector=d.connector):"minute"===a?(f.date=d.date["short"],f.time="HH:mm a",f.connector=d.connector):
"second"===a&&(f.date=d.date["short"],f.time=d.time.medium,f.connector=d.connector);return f},_getFeatureLayerGraphics:function(a){var d=null;this.map&&(d=k.getClientFeaturesFromMap(this.map,this.featureLayer,!1,!!a));return d},_getFeaturesByClusterfield:function(a,b,c,f){this.features||(this.features=this._getFeatureLayerGraphics(c));if(this.features)return c=null,a=this.clientStatisticsUtils.getCluseringObj(a,this.features,f),(b=h.mixin(a.notNullLabelClusteringObj,a.nullLabelClusteringObj)[b])&&
b.dataFeatures&&b.dataFeatures.length&&(c=b.dataFeatures),c},bindChartEvent:function(a,b,c){var d=b.filterByExtent;b=b.chartConfig;var e=b.categoryField,f=null;b&&"undefined"!==typeof b.dateConfig&&(f=b.dateConfig);this.highLightColor=b.highLightColor||"#00ffff";var g=b.mode;this.map&&0!==c.length&&(b=h.hitch(this,function(a){if("series"===a.componentType){var b=null;this.features=this._getFeatureLayerGraphics(d);if("field"===g)b=this.features;else{var l=c[a.dataIndex];l&&("feature"===g?b=l.features:
(l=l.label,"undefined"!==typeof l&&(b=this._getFeaturesByClusterfield(e,l,d,f))))}b&&("mouseover"===a.type?this._mouseOverChartItem(b):"mouseout"===a.type&&this._mouseOutChartItem(b))}}),[{name:"mouseover",callback:b},{name:"mouseout",callback:b}].forEach(h.hitch(this,function(d){a.chart.off(d.name);a.chart.on(d.name,h.hitch(this,function(a){"mouseover"===a.type?(this._hasTriggerMouseoverEvent||(this._hasTriggerMouseoverEvent=!0,d.callback(a)),setTimeout(h.hitch(this,function(){this._hasTriggerMouseoverEvent=
!1},500))):"mouseout"===a.type&&d.callback(a)}))})))},_mouseOverChartItem:function(a){this._removeTempGraphics();this._mouseOutChartItem(a);a.forEach(h.hitch(this,function(a){a._originalSymbol=a.symbol}));if(this.featureLayer&&this.featureLayer.getMap()&&this.featureLayer.visible){var d=k.getTypeByGeometryType(this.featureLayer.geometryType),b=null;if("point"===d)b=this._getHighLightMarkerSymbol(),this.tempGraphics=[],a.forEach(h.hitch(this,function(a){a=new n(a.geometry,b);this.tempGraphics.push(a);
this.featureLayer.add(a)}));else if("polyline"===d)b=this._getHighLightLineSymbol(this.highLightColor),a.forEach(h.hitch(this,function(a){a.setSymbol(b)}));else if("polygon"===d){var c=this.featureLayer.getSelectedFeatures()||[];a.forEach(h.hitch(this,function(a){var d=0<=c.indexOf(a),d=this._getHighLightFillSymbol(this.featureLayer,a,d);a.setSymbol(d)}));this.features.length!==a.length&&"polygon"===d&&(a.forEach(h.hitch(this,function(a){this.featureLayer.remove(a)})),a.forEach(h.hitch(this,function(a){this.featureLayer.add(a)})))}}},
_mouseOutChartItem:function(a){this._removeTempGraphics();a.forEach(h.hitch(this,function(a){a.setSymbol(a._originalSymbol||null)}))},_removeTempGraphics:function(){if(this.featureLayer&&this.tempGraphics&&0<this.tempGraphics.length)for(;0<this.tempGraphics.length;)this.featureLayer.remove(this.tempGraphics[0]),this.tempGraphics.splice(0,1);this.tempGraphics=null},_getHighLightMarkerSymbol:function(){var d=q.fromJson({color:[255,255,255,0],size:18,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSSquare",
outline:{color:[0,0,128,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}});d.setSize(30);d.outline.setColor(new a(this.highLightColor));return d},_getHighLightLineSymbol:function(d){var b=q.fromJson({color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"});b.setColor(new a(d||this.highLightColor));return b},_getDefaultHighLightFillSymbol:function(){var d=q.fromJson({color:[0,255,255,128],outline:{color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"});
d.outline.setColor(new a(this.highLightColor));return d},_getSymbolByRenderer:function(a,b){var d=this._getDefaultHighLightFillSymbol(),e=this.getVisualVariableByType("colorInfo",a.visualVariables);if(e){if(a=a.getColor(b,{colorInfo:e}))a=h.clone(a),d.setColor(a)}else d=a.getSymbol(b);return d},getVisualVariableByType:function(a,b){return b&&(b=b.filter(function(d){return d.type===a&&!d.target}),b.length)?b[0]:null},_getHighLightFillSymbol:function(a,b,c){var d=null,e=b.symbol,d=a.renderer;!e&&d&&
(e=this._getSymbolByRenderer(d,b));e&&"function"===typeof e.setOutline?(d=q.fromJson(e.toJson()),b=1.5,e.outline&&0<e.outline.width&&(b=e.outline.width+1),c=this._getHighLightLineSymbol(c?"#ff0000":"#00ffff"),c.setWidth(b),d.setOutline(c)):d=this._getDefaultHighLightFillSymbol();return d},_isNumberField:function(a){var d=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];return this.featureLayer.fields.some(h.hitch(this,function(b){return b.name===a&&
0<=d.indexOf(b.type)}))},getFieldAlias:function(a){var d=a;(a=this.getFieldInfo(a))&&(d=a.alias||d);this.popupFieldInfos&&(d=this.getAliasFromPopupInfo(this.popupFieldInfos,d));return d},_removeDuplicateElementForObjArray:function(a){if(!Array.isArray(a))return a;var d=[];d.push(a[0]);a.forEach(function(a){d.some(function(d){return k.isEqual(d,a)})||d.push(a)});return d},assigneeSettingColor:function(a,b,c){if(!b||!b.length)return b;var d=a.seriesStyle;if(!d)return b;"layerSymbol"===d.type?b=this._assigneeStyleLayerSymbolColor(b,
c):"series"===d.type?b=this._assigneeStyleSeriesColor(a,b):"custom"===d.type&&(b=this._assigneeStyleCustomColor(a,b));return b},_assigneeStyleCustomColor:function(a,b){a=a.seriesStyle;if(!a||!a.customColor)return b;var d=a.customColor;a=d.categories;d=d.others;if(!(a&&a.length||d&&d.length))return b;d&&d.length&&this._setCustomOthersColor(d,b);a&&a.length&&this._setCustomCategoriesColor(a,b)},_setCustomCategoriesColor:function(a,b){b.forEach(function(b){(b=b.data)&&b.length&&b.forEach(function(b){if("undefined"!==
typeof b.name){var d=this._getMatchingCustomColor(b.name,a);this.setColorToDataItem(b,d)}}.bind(this))}.bind(this))},_getMatchingCustomColor:function(a,b){var d=!1;if(!b||!b.length)return d;(b=b.filter(function(b){return b.id===a})[0])&&b.color&&(d=b.color);return d},_getMatchingCustomLabel:function(a,b){var d=!1;if(!b||!b.length)return d;(b=b.filter(function(b){return b.id===a})[0])&&b.label&&(d=b.label);return d},_setCustomOthersColor:function(a,b){this._setOtherColorForCustomColor(a,b);this._setNullLabelColorForCustomColor(a,
b)},_setOtherColorForCustomColor:function(a,b){(a=a.filter(function(a){return"others"===a.id})[0])&&a.color&&this.setColorToAllSerieDataItem(b,a.color)},_setNullLabelColorForCustomColor:function(a,b){if((a=a.filter(function(a){return"null"===a.id})[0])&&a.color){var d=a.color;b.forEach(function(a){(a=a.data)&&a.length&&a.forEach(function(a){a.name&&"_NULL\x26UNDEFINED_"===a.name&&this.setColorToDataItem(a,d)}.bind(this))}.bind(this))}},_assigneeStyleSeriesColor:function(a,b){var d=a.seriesStyle;if(!d||
!d.styles||!d.styles[0])return b;var e=a.mode,c=a.area;return b.map(function(a){var b=null,f=a.type;if("field"===e)"line"===f?(b=d.styles[0].style,a=this._setStyleToSerie(b,a,c)):(f=a.data)&&f[0]&&(a.data=f.map(function(a){b=this._getMatchingStyle(a.name,d);return this.setStyleToSerieDataItem(b,a)}.bind(this)));else if("column"===f||"bar"===f||"line"===f)"count"===e?(b=d.styles[0].style,a=this._setStyleToSerie(b,a,c)):"undefined"!==typeof a.name&&(b=this._getMatchingStyle(a.name,d))&&(a=this._setStyleToSerie(b,
a,c));return a}.bind(this))},_assigneeStyleLayerSymbolColor:function(a,b){a.forEach(function(a){(a=a.data)&&a.length&&a.forEach(function(a){var d=this._getSymbolColorForDataItem(b,a.features);d&&(a.itemStyle={normal:{color:d}})}.bind(this))}.bind(this))},_setStyleToSerie:function(a,b,c){b.itemStyle||(b.itemStyle={});b.itemStyle.normal||(b.itemStyle.normal={});a&&"undefined"!==typeof a.color&&(Array.isArray(a.color)?b.itemStyle.normal.color=a.color[0]:b.itemStyle.normal.color=a.color);a&&"undefined"!==
typeof a.opacity&&(c?(b.areaStyle||(b.areaStyle={}),b.areaStyle.normal||(b.areaStyle.normal={}),b.areaStyle.normal.opacity=1-parseFloat(a.opacity/10)):b.itemStyle.normal.opacity=1-parseFloat(a.opacity/10));return b},_getMatchingStyle:function(a,b){var d=null;b=b.styles;if(!b||!b[0]||""===a)return d;b.forEach(function(b){b.name===a&&(d=b.style)});return d},_getSymbolColorForDataItem:function(a,b){var d=!1;if(!a)return d;b=b[0];return b?d=this._getColorForFeature(a.renderer,b):d},_getColorForFeature:function(a,
b){var d=!1,c=this.getVisualVariableByType("colorInfo",a.visualVariables);c?(a=a.getColor(b,{colorInfo:c}))&&(d=this._convertToEchartsRbga(a)):(a=a.getSymbol(b))&&"undefined"!==typeof a.color&&(d=this._convertToEchartsRbga(a.color));return d},_convertToEchartsRbga:function(a){if(!a||"undefined"===typeof a.r)return a;a=window.JSON.parse(window.JSON.stringify(a));var b;b="rgba("+(a.r+",");b+=a.g+",";b+=a.b+",";return b+=a.a+")"},getColors:function(a,b){var d=[];if(2===a.length)d=this._createGradientColors(a[0],
a[a.length-1],b);else{for(var c=Math.ceil(b/a.length),e=0;e<c;e++)d=d.concat(a);d=d.slice(0,b)}return d},_createGradientColors:function(b,c,f){var d=[];b=new a(b);var e=new a(c);c=(e.r-b.r)/f;for(var g=(e.g-b.g)/f,e=(e.b-b.b)/f,l=new a,h=0,n=0,k=0,q=0;q<f;q++)h=parseInt(b.r+c*q,10),n=parseInt(b.g+g*q,10),k=parseInt(b.b+e*q,10),l.setColor([h,n,k]),d.push(l.toHex());return d},setStyleToSerieDataItem:function(a,b){b.itemStyle||(b.itemStyle={});b.itemStyle.normal||(b.itemStyle.normal={});a&&"undefined"!==
typeof a.color&&(Array.isArray(a.color)?b.itemStyle.normal.color=a.color[0]:b.itemStyle.normal.color=a.color);a&&"undefined"!==typeof a.opacity&&(b.itemStyle.normal.opacity=1-parseFloat(a.opacity/10));return b},setColorToSerie:function(a,b){if(!a||"object"!==typeof a||Array.isArray(a))return a;a.itemStyle||(a.itemStyle={});a.itemStyle.normal||(a.itemStyle.normal={});b&&(a.itemStyle.normal.color=b)},setColorToDataItem:function(a,b){if(!a||"object"!==typeof a)return a;a.itemStyle||(a.itemStyle={});
a.itemStyle.normal||(a.itemStyle.normal={});b&&(a.itemStyle.normal.color=b)},setColorToAllSerieDataItem:function(a,b){a.forEach(function(a){(a=a.data)&&a.length&&a.forEach(function(a){this.setColorToDataItem(a,b)}.bind(this))}.bind(this))},updateChartSeriesDisplayName:function(a,b){var d="feature"===b.mode?b.labelField:b.categoryField,c=b.mode,e=a.series,f=[];b=b.seriesStyle;if("custom"===b.type&&(b=b.customColor)&&b.categories&&b.categories.length){var g=b.categories,h;(b=(b.others||[]).filter(function(a){return"null"===
a.id})[0])&&b.label&&(h=b.label);e.forEach(function(a,b){(a=a.data)&&a.length&&a.forEach(function(a,d){if("undefined"!==typeof a.name){var c=a.name;if("_NULL\x26UNDEFINED_"===a.name&&h)c=h;else{var e=this._getMatchingCustomLabel(a.name,g);e&&(c=e)}a.name=c;0===b&&(f[d]=c)}}.bind(this))}.bind(this))}e.forEach(function(a,b){a.name&&(a.name=this.getFieldAlias(a.name));(a=a.data)&&a.length&&a.forEach(function(a,e){var g=a.name,r=g,r=a.unit&&g?this.getCategoryDisplayForDateUnit(g,a.unit):"field"!==c?this.getBestDisplayValue(d,
g):this.getFieldAlias(g);a.name=r;0===b&&(f[e]=r)}.bind(this))}.bind(this));a.labels=null;a.labels=f;this._removeUselessProtoTypeOfSeries(e)},_removeUselessProtoTypeOfSeries:function(a){a.forEach(function(a){(a=a.data)&&a.length&&a.forEach(function(a){"undefined"!==typeof a.features&&delete a.features;"undefined"!==typeof a.unit&&delete a.unit})})}})})},"jimu/_dateFormat":function(){define([],function(){return{ar:{date:{"short":"d/M/y",medium:"dd/MM/y","long":"d MMMM. y",onlyDate:"dd/MM",mNoDay:"MM/y",
sNoDay:"M/y"},time:{"short":"h:mm a",medium:"h:mm:ss a"}},bs:{date:{"short":"d.M.yy.",medium:"d. MMM. y.","long":"d. MMMM y.",onlyDate:"d. MMM.",mNoDay:"MMM. y.",sNoDay:"M.yy"}},cs:{date:{"short":"dd.MM.yy",medium:"d. M. y",onlyDate:"d. M.",mNoDay:"M. y",sNoDay:"MM.yy"}},da:{date:{"short":"dd/MM/y",medium:"d. MMM y","long":"d. MMMM y",onlyDate:"d. MMM",mNoDay:"MMM y",sNoDay:"MM/y"}},de:{date:{"short":"dd.MM.yy",medium:"dd.MM.y",onlyDate:"dd.MM."},connector:" , ",mNoDay:"MM.y",sNoDay:"MM.yy"},el:{date:{"short":"d/M/yy",
medium:"d MMM y",onlyDate:"d MMM"},connector:" , ",mNoDay:"MMM y",sNoDay:"M/yy"},en:{date:{"short":"M/d/yy",medium:"MMM d, y",onlyDate:"MMM d",mNoDay:"MMM, y",sNoDay:"M/yy"}},es:{date:{"short":"d/M/yy",medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"M/yy"}},et:{date:{"short":"d.MM.y",medium:"d. MMM y",onlyDate:"d. MMM",mNoDay:"MMM y",sNoDay:"MM.y"},time:{"short":"H:mm",medium:"H:mm:ss"}},fi:{date:{"short":"d.M.y",medium:"d.M.y",onlyDate:"d.M.",mNoDay:"M.y",sNoDay:"M.y"},connector:" 'klo' "},
fr:{date:{"short":"dd/MM/y",medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM/y"},connector:" '\u00e0' "},he:{date:{"short":"dd/MM/yy",medium:"d '\u05d1'MMM y",onlyDate:"d '\u05d1'MMM",mNoDay:"'\u05d1'MMM y",sNoDay:"MM/yy"},connector:" , "},hi:{date:{"short":"d/M/yy",medium:"dd/MM/y","long":"d MMMM y",onlyDate:"dd/MM",mNoDay:"MM/y",sNoDay:"M/yy"},time:{"short":"h:mm a",medium:"h:mm:ss a",sNoDay:""},connector:" , "},hr:{date:{"short":"d.M.y",medium:"d. MMM y.",onlyDate:"d. MMM",mNoDay:"MMM y.",
sNoDay:"M.y"}},id:{"short":"dd/MM/yy",date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM/yy"}},it:{date:{medium:"dd MMM y","long":"d MMMM y",onlyDate:"dd MMM",mNoDay:"MMM y",sNoDay:"MM/yy"},connector:" , "},ja:{date:{medium:"y/MM/dd",onlyDate:"MM/dd",mNoDay:"y/MM",sNoDay:"y/MM"},time:{"short":"a h:mm",medium:"a h:mm:ss"}},ko:{date:{medium:"y. M. d.",onlyDate:"M. d.",mNoDay:"y. M.",sNoDay:"yy. M."}},lt:{date:{medium:"y-MM-dd","long":"y 'm'. MMMM d 'd'.",onlyDate:"MM-dd",mNoDay:"y-MM",
sNoDay:"y-MM"},time:{medium:"HH:mm:ss"}},lv:{date:{"short":"dd.MM.y",medium:"y. 'gada' d. MMM.","long":"y. 'gada' d. MMMM",onlyDate:"d. MMM.",mNoDay:"y. 'gada' MMM.",sNoDay:"MM.y"}},nb:{date:{"short":"dd.MM.y",medium:"d. MMM y","long":"d. MMMM y",onlyDate:"d. MMM",mNoDay:"MMM y",sNoDay:"MM.y"},time:{"short":"HH:mm",medium:"HH:mm:ss"},connector:" , "},nl:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM-yy"}},pl:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM.y"},
connector:" , "},"pt-br":{date:{"short":"dd/MM/y",medium:"d 'de' MMM 'de' y",onlyDate:"d 'de' MMM",mNoDay:"MMM 'de' y",sNoDay:"MM/y"}},"pt-pt":{date:{medium:"dd/MM/y",onlyDate:"dd/MM",mNoDay:"MM/y",sNoDay:"MM/yy"}},ro:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM.y"},connector:" , "},ru:{date:{"short":"dd.MM.y",medium:"d MMM y '\u0433.'",onlyDate:"d MMM",mNoDay:"MMM y '\u0433.'",sNoDay:"MM.y"},connector:" , "},sr:{date:{medium:"dd.MM.y.",onlyDate:"dd.MM.",mNoDay:"MM.y.",sNoDay:"M.yy."},
time:{"short":"HH:mm",medium:"HH:mm:ss"}},sv:{date:{medium:"d MMM. y",onlyDate:"d MMM.",mNoDay:"MMM. y",sNoDay:"y-MM"}},th:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"M/yy"}},tr:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM.y"}},vi:{date:{"short":"dd/MM/y",medium:"d MMM, y","long":"'Ng\u00e0y' dd 'th\u00e1ng' MM 'n\u0103m' y",onlyDate:"d MMM",mNoDay:"MMM, y",sNoDay:"MM/y"},time:{"short":"hh:mm a",medium:"hh:mm:ss a"},connector:" , "},"zh-cn":{date:{"short":"y/M/d",
medium:"y'\u5e74'M'\u6708'd'\u65e5'",onlyDate:"M'\u6708'd'\u65e5'",mNoDay:"y'\u5e74'M'\u6708'",sNoDay:"y/M"}},"zh-hk":{date:{medium:"y'\u5e74'M'\u6708'd'\u65e5'",onlyDate:"M'\u6708'd'\u65e5'",mNoDay:"y'\u5e74'M'\u6708'",sNoDay:"M/y"}},"zh-tw":{date:{medium:"y'\u5e74'M'\u6708'd'\u65e5'",onlyDate:"M'\u6708'd'\u65e5'",mNoDay:"y'\u5e74'M'\u6708'",sNoDay:"y/M"}}}})},"jimu/dijit/Chart":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/html dojo/Evented libs/echarts/echarts jimu/utils ./_chartUtils ./_Gauge ./_ChartOptionFactory libs/echarts/light libs/echarts/dark".split(" "),
function(m,k,h,c,a,b,g,f,n,q){return m([k,a],{baseClass:"jimu-dijit-chart",templateString:"\x3cdiv\x3e\x3c/div\x3e",declaredClass:"jimu.dijit.chart",config:null,validConfig:{type:"column bar line pie radar funnel gauge".split(" "),common:"type title labels legend confine toolbox color theme backgroundColor scale dataZoom events series advanceOption".split(" "),axisChart:["stack","axisPointer","hidexAxis","hideyAxis","area"],pie:["labelLine","pieMode","roseType","innerRadius"],funnel:["min","max",
"funnelSort"],gauge:["shape","min","max","gaugeOption"],radar:["radarShape","indicator"]},postCreate:function(){this.inherited(arguments);var a=this._getChartBox(this.chartDom);c.setStyle(this.domNode,{width:a.w+"px",height:a.h+"px"});this.chart=b.init(this.domNode,this.config.theme||"light");this.gauge=new n({chart:this.chart});this.chartOptionFactory=new q({chart:this.chart,gauge:this.gauge});this.setConfig()},updateConfig:function(a){if(!a)return!1;this.config=h.mixin(this.config,a);a=this._chartFactory(this.config);
this.chart.setOption(a,!0);"gauge"===this.config.type&&"curved"!==this.config.shape&&this.gauge._resetGraphic(this.config);return!0},setConfig:function(a){this.config=a?a:this.config||{};if(!this._checkConfig(this.config))return!1;this._customTheme();this.clear();this.chart.setOption(this._chartFactory(this.config));this._resizeGridAndGraphicOfGauge();return!0},destroy:function(){this.config.events&&this.config.events[0]&&this.config.events.forEach(h.hitch(this,function(a){this.chart.off(a.name)}));
this.chart.clear();this.inherited(arguments)},_showInitChart:function(a){var b;b="column"===a.type||"horizontal"===a.shape||"vertical"===a.shape?"bar":a.type;var d={series:[{data:[{name:"0",value:0}]}]};f.isAxisChart(a)&&(d.xAxis={data:["0"]},d.yAxis={});d.series[0].type=b;this.chart.setOption(d,!1)},_chartFactory:function(a){a.shape||this._showInitChart(a);this.option=this.chartOptionFactory.produceOption(a);this._bindEvents(a);return this.option},clear:function(){this.chart.clear()},resize:function(a,
b){c.setStyle(this.domNode,{width:a||"100%",height:b||"100%"});this.chart.resize();this._resizeDataZoom();this._resizeGridAndGraphicOfGauge()},_getChartBox:function(){var a={w:10,h:10};if(this.chartDom){var b=c.getMarginBox(this.chartDom);0!==b.w&&(a.w=b.w);0!==b.h&&(a.h=b.h)}return a},_resizeDataZoom:function(){var a=this.option,a=this.chartOptionFactory.settingDataZoom(a,this.config);this.chart.setOption(a)},_bindEvents:function(a){a.events&&a.events[0]&&a.events.forEach(h.hitch(this,function(a){this.chart.on(a.name,
a.callback)}))},_resizeGridAndGraphicOfGauge:function(){"gauge"===this.config.type&&"curved"!==this.config.shape&&(this.gauge._resetGrid(this.config),this.gauge._resetGraphic(this.config))},_customTheme:function(){this.chart._theme||(this.chart._theme={});this.chart._theme.tooltip||(this.chart._theme.tooltip={});this.config.confine&&(this.chart._theme.tooltip.confine=!0);this.chart._theme.tooltip.axisPointer={type:"cross",label:{show:!0,precision:2,formatter:function(a){return"number"===typeof a.value?
(a=parseFloat(a.value).toFixed(2),f.tryLocaleNumber(a)):a.value}},lineStyle:{color:"#27727B",type:"dashed"},crossStyle:{color:"#27727B"},shadowStyle:{color:"rgba(200,200,200,0.3)"}};this.chart._theme.valueAxis||(this.chart._theme.valueAxis={});this.chart._theme.valueAxis.axisLabel||(this.chart._theme.valueAxis.axisLabel={});this.chart._theme.valueAxis.axisLabel.formatter=function(a){return g.localizeNumber(a)}},_checkConfig:function(a){var b=!0;a||(console.error("Empty config"),b=!1);if(!a.type||
0>this.validConfig.type.indexOf(a.type))console.error("Invaild chart type!"),b=!1;var d=h.clone(this.validConfig),c=d.common,f=[],f="column"===a.type||"bar"===a.type||"line"===a.type?c.concat(d.axisChart):c.concat(d[a.type]);Object.keys(a).forEach(function(a){0>f.indexOf(a)&&(b=!1,console.error("Invalid configuration parameter: "+a))});return b}})})},"jimu/dijit/_chartUtils":function(){define(["jimu/utils","esri/lang"],function(m,k){return{tryLocaleNumber:function(h){var c=h;if(k.isDefined(h)&&isFinite(h))try{var a=
m.localizeNumber(h);"string"===typeof a&&(c=a)}catch(b){console.error(b)}return c+""},isAxisChart:function(h){return"column"===h.type||"bar"===h.type||"line"===h.type},getAxisZeroPosition:function(h){if(!this.chart)return!1;var c={},a=0,b=0;if((m.isNotEmptyObject(h.dataZoom,!0)||h.scale)&&h.series&&h.series[0]&&h.series[0].data){var g=h.series[0].data;m.isNotEmptyObject(g,!0)&&("bar"!==h.type?b=m.getMinOfArray(g):a=m.getMinOfArray(g))}if(h=this.chart.convertToPixel({xAxisIndex:0,yAxisIndex:0},[a,
b]))a=h[1]-5,c.left=h[0]-5,c.top=a;return m.isNotEmptyObject(c)?c:!1},_getDisplayValue:function(h,c){"number"===typeof Number(h)&&(h=c?m.convertNumberToPercentage(h):this.tryLocaleNumber(h));return h},generateToolTip:function(h,c,a,b,g){var f="",f=a?'\x3cdiv class\x3d"tooltip-tr reverse"\x3e':'\x3cdiv class\x3d"tooltip-tr"\x3e';a='\x3cdiv class\x3d"colorEl marginRight5" style\x3d"background-color:'+m.encodeHTML(h.color)+'"\x3e\x3c/div\x3e';f+=a;a="";"radar"!==h.seriesType&&this._isVaildValue(h.seriesName)?
a=h.seriesName:this._isVaildValue(g)&&(a=g);f=""===a?f+("\x3cdiv\x3e"+a+"\x3c/div\x3e"):f+("\x3cdiv\x3e"+a+"\x3c/div\x3e\x3cdiv\x3e : \x3c/div\x3e");g="null";this._isNotZeroBoolean(c)?g=c:this._isVaildValue(h.value)&&(g=h.value);f+="\x3cdiv\x3e"+this._getDisplayValue(g,b)+"\x3c/div\x3e";"pie"===h.seriesType&&(h=h.percent,h=this._isVaildValue(h)?h/100:0,f+='\x3cdiv class\x3d"space-left"\x3e('+m.convertNumberToPercentage(h)+")\x3c/div\x3e");return f+"\x3c/div\x3e"},handleToolTip:function(h,c,a,b,g){var f=
'\x3cdiv class\x3d"tooltip-div"\x3e';Array.isArray(h)||(h=[h]);this._isVaildValue(h[0].name)&&(f+='\x3cdiv class\x3d"tr"\x3e'+h[0].name+"\x3c/div\x3e");h.forEach(function(h){f="radar"!==h.seriesType?f+this.generateToolTip(h,c,a,b,g):f+this._handleRadarTooltip(h,a,b,g)}.bind(this));return f+="\x3c/div\x3e"},_handleRadarTooltip:function(h,c,a,b){var g="";(h.value||[]).forEach(function(f,n){g+=this.generateToolTip(h,f,c,a,b[n])}.bind(this));return g},_isVaildValue:function(h){return"%00-"===encodeURI(h)?
!1:this._isNotZeroBoolean(h)},_isNotZeroBoolean:function(h){return 0===h?!0:!!h}}})},"jimu/dijit/_Gauge":function(){define(["dojo/_base/declare","dojo/_base/lang","jimu/utils","./_chartUtils"],function(m,k,h,c){return m([],{curvedGaugeSeries:[{type:"gauge",center:["50%","60%"],startAngle:200,endAngle:-20,axisLine:{lineStyle:{color:[[.31,"#58f7f3"],[1,"#E5E5E5"]]}},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{distance:-52,textStyle:{color:"#000"}},pointer:{length:"65%",width:5},itemStyle:{normal:{}},
detail:{show:!0,offsetCenter:[0,"60%"],textStyle:{color:"#24B5CC"}},title:{show:!1},data:[{value:0}],animationEasingUpdate:"bounceOut",animationDurationUpdate:500}],horizontalGauge:{grid:{top:"middle",height:90},xAxis:{show:!0,offset:-27,type:"value",scale:!1,interval:1,axisTick:{show:!1},axisLine:{show:!1},axisLabel:{show:!1,showMinLabel:!0,showMaxLabel:!0,textStyle:{color:"#949494",fontStyle:"normal",fontWeight:"normal",fontFamily:"Avenir Next",fontSize:12}},splitLine:{show:!1}},yAxis:{show:!1,
type:"category",data:[]},series:[{name:"",type:"bar",barWidth:30,silent:!0,animation:!1,itemStyle:{normal:{color:"#E5E5E5"}},barGap:"-100%",data:[100],z:1},{type:"bar",barWidth:30,label:{normal:{show:!0,position:"top",offset:[20,0],textStyle:{}}},data:[{value:40,label:{normal:{textStyle:{color:"#24B5CC",fontStyle:"normal",fontWeight:"normal",fontFamily:"Avenir Next",fontSize:12}}},itemStyle:{normal:{}}}],itemStyle:{normal:{color:"#24B5CC"}},z:10}]},verticalGauge:{grid:{left:"middle",width:60},yAxis:{show:!0,
offset:-10,type:"value",interval:1,scale:!1,axisTick:{show:!1},axisLine:{show:!1},axisLabel:{show:!1,showMinLabel:!0,showMaxLabel:!0,textStyle:{color:"#949494",fontStyle:"normal",fontWeight:"normal"}},splitLine:{show:!1}},xAxis:{show:!1,type:"category",data:[]},series:[{name:"",type:"bar",barWidth:30,silent:!0,animation:!1,itemStyle:{normal:{color:"#E5E5E5"}},barGap:"-100%",data:[100],z:1},{type:"bar",barWidth:30,label:{normal:{show:!0,position:"insideTopLeft",offset:[30,-15],textStyle:{}}},data:[{value:40,
label:{normal:{textStyle:{color:"#24B5CC",fontStyle:"normal",fontWeight:"normal",fontFamily:"Avenir Next",fontSize:12}}},itemStyle:{normal:{}}}],itemStyle:{normal:{color:"#24B5CC"}},z:10}]},constructor:function(a){this.chart=a.chart},_settingValueStyle:function(a,b){if(b.gaugeOption&&h.isNotEmptyObject(b.gaugeOption.valueStyle)){var c=b.gaugeOption.valueStyle,f=c.textStyle,c=c.formatter;"horizontal"===b.shape||"vertical"===b.shape?(k.mixin(a.series[1].data[0].label.normal.textStyle,f),c&&(a.series[1].data[0].label.normal.formatter=
c)):"curved"===b.shape&&(k.mixin(a.series[0].detail.textStyle,f),c&&(a.series[0].detail.formatter=c))}return a},_settingLabelColor:function(a,b){var c="#000";b.gaugeOption&&b.gaugeOption.labelColor&&(c=b.gaugeOption.labelColor);"curved"===b.shape?a.series[0].axisLabel.textStyle.color=c:"horizontal"===b.shape?a.xAxis.axisLabel.textStyle.color=c:"vertical"===b.shape&&(a.yAxis.axisLabel.textStyle.color=c);return a},_settingHorizontalGauge:function(a,b){k.mixin(a,k.clone(this.horizontalGauge));a.grid=
{top:"middle",height:90,left:"10%",right:"10%"};b.min="undefined"!==typeof b.min&&b.min?b.min:0;b.max="undefined"!==typeof b.max&&b.max?b.max:100;a.xAxis.max=b.max;a.xAxis.min=b.min;a.xAxis.scale=!0;a.series[0].data[0]=b.max;a=this._handleValue(a,b);b.labels&&b.labels[0]&&(a.series[1].data[0].name=b.labels[0]);a.series[1].name=b.series[0].name;a=this._settingNoCurvedGaugeColor(a,b);return a=this._handleHorizontalGaugeValueRTL(a,b)},_handleHorizontalGaugeValueRTL:function(a,b){if(!window.isRTL||"horizontal"!==
b.shape)return a;a.series[1].label.normal.offset=[-20,0];return a},_settingVerticalGauge:function(a,b){k.mixin(a,k.clone(this.verticalGauge));a.grid={left:"middle",width:60,top:"10%",bottom:"10%"};a.grid.left=this._getGridLeftOfVerticalGauge();b.min="undefined"!==typeof b.min&&b.min?b.min:0;b.max="undefined"!==typeof b.max&&b.max?b.max:100;a.yAxis.max=b.max;a.yAxis.min=b.min;a.series[0].data[0]=b.max;a=this._handleValue(a,b);b.labels&&b.labels[0]&&(a.series[1].data[0].name=b.labels[0]);a.series[1].name=
b.series[0].name;a=this._settingNoCurvedGaugeColor(a,b);return a=this._handleVerticalGaugeValueRTL(a,b)},_handleVerticalGaugeValueRTL:function(a,b){if(!window.isRTL||"vertical"!==b.shape)return a;var c=(b.series[0].data[0]+"").length-1;b.gaugeOption&&b.gaugeOption.valueStyle&&"undefined"!==typeof b.gaugeOption.valueStyle.decimalPlaces&&(c+=b.gaugeOption.valueStyle.decimalPlaces);a.series[1].label.normal.offset=[-17-9*c,-15];return a},_handleValue:function(a,b){var g;g=b.series[0].data[0]<=b.max?b.series[0].data[0]:
b.max;a.tooltip.formatter=function(a){return c.handleToolTip(a,b.series[0].data[0],!1)};a.series[1].data[0].value=g;return a},_settingCurvedGauge:function(a,b){a.series=k.clone(this.curvedGaugeSeries);b.min="undefined"!==typeof b.min&&b.min?b.min:0;b.max="undefined"!==typeof b.max&&b.max?b.max:100;a.series[0].min=b.min;a.series[0].max=b.max;a.tooltip.formatter=function(a){return c.handleToolTip(a,null,!1)};a.series[0].axisLine.lineStyle.color[0][0]=parseFloat(b.series[0].data[0]/b.max).toFixed(2);
a.series[0].data[0].value=b.series[0].data[0];b.labels&&b.labels[0]&&(a.series[0].data[0].name=b.labels[0]);b.series[0].name&&(a.series[0].name=b.series[0].name);a.series[0].axisLine.lineStyle.width=30;return a=this._settingCurvedGaugeColor(a,b)},_settingGaugeSeries:function(a,b){if("gauge"!==b.type)return a;"horizontal"===b.shape?a=this._settingHorizontalGauge(a,b):"vertical"===b.shape?a=this._settingVerticalGauge(a,b):"curved"===b.shape&&(a=this._settingCurvedGauge(a,b));a=this._settingGaugeLabel(a,
b);a=this._settingLabelColor(a,b);return a=this._settingValueStyle(a,b)},_resetGraphic:function(a){a=this._settingGraphic(a);this._clearGraphic();this.chart.setOption({graphic:a});this.cacheGraphic=null;this.cacheGraphic=a},_clearGraphic:function(){this.cacheGraphic&&(this.cacheGraphic.forEach(function(a){a.$action="remove"}),this.chart.setOption({graphic:this.cacheGraphic}))},_resetGrid:function(a){a=this._settingGridLeftOfVerticalGauge(a);h.isNotEmptyObject(a)&&this.chart.setOption({grid:a})},_settingGridLeftOfVerticalGauge:function(a){return"gauge"!==
a.type||"vertical"!==a.shape?{}:{left:this._getGridLeftOfVerticalGauge(),width:60,top:"10%",bottom:"10%"}},_settingCurvedGaugeColor:function(a,b){b.gaugeOption&&(b.gaugeOption.bgColor&&(a.series[0].axisLine.lineStyle.color[1][1]=b.gaugeOption.bgColor),b.gaugeOption.columnColor&&(a.series[0].axisLine.lineStyle.color[0][1]=b.gaugeOption.columnColor));return a},_settingNoCurvedGaugeColor:function(a,b){b.gaugeOption&&(b.gaugeOption.bgColor&&(a.series[0].itemStyle.normal.color=b.gaugeOption.bgColor),b.gaugeOption.columnColor&&
(a.series[1].data[0].itemStyle.normal.color=b.gaugeOption.columnColor));return a},_settingGraphic:function(a){var b=[];"gauge"===a.type&&a.gaugeOption&&("horizontal"===a.shape?b=this._settingHorizontalGraphic(a):"vertical"===a.shape&&(b=this._settingVerticalGraphic(a)));return b},_settingHorizontalGraphic:function(a){var b="#000";a.gaugeOption&&a.gaugeOption.labelColor&&(b=a.gaugeOption.labelColor);var c=[],f=this.chart.convertToPixel({yAxisIndex:0},0),f=parseInt(f,10),f=Number(f)+16;this.cacheCriticalValues=
k.clone(this.criticalValues);this.cacheCriticalValues.forEach(k.hitch(this,function(g){var n,d;"object"===typeof g?g.type&&(n=g.type,d=g.value):d=g;g=a.min||0;if(!(d>(a.max||100)||d<g)){g=this._getxAxisValueLeft(d);var e=6*(d.toString().length-2),l=g;0<e&&(l=g-e);n||c.push({z:10,type:"image",$action:"merge",id:"wab_gid_image-"+h.getRandomString(),left:g,style:{image:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjdweCIgaGVpZ2h0PSI1cHgiIHZpZXdCb3g9IjAgMCA3IDUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0NC4xICg0MTQ1NSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPlRyaWFuZ2xlPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IkxheW91dC0yTmV3IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgaWQ9IkNhcmRXaWRnZXRfTGF5b3V0NCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTg3NS4wMDAwMDAsIC0yOTcuMDAwMDAwKSIgZmlsbD0iIzkzOTM5MyI+DQogICAgICAgICAgICA8ZyBpZD0iQ2FyZDJfSG9yaXpvbnRhbEdhdWdlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3OTIuMDAwMDAwLCAxODEuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgPGcgaWQ9Ikhvcml6b250YWxHYXVnZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDY2LjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjguNTAwMDAwLCA0Mi41MDAwMDApIHJvdGF0ZSgtMjcwLjAwMDAwMCkgdHJhbnNsYXRlKC0xMjguNTAwMDAwLCAtNDIuNTAwMDAwKSB0cmFuc2xhdGUoODYuMDAwMDAwLCAtODYuMDAwMDAwKSIgaWQ9Ik51bWJlcnMrVHJpYW5nbGVzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUwLjAwMDAwMCwgMC4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iVHJpYW5nbGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIuNTAwMDAwLCAxNzAuNTQzODAzKSByb3RhdGUoLTE4MC4wMDAwMDApIHRyYW5zbGF0ZSgtMi41MDAwMDAsIC0xNzAuNTQzODAzKSAiIHBvaW50cz0iNSAxNzAuNTQzODAzIC0xLjcwNTMwMjU3ZS0xMyAxNzQuMDQzODAzIC0xLjY5NjQyMDc4ZS0xMyAxNjcuMDQzODAzIj48L3BvbHlnb24+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4\x3d",
width:10,height:10},silent:!0,top:f});c.push({z:10,type:"text",$action:"merge",id:"wab_gid_text-"+h.getRandomString(),left:l,style:{text:d,fill:b,font:"normal 11px sans-serif"},silent:!0,top:f+11})}}));return c},_settingVerticalGraphic:function(a){var b="#000";a.gaugeOption&&a.gaugeOption.labelColor&&(b=a.gaugeOption.labelColor);var c=[],f=this.chart.convertToPixel({xAxisIndex:0},0),f=parseFloat(f,10).toFixed(2),f=Number(f),n="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjVweCIgaGVpZ2h0PSI4cHgiIHZpZXdCb3g9IjAgMCA1IDgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0NC4xICg0MTQ1NSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPlRyaWFuZ2xlPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IkxheW91dC0yTmV3IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgaWQ9IkNhcmRXaWRnZXRfTGF5b3V0NCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTg3Ni4wMDAwMDAsIC0zMjQuMDAwMDAwKSIgZmlsbD0iIzkzOTM5MyI+DQogICAgICAgICAgICA8ZyBpZD0iQ2FyZDJfSG9yaXpvbnRhbEdhdWdlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3OTIuMDAwMDAwLCAxODEuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgPGcgaWQ9Ikhvcml6b250YWxHYXVnZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDY2LjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjguNTAwMDAwLCA0Mi41MDAwMDApIHJvdGF0ZSgtMjcwLjAwMDAwMCkgdHJhbnNsYXRlKC0xMjguNTAwMDAwLCAtNDIuNTAwMDAwKSB0cmFuc2xhdGUoODYuMDAwMDAwLCAtODYuMDAwMDAwKSIgaWQ9Ik51bWJlcnMrVHJpYW5nbGVzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUwLjAwMDAwMCwgMC4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iVHJpYW5nbGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMwLjYyODk1MiwgMTcwLjQ1ODY1NCkgcm90YXRlKC05MC4wMDAwMDApIHRyYW5zbGF0ZSgtMzAuNjI4OTUyLCAtMTcwLjQ1ODY1NCkgIiBwb2ludHM9IjMzLjEyODk1MjMgMTcwLjQ1ODY1NCAyOC4xMjg5NTIzIDE3My45NTg2NTQgMjguMTI4OTUyMyAxNjYuOTU4NjU0Ij48L3BvbHlnb24+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4\x3d";
window.isRTL&&(f+=40,n="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjVweCIgaGVpZ2h0PSI3cHgiIHZpZXdCb3g9IjAgMCA1IDciIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0NC4xICg0MTQ1NSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPlRyaWFuZ2xlPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IkxheW91dC0yTmV3IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgaWQ9IkFydGJvYXJkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTIxLjAwMDAwMCwgLTQ0Ny4wMDAwMDApIiBmaWxsPSIjOTM5MzkzIj4NCiAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJUcmlhbmdsZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTIzLjUwMDAwMCwgNDUwLjUwMDAwMCkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTEyMy41MDAwMDAsIC00NTAuNTAwMDAwKSAiIHBvaW50cz0iMTI2IDQ1MC41IDEyMSA0NTQgMTIxIDQ0NyI+PC9wb2x5Z29uPg0KICAgICAgICA8L2c+DQogICAgPC9nPg0KPC9zdmc+");
var q=f-26;this.cacheCriticalValues=k.clone(this.criticalValues);this.cacheCriticalValues.forEach(k.hitch(this,function(d){var e,f;"object"===typeof d?d.type&&(e=d.type,f=d.value):f=d;d=q;d=window.isRTL?q+11:q-11-6*(f.toString().length-1);var g=a.min||0;f>(a.max||100)||f<g||(g=this._getyAxisValueTop(f),g-=2,e||c.push({z:10,type:"image",$action:"merge",id:"wab_gid_image-"+h.getRandomString(),left:q,style:{image:n,width:10,height:10},silent:!0,top:g}),c.push({z:10,type:"text",$action:"merge",id:"wab_gid_text-"+
h.getRandomString(),left:d,style:{text:f,fill:b,font:"normal 11px sans-serif"},silent:!0,top:g-2}))}));return c},_getGridLeftOfVerticalGauge:function(){return this.chart.getWidth()/2-30},_getxAxisValueLeft:function(a){a=this.chart.convertToPixel({xAxisIndex:0},a);return parseFloat(a,10)-4},_getyAxisValueTop:function(a){a=this.chart.convertToPixel({yAxisIndex:0},a);return parseFloat(a,10)},_showSpecialLabel:function(a,b,c){var f=((b.max||100)-(b.min||0))/1E3;c.sort(function(a,b){return a-b});var g=
function(a){var b;c.forEach(function(d){"undefined"===typeof b&&d>=a&&d<a+f&&(b=d)});return b};"curved"===b.shape?a.series[0].axisLabel.formatter=g:"horizontal"===b.shape?a.xAxis.axisLabel.formatter=g:"vertical"===b.shape&&(a.yAxis.axisLabel.formatter=g);return a},_settingGaugeLabel:function(a,b){var c=b.min||0,f=b.max||100,h=[];b.gaugeOption&&b.gaugeOption.showTargetValueLabel&&("curved"===b.shape&&(a.series[0].splitNumber=1E3,a.series[0].axisTick.splitNumber=1,a.series[0].axisTick.show=!1),b.gaugeOption.targetValue&&
b.gaugeOption.targetValue.forEach(function(a){h.push(a)}));this.criticalValues=k.clone(h);b.gaugeOption&&b.gaugeOption.showDataRangeLabel&&(0>h.indexOf(c)&&(h.push(c),this.criticalValues.push({type:"min",value:c})),0>h.indexOf(f)&&(h.push(f),this.criticalValues.push({type:"max",value:f})));return"curved"===b.shape?this._showSpecialLabel(a,b,h):a}})})},"jimu/dijit/_ChartOptionFactory":function(){define(["dojo/_base/declare","dojo/_base/lang","./_chartUtils"],function(m,k,h){return m([],{constructor:function(c){this.chart=
c.chart;this.gauge=c.gauge},produceOption:function(c){this.chart._theme||(this.chart._theme={});c=k.clone(c);c=this._mockChartDataWhenNoData(c);var a={},a=this._settingDefaultGrid(a,c),a=this._settingRenderOption(a,c),a=this._settingBackgroundColor(a,c),a=this._settingColor(a,c),a=this._settingToolTip(a,c),a=this._settingAxisChartAxis(a,c),a=this._settingRadar(a,c),a=this._settingSeries(a,c),a=this._settingStack(a,c),a=this._settingArea(a,c),a=this._settingAxisDisplay(a,c),a=this._settingLegend(a,
c),a=this._settingScale(a,c),a=this._handleChartRtl(a,c),a=this._pieChartAvoidLegendLabelOverLap(a,c),a=this.settingDataZoom(a,c),a=this._settingGrid(a,c),a=this._settingAdvanceOption(a,c);return a=this._avoidAdjoiningColorSameForPie(a,c)},_mockChartDataWhenNoData:function(c){c&&Array.isArray(c.labels)&&0===c.labels.length&&c.labels.push(0);c&&Array.isArray(c.series)&&0<c.series.length&&c.series.forEach(function(a){a&&Array.isArray(a.data)&&0===a.data.length&&a.data.push(0)});return c},_settingAdvanceOption:function(c,
a){a.advanceOption&&("object"===typeof a.advanceOption?k.mixin(c,a.advanceOption):"function"===typeof a.advanceOption&&a.advanceOption(c));return c},_avoidAdjoiningColorSameForPie:function(c,a){if("pie"!==a.type||!c.color||2>=c.color.length)return c;c.series&&c.series[0]&&c.series.forEach(k.hitch(this,function(a){var b=a.data.length;0===(b-1)%c.color.length&&(a=a.data[b-1],a.itemStyle||(a.itemStyle={}),a.itemStyle.normal||(a.itemStyle.normal={}),a.itemStyle.normal.color||(a.itemStyle.normal.color=
c.color[1]))}));return c},_settingDefaultGrid:function(c,a){h.isAxisChart(a)&&(c.grid={top:20,bottom:10,left:10,right:10,containLabel:!0});return c},_settingRenderOption:function(c,a){if("curved"===a.shape)return c.animationThreshold=99999999,c.hoverLayerThreshold=99999,c.progressiveThreshold=99999,c;c.hoverLayerThreshold=500;c.progressiveThreshold=500;c.progressive=100;c.animationThreshold=500;return c},_settingBackgroundColor:function(c,a){a.backgroundColor&&(c.backgroundColor=a.backgroundColor);
return c},_settingColor:function(c,a){a.color&&a.color[0]&&(this.chart._theme||(this.chart._theme={}),this.chart._theme.color=a.color,c.color=a.color);return c},_settingToolTip:function(c,a){c.tooltip={};a.confine&&(c.tooltip.confine=!0);if("radar"===a.type)return c.tooltip.trigger="item",c;if(a.axisPointer){if(c.tooltip.trigger="axis","column"===a.type||"bar"===a.type)c.tooltip.axisPointer={type:"shadow"}}else c.tooltip.axisPointer={type:""};this.chart._theme.tooltip||(this.chart._theme.tooltip=
{});var b=!1;"percent"===a.stack&&(b=!0);this.chart._theme.tooltip.formatter=function(a){return h.handleToolTip(a,null,!1,b)}.bind(this);return c},_settingAxisChartAxis:function(c,a){if(!h.isAxisChart(a))return c;c.xAxis={};c.yAxis={};"column"===a.type||"line"===a.type&&a.labels?(c.xAxis.data=a.labels,c.xAxis.type="category",c.yAxis.type="value"):"bar"===a.type&&a.labels&&(c.yAxis.data=a.labels,c.yAxis.type="category",c.xAxis.type="value");return c},_settingSeries:function(c,a){if("gauge"===a.type)return this.gauge._settingGaugeSeries(c,
a);var b=null,g=a.series;g.forEach(function(b){b.type||(b.type=a.type);b.type="column"===a.type?"bar":a.type});g.keek?b=g:(b=[],b=g.map(k.hitch(this,function(b){b.data=b.data.map(k.hitch(this,function(b,c){var d=null;if("funnel"===a.type||"gauge"===a.type||"pie"===a.type)d={},b||"number"===typeof b?(d.value="undefined"!==typeof b.value?b.value:b,b.itemStyle&&(d.itemStyle||(d.itemStyle={}),d.itemStyle=k.mixin(d.itemStyle,b.itemStyle))):d.value=b,d.name=a.labels[c]||"";else if("column"===a.type||"bar"===
a.type||"line"===a.type){if(!b)return b;d=b}this._showBarBorderColor=d&&d.itemStyle&&d.itemStyle.normal&&"undefined"!==typeof d.itemStyle.normal.color&&"line"!==a.type?a.stack?"stack":"single":!1;return d}));b=this._settingPieSerie(b,a);b=this._settingFunnelSerie(b,a);return b=this._settingRaderSerie(b,a)})));c.series=b;return c=this._handleChartBorderWidthColor(c,a)},_settingRaderSerie:function(c,a){if("radar"!==c.type)return c;var b=a.indicator.map(function(a){return a.name});c.tooltip={};c.tooltip.formatter=
function(a){return h.handleToolTip(a,null,!1,!1,b)};return c},_settingFunnelSerie:function(c,a){if("funnel"!==c.type)return c;c.minSize="0%";c.maxSize="100%";c.sort="descending";c.min=a.min||0;c.max=a.max||100;c.max=a.funnelSort||"descending";return c},_settingPieSerie:function(c,a){if("pie"!==c.type)return c;c.selectedMode="single";c.selectedOffset=10;c.hoverOffset=5;c.radius=[0,"70%"];c.labelLine={normal:{show:!0,length:5,length2:5}};c.labelLine.normal.show="undefined"===typeof a.labelLine?!0:a.labelLine;
"number"===typeof a.innerRadius&&(0>a.innerRadius&&(a.innerRadius=0),60<a.innerRadius&&(a.innerRadius=60),c.radius[0]=a.innerRadius+"%");"rose"===a.pieMode&&(c.roseType=a.roseType||"radius");return c=this._absoluteValueForPieChart(c)},_absoluteValueForPieChart:function(c){if(!c||!c.data||!c.data[0])return c;c.data=c.data.map(function(a){"number"===typeof a?a=Math.abs(a):"object"===typeof a&&"number"===typeof a.value&&(a.value=Math.abs(a.value));return a});return c},_settingRadar:function(c,a){if("radar"!==
a.type)return c;c.radar={nameGap:6,radius:"70%"};c.radar.axisLabel={show:!0,formatter:function(){}};a.radarShape&&(c.radar.shape=a.radarShape);a.indicator?(this._handleRadarIndicator(a),c.radar.indicator=a.indicator):console.error("No radar indicator");return c},_handleRadarIndicator:function(c){var a=c.series[0].data,b=[];c.indicator.forEach(function(c,f){if("undefined"!==typeof c.max)return c;b=a.map(function(a){b.push(a.value[f])});var g=Math.max.apply(Math,b);c.max=g})},_settingStack:function(c,
a){if(!h.isAxisChart(a))return c;a=this._stackForPercent(a);if("percent"===a.stack){var b=a.series.some(function(a){return a.data.some(function(a){a=a&&a.value?a.value:a;return"number"===typeof a&&0>a})}),g=a.series.every(function(a){return a.data.every(function(a){a=a&&a.value?a.value:a;return"number"===typeof a&&0>a})}),f=0,k=1;b&&(f=-1,g&&(k=0),"bar"===a.type?(c.xAxis.max=k,c.xAxis.min=f):(c.yAxis.max=k,c.yAxis.min=f))}a.stack&&(c.series=c.series.map(function(a){a.stack="stack";return a}));return c},
_settingArea:function(c,a){if("line"!==a.type||!a.area)return c;c.series=c.series.map(function(a){a.areaStyle||(a.areaStyle={});"undefined"===typeof a.areaStyle.opacity&&(a.areaStyle.opacity=.4);a.sthisoth=!0;a.smoothMonotone="x";return a});return c},_stackForPercent:function(c){if("percent"!==c.stack)return c;var a=[];c.series.forEach(function(b){k.clone(b.data).forEach(function(b,c){a[c]||(a[c]=[]);(b=b&&"undefined"!==typeof b.value?b.value:b)||(b=0);a[c].push(b)})});var b=[];a.forEach(function(a,
c){b[c]||(b[c]=0);a.forEach(function(a){b[c]+=Math.abs(a)})});var g=a.map(function(a,c){return a.map(function(a){return 0===b[c]?null:0<=a?Math.abs(a)/b[c]:-Math.abs(a)/b[c]})});c.series=c.series.map(function(a,b){var c=k.clone(a.data),c=c.map(function(a,c){if(!a)return a;"undefined"!==typeof a.value?a.value=g[c][b]:a=g[c][b];return a});a.data=c;return a});return c},_settingAxisDisplay:function(c,a){if(!h.isAxisChart(a))return c;c.xAxis.show=!a.hidexAxis;c.yAxis.show=!a.hideyAxis;c.grid.containLabel=
!a.hideyAxis;return c},_settingLegend:function(c,a){if(!a.legend)return c.legend={show:!1},c;c.legend={show:!0,type:"scroll",orient:"horizontal",x:"left",pageButtonPosition:"end",pageTextStyle:{color:"#939393"},bottom:20,y:"bottom",data:[]};h.isAxisChart(a)||"gauge"===a.type?c.series.forEach(function(a){c.legend.data.push(a.name)}):"pie"!==a.type&&"funnel"!==a.type&&"radar"!==a.type||c.series[0].data.forEach(function(a){c.legend.data.push(a.name)});return c=this._handleLegendRTL(c,a)},_handleLegendRTL:function(c,
a){if(!a.legend)return c;a={};window.isRTL?(a.x="right",a.pageButtonPosition="start"):(a.x="left",a.pageButtonPosition="end");c.legend=k.mixin(c.legend,a);return c},_settingScale:function(c,a){if(!a.scale)return c;"bar"===a.type?c.xAxis.scale=!0:"line"===a.type||"column"===a.type?c.yAxis.scale=!0:"radar"===a.type&&(c.radar.scale=!0);return c},_handleChartRtl:function(c,a){if(!window.isRTL)return c;if(h.isAxisChart(a)||"vertical"===a.shape||"horizontal"===a.shape)c.xAxis.inverse=!0,c.yAxis.position=
"right";return c},_pieChartAvoidLegendLabelOverLap:function(c,a){if("pie"!==a.type)return c;var b=a.labelLine?.75:.85;a.legend&&(b-=.12);c.series[0].radius[1]=100*b+"%";return c},settingDataZoom:function(c,a){if(!h.isAxisChart(a)||!a.series||0===a.series.length)return c;if(a.dataZoom&&0<a.dataZoom.length){var b=this.chart.getWidth(),g=10,f=a.series[0].data.length,n=a.series.length,q=f*n;a.stack&&(q=f);5<=n&&(g=17);f=h.getAxisZeroPosition.call(this,a);b="bar"!==a.type?window.isRTL?f.left:b-f.left-
c.grid.right:f.top;this.showDataZoom=b/q<g;var d=b/(q*g),d=parseFloat(100*d,10).toFixed(3),d=100<d?100:d,d=0===d?.01:d,b=[],e="bar"===a.type?"xAxis":"yAxis",l="bar"===a.type?"yAxisIndex":"xAxisIndex",p="bar"===a.type?"width":"height";c=this._initAxisOfDataZoom(c,e);b=a.dataZoom.map(k.hitch(this,function(b){b={type:b,start:0,show:this.showDataZoom};b[l]=[0];b[p]=15;b.end=d;"xAxis"===e&&window.isRTL&&(b.left="10");return b=this._handleDataZoomPosition(a,b)}));c.dataZoom=b}else this.showDataZoom=!1,
c.dataZoom=[];return c},_initAxisOfDataZoom:function(c,a){c[a].type="value";c.xAxis.splitLine={show:!0,lineStyle:{type:"dashed"}};c.yAxis.splitLine={show:!0,lineStyle:{type:"dashed"}};return c},_handleDataZoomPosition:function(c,a){a.showDataShadow=!1;a.realtime=!1;a.bottom=c.legend?30:20;"bar"===c.type&&c.legend&&(a.bottom=50);return a},_settingGrid:function(c,a){if(!h.isAxisChart(a))return c;c.grid&&(c.grid.top=10);var b=10,g=43;a.hideyAxis&&(b=20,g=63);var f=0,k=10;a.legend&&(f=this.showDataZoom?
10:20,k+=20);"line"===a.type&&a.legend&&!this.showDataZoom&&(b+=7);"bar"===a.type?(window.isRTL?c.grid.left=this.showDataZoom?30:10:c.grid.right=this.showDataZoom?30:10,a.hideyAxis&&a.legend&&(k+=20),c.grid.bottom=k):c.grid.bottom=this.showDataZoom?g+f:b+f;return c},_handleChartBorderWidthColor:function(c,a){var b=0;"single"===this._showBarBorderColor?b=.1:"stack"===this._showBarBorderColor&&(b=1);var g="";"stack"===this._showBarBorderColor&&(g="#fff",a.backgroundColor&&"transparent"!==a.backgroundColor&&
(g=a.backgroundColor));c.series=c.series.map(function(a){if("bar"===a.type||"pie"===a.type)a.itemStyle||(a.itemStyle={}),a.itemStyle.normal||(a.itemStyle.normal={}),a.itemStyle.emphasis||(a.itemStyle.emphasis={}),a.itemStyle.normal.borderWidth=b,a.itemStyle.emphasis.borderWidth=b,g?(a.itemStyle.normal.borderColor=g,a.itemStyle.emphasis.borderColor=g):(a.itemStyle.normal.borderColor="transparent",a.itemStyle.emphasis.borderColor="transparent");return a});return c}})})},"libs/echarts/light":function(){(function(m,
k){"function"===typeof define&&define.amd?define(["exports","./echarts"],k):"object"===typeof exports&&"string"!==typeof exports.nodeName?k(exports,require("./echarts")):k({},m.echarts)})(this,function(m,k){k?k.registerTheme("light",{color:"#2ec7c9 #b6a2de #5ab1ef #ffb980 #d87a80 #8d98b3 #e5cf0d #97b552 #95706d #dc69aa #07a2a4 #9a7fd1 #588dd5 #f5994e #c05050 #59678c #c9ab00 #7eb00a #6f5553 #c14089".split(" "),textStyle:{},title:{textStyle:{color:"#008acd"},subtextStyle:{color:"#aaaaaa"}},line:{itemStyle:{normal:{}},
lineStyle:{normal:{width:"1"}},symbolSize:"5",symbol:"circle",smooth:!1},radar:{itemStyle:{normal:{}},lineStyle:{normal:{width:"1"}},symbolSize:"6",symbol:"circle",smooth:!1},gauge:{axisLine:{lineStyle:{color:[[.31,"#58f7f3"],[1,"#E5E5E5"]]}},itemStyle:{normal:{color:"#686868"},emphasis:{color:"#686868"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#008acd"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#333"}},splitLine:{show:!0,lineStyle:{type:"dashed",
color:["rgba(0,0,0,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#008acd"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#333"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(0,0,0,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{normal:{borderColor:"#2ec7c9"},emphasis:{borderColor:"#18a4a6"}}},
legend:{textStyle:{color:"#333333"}},tooltip:{axisPointer:{lineStyle:{color:"#008acd",width:"1"},crossStyle:{color:"#008acd",width:"1"}}},dataZoom:{backgroundColor:"#F4F4F4",dataBackgroundColor:"rgba(47,69,84,0.3)",fillerColor:"#E0E0E0",handleColor:"#777777",handleSize:"100%",borderColor:"#F4F4F4",textStyle:{color:"#939393"}}}):"undefined"!==typeof console&&console&&console.error&&console.error("ECharts is not Loaded")})},"libs/echarts/dark":function(){(function(m,k){"function"===typeof define&&define.amd?
define(["exports","./echarts"],k):"object"===typeof exports&&"string"!==typeof exports.nodeName?k(exports,require("./echarts")):k({},m.echarts)})(this,function(m,k){k?k.registerTheme("dark",{color:"#fc97af #87f7cf #f7f494 #72ccff #f7c5a0 #d4a4eb #d2f5a6 #76f2f2".split(" "),textStyle:{},title:{textStyle:{color:"#ffffff"},subtextStyle:{color:"#dddddd"}},line:{itemStyle:{normal:{}},lineStyle:{normal:{width:"1"}},symbolSize:"5",symbol:"circle",smooth:!1},radar:{itemStyle:{normal:{}},lineStyle:{normal:{width:"1"}},
symbolSize:"5",symbol:"circle",smooth:!1},gauge:{axisLine:{lineStyle:{color:[[.31,"#58f7f3"],[1,"#1E5F6F"]]}},itemStyle:{normal:{color:"#D9D9D9"},emphasis:{color:"#D9D9D9"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#939393"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(255,255,255,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},valueAxis:{axisLine:{show:!0,
lineStyle:{color:"#333"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#939393"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(255,255,255,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{normal:{borderColor:"#999999"},emphasis:{borderColor:"#666666"}}},legend:{textStyle:{color:"#999999"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},
dataZoom:{backgroundColor:"#525252",dataBackgroundColor:"rgba(47,69,84,0.3)",fillerColor:"#737373",handleColor:"#BDBDBD",handleSize:"100%",borderColor:"#525252",textStyle:{color:"#939393"}}}):"undefined"!==typeof console&&console&&console.error&&console.error("ECharts is not Loaded")})},"widgets/Infographic/dijits/GaugeDijit":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html ./BaseDijit jimu/utils jimu/dijit/Chart ./utils".split(" "),function(m,k,h,c,a,b,g){return m([c],{templateString:'\x3cdiv style\x3d"height:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"gauge"\x3e\x3c/div\x3e\x3c/div\x3e',
type:"gauge",config:null,postCreate:function(){this.inherited(arguments);this.features=[];this.DEFAULT_GAUGE_CONFIG={type:"gauge",confine:!0,shape:"curved",min:0,max:100,series:[{data:[0]}]};this.config&&(this.DEFAULT_GAUGE_CONFIG.shape=this.config.shape);this.isDarkTheme()?this.DEFAULT_GAUGE_CONFIG.theme="dark":this.DEFAULT_GAUGE_CONFIG.theme="light";this._initChart();this.setConfig(this.config)},onDataSourceDataUpdate:function(a){this.inSettingPage?a&&"undefined"!==typeof a.features&&(this.features=
a.features,this._updateStatisticsValue()):"number"===typeof a&&(this.value=a,this._setValue(this.config))},resize:function(a,b){this.chart&&(a&&b?this.chart.resize(a,b):this.chart.resize())},_updateStatisticsValue:function(){if(this.config.statistic&&this.dataSource){var a=g.getSingleValueFromFeatures(this.config.statistic,this.dataSource,this.features),a=this._getVaildValue(a);"number"===typeof a&&(this.value=a,this._setValue(this.config))}},setConfig:function(a){a&&(this.config=a,this.config.display&&
this.config.display.backgroundColor&&h.setStyle(this.domNode,"backgroundColor",this.config.display.backgroundColor),this._updateStatisticsValue())},_setValue:function(b){var c={};c.series=[{data:[this.value]}];var g=!1;"undefined"!==typeof b.max&&"undefined"!==typeof b.min&&(c.max=b.max,c.min=b.min);var d={},e=this._getIndicatorInfo(b);if(a.isNotEmptyObject(b.display)){var f=b.display;f.backgroundColor&&h.setStyle(this.domNode,"backgroundColor",f.backgroundColor);f.gaugeColor&&(d.columnColor=f.gaugeColor);
f.bgColor&&(d.bgColor=f.bgColor);if(a.isNotEmptyObject(f.dataLabels)&&f.dataLabels.state){var p=f.dataLabels;d.showDataRangeLabel=!!p.dataRange;d.showTargetValueLabel=!!p.targetValue;g=d.showTargetValueLabel;d.labelColor=p.textColor||""}p={state:!0,isRatio:!1,font:{font:{fontFamily:"Arial",bold:!1,italic:!1,underline:!1},textColor:"#59bad8"},dataFormat:{unit:"none",decimalPlaces:"",prefix:"",suffix:""}};p=f.currentValue.state?f.currentValue:p;if(a.isNotEmptyObject(p)){var f={},m=p.dataFormat;m&&""!==
m.decimalPlaces&&"undefined"!==typeof m.decimalPlaces&&(f.decimalPlaces=Number(m.decimalPlaces));m=k.hitch(this,function(a,c){var d,e="";a.isRatio&&(c/=b.max,c*=100,e="%");if(a.dataFormat){var f=a.dataFormat;a.isRatio||("percentage"===f.unit?(c*=100,e="%"):"thousand"===f.unit?(e=this.nls.thousandAbbreviation,c/=1E3):"million"===f.unit?(e=this.nls.millionAbbreviation,c/=1E6):"billion"===f.unit&&(e=this.nls.billionAbbreviation,c/=1E9));""!==f.decimalPlaces&&"undefined"!==typeof f.decimalPlaces&&(c=
c.toFixed(Number(f.decimalPlaces)));d=c+e;f.prefix&&(d=f.prefix+" "+d);f.suffix&&(d+=" "+f.suffix)}return d},p,this.value);f.formatter=m;p.font&&(m={},"undefined"!==typeof p.font.fontSize&&(m.fontSize=Number(p.font.fontSize)),p.font.textColor&&(m.color=p.font.textColor),e.valueColor&&(m.color=e.valueColor),p.font&&p.font.font&&(p=p.font.font,m.fontWeight=p.bold?"bold":"normal",p.fontFamily&&(m.fontFamily=p.fontFamily),m.fontStyle=p.italic?"italic":"normal"),f.textStyle=m);d.valueStyle=f}}e.targetValue&&
(d.targetValue=g?e.targetValue:[]);e.columnColor&&(d.columnColor=e.columnColor);c.gaugeOption=d;this.chart.updateConfig(c)},_getIndicatorInfo:function(b){var c=!1,f=!1,d=!1,e=this._getIndicatorValues(b);a.isNotEmptyObject(e,!0)&&(c=e);if(e=b.indicators)(b=g.getVaildIndicator(this.value,e,b.max))&&b.gaugeColor&&(f=b.gaugeColor),b&&b.valueColor&&(d=b.valueColor);return{targetValue:c,columnColor:f,valueColor:d}},_initChart:function(){this.chart=new b({chartDom:this.domNode,config:this.DEFAULT_GAUGE_CONFIG});
this.chart.placeAt(this.domNode);setTimeout(k.hitch(this,function(){this.chart.resize()}),300)},_getVaildValue:function(a){if("undefined"!==typeof a)return Number(a)},_getIndicatorValues:function(b){var c=[];b.indicators&&(b.indicators.forEach(function(a){a.value&&a.value.forEach(k.hitch(this,function(d){c.push(a.isRatio?d/100*b.max:d)}))}),c.sort(function(a,b){return a-b}),c=a.uniqueArray(c));return c}})})},"widgets/Infographic/dijits/utils":function(){define("dojo/on dojo/_base/lang dojo/_base/array jimu/utils jimu/DataSourceManager jimu/statisticsUtils".split(" "),
function(m,k,h,c,a,b){return{getClientFeaturesFromMap:function(a,b,h,k){return c.getClientFeaturesFromMap(a,b,h,k)},listenClientFeaturesFromMap:function(a,b,c,q,d){var e=[];c&&(e.push(m(b,"selection-complete",k.hitch(this,function(){d(this.getClientFeaturesFromMap(a,b,c,q))}))),e.push(m(b,"selection-clear",k.hitch(this,function(){d(this.getClientFeaturesFromMap(a,b,c,q))}))));q&&e.push(m(a,"extent-change",k.hitch(this,function(){0<b.graphics.length&&d(this.getClientFeaturesFromMap(a,b,c,q))})));e.push(m(b,
"update-end",k.hitch(this,function(){d(this.getClientFeaturesFromMap(a,b,c,q))})));d(this.getClientFeaturesFromMap(a,b,c,q));return{remove:function(){e&&h.forEach(e,k.hitch(this,function(a){a.remove()}));e=null}}},getVaildIndicator:function(a,b,c){var f=[];b.map(k.hitch(this,function(b){(b=this._handleOperator(b,a,c))&&f.push(b)}));if(0<f.length)return f[f.length-1]},getSingleValueFromFeatures:function(b,f,k){var g=a.getInstance(),d=0;if("Features"===b.type){if("DATA_SOURCE_FEATURE_LAYER_FROM_MAP"===
f.dataSourceType||"Features"===g.getDataSourceConfig(f.frameWorkDsId).type)return k.length;d=0;h.forEach(k,function(a){var b=a.attributes.STAT_COUNT;"undefined"===typeof b&&(b=a.attributes.stat_count);d+=b});return d}if("DATA_SOURCE_FEATURE_LAYER_FROM_MAP"===f.dataSourceType||"Features"===g.getDataSourceConfig(f.frameWorkDsId).type)return this._getStatsFromFeatures(k,b.fieldName,b.statisticsType);var e=0,l=0,d=0,m=c.upperCaseString(b.fieldName+"_"+b.statisticsType);h.forEach(k,function(a){var f=a.attributes[m];
"undefined"===typeof f&&(m=c.lowerCaseString(b.fieldName+"_"+b.statisticsType),f=a.attributes[m]);switch(b.statisticsType){case "sum":e+=f;break;case "min":e=Math.min(e,f);break;case "max":e=Math.max(e,f);break;case "avg":a=this._getSumCountValue(b.fieldName,a.attributes),l+=a.sum,d+=a.count}}.bind(this));"avg"===b.statisticsType&&(e=0===d?0:l/d);return e},_getSumCountValue:function(a,b){var f;f=c.upperCaseString(a+"_SUM");f=b[f];"undefined"===typeof f&&(f=c.lowerCaseString(a+"_SUM"),f=b[f]);a=b.STAT_COUNT;
"undefined"===typeof a&&(a=c.lowerCaseString("STAT_COUNT"),a=b[a]);return{sum:f||0,count:a||0}},filterFeaturesByDataSourceSetting:function(a,b,k){if(0===a.length)return[];if(b.useSelection){var f=a[0].getLayer();if(f){var d=f.getSelectedFeatures();0<d.length&&(a=h.filter(a,function(a){return-1<d.indexOf(a)}))}}b.filterByExtent&&(a=c.filterFeaturesByExtent(k.extent,a));return a},_getStatsFromFeatures:function(a,c,h){return b.getStatisticsResultFromClientSync({featureSet:{features:a},fieldName:c,statisticTypes:[h]})[h+
"Field"]},_handleOperator:function(a,b,c){function f(a){d={};a.valueColor&&(d.valueColor=a.valueColor);a.gaugeColor&&(d.gaugeColor=a.gaugeColor);a.iconInfo&&(d.iconInfo=a.iconInfo)}var d,e=a.value.map(k.hitch(this,function(b){return a.isRatio?b/100*c:b}));"greater"===a.operator&&b>e[0]?f(a):"smaller"===a.operator&&b<e[0]?f(a):"between"===a.operator&&b>e[0]&&b<e[1]?f(a):"equal"===a.operator&&b===e[0]?f(a):"notEqual"===a.operator&&b!==e[0]&&f(a);return d},isInteger:function(a){return"number"===typeof a&&
0===a%1}}})},"widgets/Infographic/dijits/NumberDijit":function(){define("dojo/_base/declare dojo/_base/lang esri/lang ./BaseDijit dojo/dom-style dojo/_base/html jimu/utils ./utils ./styleUtils jimu/LayerInfos/LayerInfos jimu/DataSourceManager".split(" "),function(m,k,h,c,a,b,g,f,n,q,d){return m([c],{templateString:'\x3cdiv style\x3d"height:100%;width:100%;"\x3e\x3ca data-dojo-attach-point\x3d"numberContent" class\x3d"number-content no-trim" target\x3d"_blank"\x3e\x3cdiv data-dojo-attach-point\x3d"leftIcon" class\x3d"icon"\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"number" class\x3d"number"\x3e\x3cdiv data-dojo-attach-point\x3d"prefix" class\x3d"prefix"\x3e\x3c/div\x3e\x3cdiv class\x3d"value-content" data-dojo-attach-point\x3d"valueContent"\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"suffix" class\x3d"suffix"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"rightIcon" class\x3d"icon"\x3e\x3c/div\x3e\x3c/a\x3e\x3c/div\x3e',
baseClass:"infographic-number-dijit",type:"number",config:null,postCreate:function(){this.inherited(arguments);this.value=this.features=null;this.setConfig(this.config)},onDataSourceDataUpdate:function(a){this.inSettingPage?a&&"undefined"!==typeof a.features&&(this.features=a.features,this._updateStatisticsValue()):"number"===typeof a&&(this.value=a,this._updateUI(this.config,this.value))},setDataSource:function(a){this.dataSource=a;if(this.inSettingPage)if(a.layerId){var b=q.getInstanceSync().getLayerInfoById(a.layerId);
b&&b.getLayerObject().then(k.hitch(this,function(b){this.features=f.getClientFeaturesFromMap(this.map,b,a.useSelection,a.filterByExtent);this._updateStatisticsValue()}))}else a.frameWorkDsId&&(b=d.getInstance().getData(a.frameWorkDsId))&&(this.features=b.features,this._updateStatisticsValue())},_updateStatisticsValue:function(){this.value=this.features&&this.config.statistic&&this.dataSource?f.getSingleValueFromFeatures(this.config.statistic,this.dataSource,this.features):null;this._updateUI(this.config,
this.value)},setConfig:function(a){a&&a.background&&a.background.backgroundColor?b.setStyle(this.domNode,"backgroundColor",a.background.backgroundColor):b.setStyle(this.domNode,"backgroundColor","#FFFFFF");this.config=a;this._updateStatisticsValue()},_updateUI:function(a,b){this._cleanUI();this.config=a;this.valueContent.innerHTML=null===b?this.nls.noData:this._tryLocaleNumber(b);g.isNotEmptyObject(this.config)&&this._setValueDisplay(this.config)},_setValueDisplay:function(a){a&&(this._setBackground(a),
this._setFont(a),"undefined"!==typeof this.value&&(this._setDataFormat(a),a=this._getIndicatorColor(),a.color&&this._setValueColor(a.color),a.icon&&this._setIndicatorIcon(a.icon)))},_setIndicatorIcon:function(a){a&&("left"===a.placement||"right"===a.placement?this._setLeftRightIcon(a):"replace"===a.placement&&this._setReplaceIcon(a))},_setReplaceIcon:function(c){var d=b.create("div",{"class":"indicator-icon "+c.icon});b.empty(this.valueContent);b.place(d,this.valueContent);a.set(d,"color",c.color);
a.set(d,"display","inline-flex")},_setLeftRightIcon:function(c){var d;"left"===c.placement?d=this.leftIcon:"right"===c.placement&&(d=this.rightIcon);b.addClass(d,"indicator-icon "+c.icon);a.set(d,"color",c.color)},_getIndicatorColor:function(){var a=!1,b=!1,c=this.config.indicators;c&&((c=f.getVaildIndicator(this.value,c))&&c.valueColor&&(a=c.valueColor),c&&g.isNotEmptyObject(c.iconInfo)&&(b=c.iconInfo));return{color:a,icon:b}},_setFont:function(a){if(a&&a.font){var c={};n.font.setStyle(a.font,c);
b.setStyle(this.number,c)}},_setDataFormat:function(a){if(this.value&&a&&a.dataFormat){var b=this.value,c="";a=a.dataFormat;"percentage"===a.unit?(b*=100,c="%"):"thousand"===a.unit?(c=this.nls.thousandAbbreviation,b/=1E3):"million"===a.unit?(c=this.nls.millionAbbreviation,b/=1E6):"billion"===a.unit&&(c=this.nls.billionAbbreviation,b/=1E9);""!==a.decimalPlaces&&"undefined"!==typeof a.decimalPlaces&&(b=b.toFixed(Number(a.decimalPlaces)));b=this._tryLocaleNumber(b)+c;this.valueContent.innerHTML=b;a.prefix&&
(this.prefix.innerHTML=a.prefix);a.suffix&&(this.suffix.innerHTML=a.suffix)}},_cleanUI:function(){b.removeClass(this.leftIcon);b.addClass(this.leftIcon,["icon"]);b.removeClass(this.rightIcon);b.addClass(this.rightIcon,["icon"]);this.replaceIcon&&(b.destroy(this.replaceIcon),this.replaceIcon=null);b.empty(this.valueContent);b.empty(this.prefix);b.empty(this.suffix);this._setValueColor("")},_getVaildValue:function(a){if("undefined"!==typeof a)return Number(a)},_setBackground:function(a){if(a&&a.background){a=
a.background;a.backgroundColor&&b.setStyle(this.domNode,"backgroundColor",a.backgroundColor);if(a.alignment){var c=a.alignment;b.removeClass(this.domNode);b.addClass(this.domNode,"infographic-number-dijit");c.horizontal&&b.addClass(this.domNode,"horizontal-"+c.horizontal);c.vertical&&b.addClass(this.domNode,"vertical-"+c.vertical)}a.link?b.setAttr(this.numberContent,"href",a.link):b.removeAttr(this.numberContent,"href")}},_setValueColor:function(b){a.set(this.number,"color",b)},_tryLocaleNumber:function(a){var b=
a;if(h.isDefined(a)&&isFinite(a))try{var c=g.localizeNumber(a);"string"===typeof c&&(b=c)}catch(t){console.error(t)}return b+""}})})},"widgets/Infographic/dijits/SourceLauncher":function(){define("dojo/_base/declare dojo/_base/lang dojo/Evented dojo/on dojo/Deferred dijit/_WidgetBase ./utils jimu/utils jimu/LayerInfos/LayerInfos jimu/DataSourceManager esri/geometry/geometryEngine esri/tasks/query esri/tasks/QueryTask esri/tasks/StatisticDefinition esri/layers/FeatureLayer".split(" "),function(m,k,
h,c,a,b,g,f,n,q,d,e,l,p,t){return m([b,h],{oidFieldType:"esriFieldTypeOID",constructor:function(a){this.map=a.map;this.appConfig=a.appConfig;this.useSelection=a.useSelection;this.filterByExtent=a.filterByExtent;this.dijit=a.dijit;this.dataSource=a.dataSource;this.layerInfosObj=n.getInstanceSync();this.dataSourceManager=q.getInstance();this._layerUrl=this.layerObject=null;this.dijit&&(this.config=this.dijit.config)&&(this.isDateType=!!this.config.dateConfig);"DATA_SOURCE_FROM_FRAMEWORK"===this.dataSource.dataSourceType&&
(this.frameWorkDsId=this.dataSource.frameWorkDsId);this.exdsBeginUpdateHandle=this.timeIntervalHandle=this.filterChangedHandle=this.updateEndHandle=this.refreshIntervalHandle=this.selectionHandle=this.exchetChangeHandle=this._oldQueryParameter=this._queryParameter=null},start:function(){this._tryGetLayerObject().then(function(){this._onFetchSuccess();this.awake();this._listenEventsContinuousAccessFeatures()}.bind(this),function(a){this._onFetchField(a)}.bind(this))},awake:function(){this.sleeping=
!1;this._getFeaturesForFirst()},sleep:function(){this.sleeping=!0},destroy:function(){this._removeHandles();this.inherited(arguments)},setAppConfigDSFeatures:function(a){this.sleeping||"DATA_SOURCE_FROM_FRAMEWORK"!==this.dataSource.dataSourceType||(this._onFetchSuccess(),this._onDataUpdate(a))},_getFeaturesForFirst:function(){if("DATA_SOURCE_FROM_FRAMEWORK"===this.dataSource.dataSourceType){var a=this.dataSourceManager.getData(this.dataSource.frameWorkDsId);a&&this._onDataUpdate(a.features)}else"DATA_SOURCE_FEATURE_LAYER_FROM_MAP"===
this.dataSource.dataSourceType&&this._trigerCallback()},_listenEventsContinuousAccessFeatures:function(){if("DATA_SOURCE_FROM_FRAMEWORK"===this.dataSource.dataSourceType)this._resetExdsBeginUpdateHandle(),this.exdsBeginUpdateHandle=c(this.dataSourceManager,"begin-update",k.hitch(this,function(a){a===this.frameWorkDsId&&this._onFetch()}));else if(this.layerObject&&this.layerInfo){var a=this._shouldAccessClientFeatures();this.useSelection&&(this._resetSelectionHandle(),this.selectionHandle=c(this.layerObject,
"selection-complete,selection-clear",k.hitch(this,function(){this._trigerCallback()})));a||(this._resetFilterChangedHandle(),this.filterChangedHandle=c(this.layerInfo,"filterChanged",k.hitch(this,function(){this._trigerCallback()})));a&&(this._resetUpdateEndHandle(),this.updateEndHandle=c(this.layerObject,"update-end",k.hitch(this,function(){this._trigerCallback()})));this.filterByExtent&&this.map&&(this._resetExtentChangeHandle(),this.exchetChangeHandle=c(this.map,"extent-change",k.hitch(this,function(){this._trigerCallback(!0)})));
a||(this._setTimeListener(),this._resetRefreshIntervalHandle(),this.refreshIntervalHandle=c(this.layerObject,"refresh-interval-change",k.hitch(this,this._setTimeListener)))}},_setTimeListener:function(){var a=this._getLayerRefreshInterval();a?(this._resetTimeIntervalHandle(),this.timeIntervalHandle=setInterval(k.hitch(this,function(){this._trigerCallback()}),6E4*a)):this._resetTimeIntervalHandle()},_trigerCallback:function(a){var b=this.computingTheWayToGetFeatures();if(!a||2!==b||!this._isLayerOnDemandMode())switch(b){case 1:this._getFeaturesFromSelection(this.map,
this.layerObject,this.filterByExtent,k.hitch(this,this._onDataUpdate));break;case 2:this._getClientFeaturesFromMap(this.map,this.layerObject,this.filterByExtent,k.hitch(this,this._onDataUpdate));break;case 3:this._getStatisticsFeaturesForServer(k.hitch(this,this._onDataUpdate))}},computingTheWayToGetFeatures:function(){var a=0;return this.sleeping||!this.layerObject?a:a=this._isMapLayer()?this._shouldAccessFeaturesBySelection()?1:this._shouldAccessClientFeatures()?2:3:0},_getClientFeaturesFromMap:function(a,
b,c,d){var e=b.graphics;c&&(e=this._filterFeaturesByExtent(a.extent,e));e=this._sortClientFeaturesByObjID(e,b);d(e)},_getFeaturesFromSelection:function(a,b,c,d){var e=[],f=!1,e=b.getSelectedFeatures(),f=!0;c&&(e=this._filterFeaturesByExtent(a.extent,e));e.isSelectedFeatures=f;e=this._sortClientFeaturesByObjID(e,b);d(e)},_getStatisticsFeaturesForServer:function(a){this._updateLayerInfoFilter();this._tryGenerateQueryParameter();this._shouldLaunchQuery()&&(this._onFetch(),this.queryDeferred=this._doQuery(),
this.queryDeferred.then(k.hitch(this,function(b){this.queryDeferred=null;this._onFetchSuccess();b=b.features||[];b=this._calculateAverageWithNullValueAsZero(b);a(b,!0)}),k.hitch(this,function(a){this.queryDeferred=null;this._onFetchField(a)})))},_updateLayerInfoFilter:function(){if(this.dataSource&&"undefined"!==typeof this.dataSource.layerId){var a=this.layerInfosObj.getLayerInfoById(this.dataSource.layerId);a&&(this._layerFilter=a.getFilter())}},_onFetch:function(){this.emit("fetching")},_onFetchSuccess:function(){this.emit("success")},
_onFetchField:function(a){this.emit("faild",a)},_onDataUpdate:function(a,b){var c=null;"number"===this.dijit.type||"gauge"===this.dijit.type?c=this._getValueForNumberOrGauge(a):"chart"===this.dijit.type&&(c={features:a,hasStatisticsed:!!b});this.emit("data-update",c)},_getValueForNumberOrGauge:function(a){if("number"!==this.dijit.type&&"gauge"!==this.dijit.type)return a;var b=a;if(this._isNeededCalculateForClient())b=g.getSingleValueFromFeatures(this.config.statistic,this.dataSource,a);else{if(a&&
a.length){if(a=a[0].attributes){var c=Object.keys(a)[0];c&&(b=a[c])}}else Array.isArray(a)&&(b=0);b=Number(b)}return b},_isMapLayer:function(){return"DATA_SOURCE_FEATURE_LAYER_FROM_MAP"===this.dataSource.dataSourceType},_isLayerOnDemandMode:function(){return this.layerObject&&this.layerObject.currentMode===t.MODE_ONDEMAND},_shouldAccessFeaturesBySelection:function(){return this.useSelection&&this.layerObject&&this.layerObject.getSelectedFeatures().length},_shouldAccessClientFeatures:function(){var a=
this.config&&"feature"===this.config.mode,b=this.isDateType,c=this._isSupportServerStatByExtent();return a||b||!c},_isSupportServerStatByExtent:function(){var a=this.layerObject&&this.layerObject.version&&10.11<=Number(this.layerObject.version),b=this._isLayerSupportStatistics();return a&&b},_isLayerSupportStatistics:function(){if(this.layerObject){var a=!1;return a=this.layerObject.advancedQueryCapabilities?!!this.layerObject.advancedQueryCapabilities.supportsStatistics:!!this.layerObject.supportsStatistics}},
_getLayerRefreshInterval:function(){if(this.layerObject&&this.layerObject.refreshInterval)return this.layerObject.refreshInterval},_sortClientFeaturesByObjID:function(a,b){if(0<a.length){var c=f.getObjectIdField(b);c&&(b=a[0])&&b.attributes&&b.attributes.hasOwnProperty(c)&&a.sort(function(a,b){a.attributes||(a.attributes={});b.attributes||(b.attributes={});a=a.attributes[c];b=b.attributes[c];return a<b?-1:a>b?1:0})}return a},_filterFeaturesByExtent:function(a,b){var c=a.normalize();return b=b.filter(k.hitch(this,
function(a){try{if(a.geometry){var b="point"===a.geometry.type||"multipoint"===a.geometry;return c.some(k.hitch(this,function(c){return b?c.contains(a.geometry):d.intersects(c,a.geometry)}))}}catch(w){console.error(w)}return!1}))},_calculateAverageWithNullValueAsZero:function(a){if(!this._shouldCalcAvgForNullValue()||!a||!a.length)return a;var b=this.config.valueFields;if(!b||!b.length)return a;var c=b.map(function(a){return a+"_sum"});a.forEach(function(a){var b=a.attributes;if(b){var d=b.STAT_COUNT;
"undefined"===typeof d?(d=b.stat_count,delete b.stat_count):delete b.STAT_COUNT;var e,g,h;c.forEach(function(a){h=a.replace(/_SUM$/gi,"");var c=f.upperCaseString(a);a=f.lowerCaseString(a);var k=f.upperCaseString(h+"_AVG");e=b[c];"undefined"===typeof e?(e=b[a],delete b[a]):delete b[c];!e&&"number"!==typeof e||!d?b[k]=null:(g=e/d,b[k]=g)})}});return a},_shouldCalcAvgForNullValue:function(){var a=this.config&&this.config.mode;return a&&("category"===a||"field"===a)&&this.config.nullValue&&"average"===
this.config.operation},_shouldLaunchQuery:function(){var a=!0,b=!(!this.queryDeferred||this.queryDeferred.isResolved()||this.queryDeferred.isRejected()),c=f.isEqual(this._queryParameter,this._oldQueryParameter);b&&c&&(a=!1);this._oldQueryParameter=k.clone(this._queryParameter);return a},_getOutStatistics:function(a,b,c){var d=c;"average"===d&&(d="avg");var e=this.config.nullValue;e&&"avg"===d&&(d="sum");var g=null;"category"===a||"field"===a?b&&b.length&&(g=b.map(function(a){var b=f.upperCaseString(a+
"_"+d),c=new p;c.statisticType=d;c.onStatisticField=a;c.outStatisticFieldName=b;return c}.bind(this)),a=null,e&&"average"===c&&(a=new p,a.statisticType="count",a.onStatisticField="*",a.outStatisticFieldName="STAT_COUNT",g.push(a))):"count"===a&&(c=new p,c.statisticType="count",c.onStatisticField=this._getCountTypeOnStatisticsField(),c.outStatisticFieldName="STAT_COUNT",g=[c]);return g},_tryGenerateQueryParameter:function(){this._queryParameter={};this._layerUrl&&(this._queryParameter.url=this._layerUrl);
this._layerFilter&&(this._queryParameter.where=this._layerFilter);if(this.dijit){var a;if("number"===this.dijit.type||"gauge"===this.dijit.type){if(this.config&&this.config.statistic){var b=this.config.statistic;a=b.statisticsType;var c=b.fieldName,d=f.upperCaseString(c+"_"+a);"Features"===b.type&&(c=this._getCountTypeOnStatisticsField(),a="count",d="STAT_COUNT");"average"===a&&(a="avg");b=new p;b.statisticType=a;b.onStatisticField=c;b.outStatisticFieldName=d;this._queryParameter.outStatistics=[b]}}else"chart"===
this.dijit.type&&this.config&&(this.statisticsByServer=!0,a=this.config.mode,this._queryParameter.outStatistics=this._getOutStatistics(a,this.config.valueFields,this.config.operation),c=this.config.categoryField,"category"===a||"count"===a)&&(this._queryParameter.groupByFieldsForStatistics=[c])}},_getCountTypeOnStatisticsField:function(){var a=null;this.layerObject&&(a=(a=(a=this.layerObject.fields)&&a.filter(function(a){return a.type===this.oidFieldType}.bind(this))[0])&&a.name);return a||"*"},_doQuery:function(){var b=
new a;if(!this._queryParameter)return b.reject("Empty query parameter."),b;if(!this._queryParameter.url)return b.reject("Empty layer url."),b;var c=new l(this._queryParameter.url),d=new e;d.where=this._queryParameter.where||"1\x3d1";d.returnGeometry=!1;this.dataSource.filterByExtent&&this.map&&(d.geometry=this.map.extent);this._queryParameter.groupByFieldsForStatistics&&(d.groupByFieldsForStatistics=this._queryParameter.groupByFieldsForStatistics);if(this._hasVaildOutStatistics(this._queryParameter.outStatistics))d.outStatistics=
this._queryParameter.outStatistics;else return b.reject("Invaild outStatistics of query params."),b;this._queryParameter.orderByFields&&(d.orderByFields=this._queryParameter.orderByFields);return c.execute(d)},_hasVaildOutStatistics:function(a){return a&&a.length?a.every(function(a){return this._isTrueOrZero(a.onStatisticField)&&this._isTrueOrZero(a.outStatisticFieldName)&&!!a.statisticType}.bind(this)):!1},_isTrueOrZero:function(a){return!!a||0===a},_tryGetLayerObject:function(){var b=new a;if("DATA_SOURCE_FEATURE_LAYER_FROM_MAP"!==
this.dataSource.dataSourceType)return b.resolve(),b;this._onFetch();var c=this.layerInfosObj.getLayerInfoById(this.dataSource.layerId);if(c)return this.layerInfo=c,c.getLayerObject().then(k.hitch(this,function(a){this.layerObject=a;this._layerUrl=this.layerObject.url}));b.reject("invaild data source");return b},_isNeededCalculateForClient:function(){var a=this.layerObject&&this.useSelection&&0<this.layerObject.getSelectedFeatures().length,b="DATA_SOURCE_FROM_FRAMEWORK"===this.dataSource.dataSourceType,
c=this._isSupportServerStatByExtent();return a||b||!c},_resetExtentChangeHandle:function(){this.exchetChangeHandle&&this.exchetChangeHandle.remove&&(this.exchetChangeHandle.remove(),this.exchetChangeHandle=null)},_resetUpdateEndHandle:function(){this.updateEndHandle&&this.updateEndHandle.remove&&(this.updateEndHandle.remove(),this.updateEndHandle=null)},_resetFilterChangedHandle:function(){this.filterChangedHandle&&this.filterChangedHandle.remove&&(this.filterChangedHandle.remove(),this.filterChangedHandle=
null)},_resetSelectionHandle:function(){this.selectionHandle&&this.selectionHandle.remove&&(this.selectionHandle.remove(),this.selectionHandle=null)},_resetRefreshIntervalHandle:function(){this.refreshIntervalHandle&&this.refreshIntervalHandle.remove&&(this.refreshIntervalHandle.remove(),this.refreshIntervalHandle=null)},_resetTimeIntervalHandle:function(){this.timeIntervalHandle&&(clearInterval(this.timeIntervalHandle),this.timeIntervalHandle=null)},_resetExdsBeginUpdateHandle:function(){this.exdsBeginUpdateHandle&&
this.exdsBeginUpdateHandle.remove&&(this.exdsBeginUpdateHandle.remove(),this.exdsBeginUpdateHandle=null)},_removeHandles:function(){this._resetExtentChangeHandle();this._resetUpdateEndHandle();this._resetFilterChangedHandle();this._resetSelectionHandle();this._resetRefreshIntervalHandle();this._resetTimeIntervalHandle();this._resetSelectionHandle()}})})},"widgets/Infographic/_ChartSetting":function(){define(["dojo/_base/declare","dojo/_base/html","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./_ChartSetting.html"],
function(m,k,h,c,a){return m([h,c],{templateString:a,baseClass:"ig-chart-setting-dlg",postCreate:function(){var a=this.chartJson.config,c=a.type;"pie"===c?(k.setStyle(this.verticalAxisSection,"display","none"),k.setStyle(this.horizontalAxisSection,"display","none"),k.setStyle(this.withoutRecordsSection,"display","none")):k.setStyle(this.dataLabelsSection,"display","none");this.chartJson.config.dateConfig||k.setStyle(this.withoutRecordsSection,"display","none");this._calcuteLegendDisplay(a)||k.setStyle(this.legendSection,
"display","none");"count"!==this.chartJson.config.mode&&"field"!==this.chartJson.config.mode||"pie"===c||k.setStyle(this.legendSection,"display","none");this.chartJson.config.showLegend&&this._toggle(this.legendToggle);this.chartJson.config.showDataLabel&&this._toggle(this.dataLabelsToggle);this.chartJson.config.showHorizontalAxis&&this._toggle(this.horizontalAxisToggle);this.chartJson.config.showVerticalAxis&&this._toggle(this.verticalAxisToggle);this.chartJson.config.dateConfig&&this.chartJson.config.dateConfig.isNeedFilled&&
this._toggle(this.withoutRecordsToggle)},_calcuteLegendDisplay:function(a){var b=a.mode,c;"pie"===a.type?c=!0:(c=!0,"count"===b||"field"===b?c=!1:a.seriesStyle&&(c="layerSymbol"!==a.seriesStyle.type));return c},_toggle:function(a){k.hasClass(a,"toggle-on")?(k.removeClass(a,"toggle-on"),k.addClass(a,"toggle-off")):(k.removeClass(a,"toggle-off"),k.addClass(a,"toggle-on"))},_onToggleClick:function(a){var b=a.target;this._toggle(b);a=k.hasClass(b,"toggle-on")?!0:!1;b=k.attr(b,"data-id");"legend"===b?
this.chartJson.config.showLegend=a:"dataLabels"===b?this.chartJson.config.showDataLabel=a:"horizontalAxis"===b?this.chartJson.config.showHorizontalAxis=a:"verticalAxis"===b?this.chartJson.config.showVerticalAxis=a:"withoutRecords"===b&&this.chartJson.config.dateConfig&&(this.chartJson.config.dateConfig.isNeedFilled=a);this.chartDijit.setConfig(this.chartJson.config)}})})},"widgets/Infographic/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],
function(){})},"url:widgets/Infographic/_ChartSetting.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"flex section" data-dojo-attach-point\x3d"legendSection"\x3e\r\n    \x3cdiv class\x3d"label textOverFlow" title\x3d"${nls.legend}"\x3e${nls.legend}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"legendToggle" data-dojo-attach-event\x3d"onclick:_onToggleClick" class\x3d"jimu-leading-margin10 toggle toggle-off" data-id\x3d"legend"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"flex section" data-dojo-attach-point\x3d"dataLabelsSection"\x3e\r\n    \x3cdiv class\x3d"label textOverFlow" title\x3d"${nls.dataLabels}"\x3e${nls.dataLabels}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"dataLabelsToggle" data-dojo-attach-event\x3d"onclick:_onToggleClick" class\x3d"jimu-leading-margin10 toggle toggle-off" data-id\x3d"dataLabels"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"flex section" data-dojo-attach-point\x3d"horizontalAxisSection"\x3e\r\n    \x3cdiv class\x3d"label textOverFlow" title\x3d"${nls.horizontalAxis}"\x3e${nls.horizontalAxis}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"horizontalAxisToggle" data-dojo-attach-event\x3d"onclick:_onToggleClick" class\x3d"jimu-leading-margin10 toggle toggle-off" data-id\x3d"horizontalAxis"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"flex section" data-dojo-attach-point\x3d"verticalAxisSection"\x3e\r\n    \x3cdiv class\x3d"label textOverFlow" title\x3d"${nls.verticalAxis}"\x3e${nls.verticalAxis}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"verticalAxisToggle" data-dojo-attach-event\x3d"onclick:_onToggleClick" class\x3d"jimu-leading-margin10 toggle toggle-off" data-id\x3d"verticalAxis"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n   \x3cdiv class\x3d"flex section" data-dojo-attach-point\x3d"withoutRecordsSection"\x3e\r\n    \x3cdiv class\x3d"label textOverFlow" title\x3d"${nls.showPeriodsWithoutRecords}"\x3e${nls.showPeriodsWithoutRecords}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"withoutRecordsToggle" data-dojo-attach-event\x3d"onclick:_onToggleClick" class\x3d"jimu-leading-margin10 toggle toggle-off" data-id\x3d"withoutRecords"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e',
"url:widgets/Infographic/Widget.html":'\x3cdiv style\x3d"width: 100%;height: 100%;"\x3e\r\n\t \x3cdiv data-dojo-attach-point\x3d"shelter" class\x3d"loading hide"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Infographic/css/style.css":'@font-face {font-family: \'icomoon\'; src: url("fonts/icomoon.eot?oflavm"); src: url("fonts/icomoon.eot?oflavm#iefix") format(\'embedded-opentype\'), url("fonts/icomoon.ttf?oflavm") format(\'truetype\'), url("fonts/icomoon.woff?oflavm") format(\'woff\'), url("fonts/icomoon.svg?oflavm#icomoon") format(\'svg\'); font-weight: normal; font-style: normal;}.jimu-widget-infographic .indicator-icon,.jimu-widget-infographic-setting .indicator-icon {font-family: \'icomoon\' !important; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; line-height: 1; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.jimu-widget-infographic .loading {position: absolute; overflow: hidden; bottom: 4px; right: 0; width: 17px; height: 17px; z-index: 101;}.jimu-rtl .jimu-widget-infographic .loading {left: 2px; right: auto;}.jimu-widget-infographic .loading {font-size: 10px; text-indent: -9999em; border-top: 3px solid rgba(219, 206, 206, 0.7); border-right: 3px solid rgba(219, 206, 206, 0.7); border-bottom: 3px solid rgba(219, 206, 206, 0.7); border-left: 3px solid #ffffff; -webkit-transform: translateZ(0); -ms-transform: translateZ(0); transform: translateZ(0); -webkit-animation: load8 1.1s infinite linear; animation: load8 1.1s infinite linear; box-shadow: 0 0 2px 0 rgba(0, 0, 0, 0.2); border-radius: 8px;}.jimu-widget-infographic .loading:after {border-radius: 50%; width: 24px; height: 24px;}.jimu-widget-infographic .hide {display: none !important;}.icon-like:before {content: "\\e900";}.icon-unlike:before {content: "\\e904";}.icon-stop:before {content: "\\e902";}.icon-danger:before {content: "\\e901";}.icon-star:before {content: "\\e903";}.icon-alarm:before {content: "\\e906";}.icon-down:before {content: "\\e909";}.icon-right:before {content: "\\e90f";}.icon-up:before {content: "\\e911";}.icon-wrong:before {content: "\\e912";}.lm_goldenlayout .lm_item .lm_content {position: relative;}.lm_goldenlayout .lm_item .lm_content .table-layout-container {display: table; table-layout: fixed; overflow: hidden; width: 100%; height: 100%;}.lm_goldenlayout .lm_item .lm_content .table-layout-container \x3e div {padding: 10px 15px;}.lm_goldenlayout .lm_item .lm_content .image-node {display: table-cell; overflow: hidden; position: relative; width: 100%; height: 100%;}.lm_goldenlayout .lm_item .lm_content .no-trim {white-space: pre-wrap;}.infographic-number-dijit {display: flex; justify-content: center; align-items: center;}.infographic-number-dijit .number-content .value-content {white-space: nowrap;}.infographic-number-dijit a,.infographic-number-dijit a:hover,.infographic-number-dijit a:visited,.infographic-number-dijit a:link,.infographic-number-dijit a:active {text-decoration: none;}.infographic-number-dijit.horizontal-left {justify-content: flex-start;}.infographic-number-dijit.horizontal-center {justify-content: center;}.infographic-number-dijit.horizontal-right {justify-content: flex-end;}.infographic-number-dijit.vertical-top {align-items: flex-start;}.infographic-number-dijit.vertical-middle {align-items: center;}.infographic-number-dijit.vertical-bottom {align-items: flex-end;}.infographic-number-dijit .number-content {display: flex; justify-content: center; max-width: 340px;}.infographic-number-dijit .number {display: flex; justify-content: space-between; align-items: baseline;}.infographic-number-dijit .indicator-icon {font-size: 22px; align-self: center; text-align: center;}.infographic-number-dijit .number .prefix {margin-right: 6px;}.infographic-number-dijit .number .suffix {margin-left: 6px;}.infographic-number-dijit .rightImgDiv {width: 35%; height: 100%; text-align: left;}.infographic-chart-dijit {position: relative;}.infographic-chart-dijit .no-data-tip {display: none; position: absolute; left: 0; right: 0; height: 30px; top: 50%; margin: -15px; text-align: center; color: #666;}.infographic-chart-dijit.no-data .no-data-tip {display: block; margin: 0 10px;}.infographic-chart-dijit.no-data .chart-dom {visibility: hidden;}.infographic-chart-dijit .chart-dom {visibility: visible;}.jimu-widget-infographic {position: relative; width: 100%; height: 100%;}.jimu-widget-infographic .chart-setting {position: absolute; top: 0; right: 0; cursor: pointer; width: 16px; height: 16px; background: no-repeat center center url(images/chart-setting.svg); z-index: 1;}.jimu-rtl .jimu-widget-infographic .chart-setting {left: 0; right: auto;}.ig-chart-setting-dlg .jimu-leading-margin10 {margin-left: 10px; margin-right: 0;}.jimu-rtl .ig-chart-setting-dlg .jimu-leading-margin10 {margin-right: 10px; margin-left: 0;}.ig-chart-setting-dlg .textOverFlow {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.ig-chart-setting-dlg .flex {display: flex; justify-content: space-between; margin-top: 8px;}.ig-chart-setting-dlg .label {width: 120px;}.ig-chart-setting-dlg .toggle {width: 38px; height: 18px; cursor: pointer;}.ig-chart-setting-dlg .toggle.toggle-on {background: no-repeat center left url(./images/toggle_on_light.svg);}.ig-chart-setting-dlg .toggle.toggle-off {background: no-repeat center left url(./images/toggle_off_light.svg);}',
"*now":function(m){m(['dojo/i18n!*preload*widgets/Infographic/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dijit/_WidgetsInTemplateMixin dijit/popup dijit/TooltipDialog jimu/BaseWidget jimu/dijit/GridLayout jimu/LayerInfos/LayerInfos jimu/utils ./DijitFactory ./dijits/SourceLauncher ./_ChartSetting".split(" "),function(m,k,h,c,a,b,g,f,n,q,d,e,l,p,t){return m([n,b],{name:"Infographic",baseClass:"jimu-widget-infographic",dijits:null,clientFeaturesHandle:null,layerInfosObj:null,postCreate:function(){this.inherited(arguments);
this.dijits=[];this.layerInfosObj=d.getInstanceSync();l.setNls(this.nls);l.setMap(this.map);l.setInSettingPage(!1);l.setAppConfig(this.appConfig);l.setContext({folderUrl:this.folderUrl});this.on("click",k.hitch(this,function(){this.chartSettingDialog&&g.close(this.chartSettingDialog)}));this._features=[]},startup:function(){this.inherited(arguments);this._createUI();this._createChartSettingBtn()},_initSourceLauncher:function(){if(this.config.dataSource){var a=this._getDataNeededDijit();a&&(this.sourceLauncher=
new p({map:this.map,appConfig:this.appConfig,useSelection:this.config.dataSource.useSelection,filterByExtent:this.config.dataSource.filterByExtent,dataSource:this.config.dataSource,dijit:a}),this._listenSourceLauncherEvent())}},onOpen:function(){this.config.dataSource&&(this.sourceLauncher?this.sourceLauncher.awake():(this._initSourceLauncher(),this.sourceLauncher.start()))},_listenSourceLauncherEvent:function(){this.own(a(this.sourceLauncher,"data-update",k.hitch(this,function(a){this._onClientFeaturesUpdate(a)})));
this.own(a(this.sourceLauncher,"fetching",k.hitch(this,function(){this._showLoading()})));this.own(a(this.sourceLauncher,"success",k.hitch(this,function(){this._hideLoading()})));this.own(a(this.sourceLauncher,"faild",k.hitch(this,function(a){console.error(a.message||a);this._hideLoading()})))},_getDataNeededDijit:function(){if(this.config&&this.config.dijits&&this.config.dijits.length){var a=null,b=["number","gauge","chart"];return a=this.config.dijits.filter(function(a){return-1<b.indexOf(a.type)})[0]}},
onClose:function(){this.sourceLauncher&&this.sourceLauncher.sleep();this.chartSettingDialog&&this.chartSettingDialog.isShow&&(g.close(this.chartSettingDialog),this.chartSettingDialog.isShow=!1)},destroy:function(){this.sourceLauncher&&this.sourceLauncher.destroy();this.chartSettingDialog&&(this.chartSettingDialog.destroy(),this.chartSettingDialog=null);this.inherited(arguments)},_showLoading:function(){c.removeClass(this.shelter,"hide")},_hideLoading:function(){c.addClass(this.shelter,"hide")},_createUI:function(){if(this.config.layout){h.forEach(this.dijits,
k.hitch(this,function(a){a.destroy()}));this.dijits=[];var a=h.map(this.config.dijits,function(a){var b=l.createDijit(a);b.setDataSource(this.config.dataSource);this.dijits.push(b);return{id:a.id,dijit:b}},this);this.layout=new q({components:a,layoutDefinition:this.config.layout.definition,container:this.domNode,editable:!1});this.layout.on("initialised",k.hitch(this,function(){h.forEach(this.dijits,k.hitch(this,function(a){a.startup()}))}))}},_createChartSettingBtn:function(){this.config.dijits&&
h.some(this.config.dijits,function(a){return a.visible&&"chart"===a.type},this)&&(this.chartSettingNode=c.create("div",{"class":"chart-setting"},this.domNode),this.own(a(this.chartSettingNode,"click",k.hitch(this,this._onChartSettingClick))),this.chartSettingDialog=new f({content:this._createChartSettingContent()}),this.chartSettingDialog.isShow=!1)},_onChartSettingClick:function(a){this.chartSettingDialog.isShow?(g.close(this.chartSettingDialog),this.chartSettingDialog.isShow=!1):(g.open({popup:this.chartSettingDialog,
around:this.chartSettingNode}),this.chartSettingDialog.isShow=!0);a.stopPropagation()},_createChartSettingContent:function(){var a=h.filter(this.config.dijits,function(a){return"chart"===a.type})[0];return a?a.config?(new t({chartJson:a,chartDijit:h.filter(this.dijits,function(b){return b.jsonId===a.id})[0],nls:this.nls})).domNode:"\x3cdiv\x3e\x3c/div\x3e":(console.error("Unknow error"),"\x3cdiv\x3e\x3c/div\x3e")},onDataSourceDataUpdate:function(a,b){this.config.dataSource&&a===this.config.dataSource.frameWorkDsId&&
this.sourceLauncher&&this.sourceLauncher.setAppConfigDSFeatures(b.features)},_onClientFeaturesUpdate:function(a){this._shouldUpdateData(a)&&(this._oldValue=a,this._onDataUpdate(a))},_shouldUpdateData:function(a){var b=!0;if("number"===typeof a)a===this._oldValue&&(b=!1);else if(a&&a.features&&this._oldValue&&this._oldValue.features){var c=h.map(this._oldValue.features,function(a){return a.attributes});a=h.map(a.features,function(a){return a.attributes});e.isEqual(c,a)&&(b=!1)}return b},_onDataUpdate:function(a){this.dijits.forEach(k.hitch(this,
function(b){b.onDataSourceDataUpdate(a)}))},resize:function(){this.inherited(arguments);this.layout&&this.layout.resize()}})});