// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://@sbaseurl@/jsapi/jsapi/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define(["dojo/_base/lang","../utils"],function(f,k){var d={stringFieldType:"esriFieldTypeString",oidFieldType:"esriFieldTypeOID",dateFieldType:"esriFieldTypeDate",numberFieldTypes:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],geometryFieldType:"esriFieldTypeGeometry",getFieldInfo:function(a,b){var c=null;b=b.fields;for(var e=0;e<b.length;e++)b[e].name===a&&(c=b[e]);return c},isGeometryType:function(a,b){return(a=d.getFieldInfo(a,b))?a.type===d.geometryFieldType:
!1},isStringType:function(a,b){return(a=d.getFieldInfo(a,b))?a.type===d.stringFieldType:!1},isNumberType:function(a,b,c){var e=f.clone(d.numberFieldTypes);c&&e.push(d.oidFieldType);return(a=d.getFieldInfo(a,b))?-1<e.indexOf(a.type):!1},isSubtypeField:function(a,b){return b&&b.typeIdField===a},isContainSubtypeField:function(a,b){return d.isSubtypeField(a,b)?b.types&&b.types.length:!1},isCodedValueField:function(a,b){return(a=d.getFieldInfo(a,b))&&a.domain&&"codedValue"===a.domain.type},isContainCodedValuesField:function(a,
b){var c=d.getFieldInfo(a,b);return d.isCodedValueField(a,b)?c.domain.codedValues&&0<c.domain.codedValues.length:!1},isDateField:function(a,b){return(a=d.getFieldInfo(a,b))?a.type===d.dateFieldType:!1},getNotGeometryFields:function(a){if(a&&a.length)return a.filter(function(a){return a.type!==d.geometryFieldType})},getFieldAlias:function(a,b,c){a=d.getFieldInfo(a,b);return this.getFieldAliasByFieldInfo(a,c)},getFieldAliasByFieldInfo:function(a,b){var c="";if(!a)return c;var e=a.name,c=a.alias||e;
b&&(c=this.getAliasFromPopupInfo(e,b));return c},getAliasFromPopupInfo:function(a,b){var c=a;if(!b)return c;(b=b.fieldInfos)&&0<b.length&&b.forEach(function(b){b.fieldName===a&&(c=b.label)});return c},getFieldInfosByFieldName:function(a,b){return a.map(function(a){a=d.getFieldInfo(a,b);return f.clone(a)}.bind(this))},getDominOrSubTypeDisplayValue:function(a,b,c){var d=b[a],h=d;(a=this.getDomain(a,b,c))&&a.codedValues&&a.codedValues.length&&a.codedValues.some(function(a){return a.code===d?(h=a.name,
!0):!1});return h},getDomain:function(a,b,c){var d,h=c.typeIdField;b.hasOwnProperty(h)&&(d=b[h]);var g,f;"undefined"!==typeof d&&(b=c.types)&&b.length&&b.some(function(b){return b.id===d?((g=b.domains&&b.domains[a])&&"inherited"===g.type&&(g=this.getDomainByLayerDefinition(a),f=!0),!0):!1},this);f||g||(g=this.getDomainByLayerDefinition(a));return g},getDomainByLayerDefinition:function(a,b){a=d.getFieldInfo(a,b);var c;a&&a.domain&&(c=a.domain);return c},updateOptions:function(a,b,c){b?(b=f.clone(b),
a.removeOption(a.getOptions()),a.addOption(b)):b=[];!c&&0<b.length&&(c=b[0].value);c&&a.set("value",c)}};f.mixin(k,d);return k});